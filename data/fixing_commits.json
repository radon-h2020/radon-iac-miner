[{"repo": "willshersystems/ansible-sshd", "_Commit__release_start_at": "f68fb55dad755ed4d4296695cd7271c7307e4a56", "author_id": null, "author_name": "Harald Koch", "committer_id": null, "committer_name": "Harald Koch", "committer_email": "chk@anemone.chk.cfrq.net", "message": "fix deprecation warning for sshd_packages (fixes issue #38)", "sha": "f68fb55dad755ed4d4296695cd7271c7307e4a56", "url": "https://api.github.com/repos/willshersystems/ansible-sshd/commits/f68fb55dad755ed4d4296695cd7271c7307e4a56", "parents": ["cb153a13ab607e1c015fec227d8f74cfbb3d9b8e"], "files": [{"sha": "65f6a9e10f98da3e51d9186f906d308fa4333b50", "filename": "tasks/main.yml", "previous_filename": null, "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/willshersystems/ansible-sshd/blob/f68fb55dad755ed4d4296695cd7271c7307e4a56/tasks/main.yml", "raw_url": "https://github.com/willshersystems/ansible-sshd/raw/f68fb55dad755ed4d4296695cd7271c7307e4a56/tasks/main.yml", "status": "modified", "patch": "@@ -21,7 +21,7 @@\n     {{ ansible_pkg_mgr }}\n     name=\"{{ item }}\"\n     state=installed\n-  with_items: sshd_packages\n+  with_items: \"{{ sshd_packages }}\"\n   tags:\n     - sshd\n ", "release": "f68fb55dad755ed4d4296695cd7271c7307e4a56"}]}, {"repo": "ansiblebit/oracle-java", "_Commit__release_starts_at": null, "_Commit__release_ends_at": "7e4facb9477ad92d61bc998d4118eba4283b0a3d", "author_id": "MDQ6VXNlcjU3MTU5MA==", "author_name": "Pedro Salgado", "committer_id": "MDQ6VXNlcjU3MTU5MA==", "committer_name": "Pedro Salgado", "committer_email": "steenzout@ymail.com", "message": "fixed errors and warnings for issue #8", "sha": "3c4d272a77f8aaeb300c8b841bb7e6d8dbd76c1f", "url": "https://api.github.com/repos/ansiblebit/oracle-java/commits/3c4d272a77f8aaeb300c8b841bb7e6d8dbd76c1f", "parents": ["5eb44163b7f6328c1f30168fa86326458d5dbaff"], "files": [{"sha": "13e409839c091e4ab7d2a74172c985c349fec696", "filename": "meta/main.yml", "previous_filename": null, "additions": 2, "deletions": 10, "changes": 12, "blob_url": "https://github.com/ansiblebit/oracle-java/blob/3c4d272a77f8aaeb300c8b841bb7e6d8dbd76c1f/meta/main.yml", "raw_url": "https://github.com/ansiblebit/oracle-java/raw/3c4d272a77f8aaeb300c8b841bb7e6d8dbd76c1f/meta/main.yml", "status": "modified", "patch": "@@ -20,15 +20,6 @@ galaxy_info:\n       versions:\n         - jessie\n         - wheezy\n-    - name: MacOSX\n-      versions:\n-        - 10.10.2\n-        - 10.10.1\n-        - 10.9.5\n-        - 10.9.4\n-        - 10.9.3\n-        - 10.9.2\n-        - 10.9.1\n     - name: RedHat\n       versions:\n         - all\n@@ -40,8 +31,9 @@ galaxy_info:\n         - vivid\n         - trusty\n         - precise\n-  categories:\n+  galaxy_tags:\n     - development\n+    - java\n     - system\n dependencies:\n   - role: ansiblebit.launchpad-ppa-webupd8", "release_starts_at": null, "release_ends_at": "7e4facb9477ad92d61bc998d4118eba4283b0a3d"}], "release_starts_at": "617c8f2de47d53b11ebed60c6cdfe7d020a120a7"}, {"repo": "sensu/sensu-ansible", "_Commit__release_starts_at": null, "_Commit__release_ends_at": "9b3cb140022faf899910398013334755c8050175", "author_id": "MDQ6VXNlcjI3MzM3NQ==", "author_name": "Sergey Karatkevich", "committer_id": "MDQ6VXNlcjExOTAyNDc2", "committer_name": "Stephen Muth", "committer_email": "smuth4@users.noreply.github.com", "message": "fix for Issue 90 (#91)", "sha": "f635e4cb6aa1fb00663aa57a4f116b2b2c83b804", "url": "https://api.github.com/repos/sensu/sensu-ansible/commits/f635e4cb6aa1fb00663aa57a4f116b2b2c83b804", "parents": ["1bdaeb4774a30e08afcbeebb59e5cdfa97ba44a1"], "files": [{"sha": "80530518d78fda5f7dc7bf4253ebcee9721fbc05", "filename": "tasks/Ubuntu/main.yml", "previous_filename": null, "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/sensu/sensu-ansible/blob/f635e4cb6aa1fb00663aa57a4f116b2b2c83b804/tasks/Ubuntu/main.yml", "raw_url": "https://github.com/sensu/sensu-ansible/raw/f635e4cb6aa1fb00663aa57a4f116b2b2c83b804/tasks/Ubuntu/main.yml", "status": "modified", "patch": "@@ -4,6 +4,9 @@\n \n   - include_vars: \"{{ ansible_distribution }}.yml\"\n \n+  - name: Ensure that https transport is ready\n+    apt: name=apt-transport-https state=present\n+    \n   - name: Ensure the Sensu APT repo GPG key is present\n     apt_key:\n       url: https://sensu.global.ssl.fastly.net/apt/pubkey.gpg", "release_starts_at": null, "release_ends_at": "9b3cb140022faf899910398013334755c8050175"}], "release_starts_at": "f635e4cb6aa1fb00663aa57a4f116b2b2c83b804"}, {"repo": "willshersystems/ansible-sshd", "_Commit__release_start_at": "f68fb55dad755ed4d4296695cd7271c7307e4a56", "author_id": null, "author_name": "Matt Willsher", "committer_id": null, "committer_name": "Matt Willsher", "committer_email": "matt@willsher.systems", "message": "Fix issues raised in #22", "sha": "812a1e12673654589d60c0e5683a33708c6456e3", "url": "https://api.github.com/repos/willshersystems/ansible-sshd/commits/812a1e12673654589d60c0e5683a33708c6456e3", "parents": ["c7cf019326c96b15ccee3b7bf4e14ff0bb894cf0"], "files": [{"sha": "87a36d7295fd34b444ef7e481d3d47a28a687da7", "filename": "tasks/main.yml", "previous_filename": null, "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/willshersystems/ansible-sshd/blob/812a1e12673654589d60c0e5683a33708c6456e3/tasks/main.yml", "raw_url": "https://github.com/willshersystems/ansible-sshd/raw/812a1e12673654589d60c0e5683a33708c6456e3/tasks/main.yml", "status": "modified", "patch": "@@ -13,6 +13,8 @@\n - name: OS is supported\n   assert:\n     that: sshd_os_supported == True\n+  tags:\n+    - sshd\n \n - name: Installed\n   action: >\n@@ -55,3 +57,5 @@\n - name: Register that this role has run\n   set_fact: sshd_has_run=true\n   when: sshd_has_run is not defined\n+  tags:\n+    - sshd", "release": "f68fb55dad755ed4d4296695cd7271c7307e4a56"}, {"sha": "cfa928101c1fae7850279007a9ddc4c04cc0e450", "filename": "handlers/main.yml", "previous_filename": null, "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/willshersystems/ansible-sshd/blob/812a1e12673654589d60c0e5683a33708c6456e3/handlers/main.yml", "raw_url": "https://github.com/willshersystems/ansible-sshd/raw/812a1e12673654589d60c0e5683a33708c6456e3/handlers/main.yml", "status": "modified", "patch": "@@ -3,4 +3,4 @@\n   service:\n     name: \"{{ sshd_service }}\"\n     state: reloaded\n-  when: sshd_allow_reload == True\n+  when: sshd_allow_reload\n\\ No newline at end of file", "release": "f68fb55dad755ed4d4296695cd7271c7307e4a56"}]}, {"repo": "awailly/cis-ubuntu-ansible", "_Commit__release_start_at": "2cfa28fd756194b32e320ab9c0df1e455f27dc38", "author_id": "MDQ6VXNlcjk3MTc1NQ==", "author_name": "Aur\u00e9lien Wailly", "committer_id": "MDQ6VXNlcjk3MTc1NQ==", "committer_name": "Aur\u00e9lien Wailly", "committer_email": "aurelien.wailly@gmail.com", "message": "Fix #11\n\nCheck if the service name is cron on Ubuntu and Raspbian", "sha": "d674673e65cff8b704bea6efd9005251680b5351", "url": "https://api.github.com/repos/awailly/cis-ubuntu-ansible/commits/d674673e65cff8b704bea6efd9005251680b5351", "parents": ["cb054bd0ed781881ab5d259917184c0ff4b006a7"], "files": [{"sha": "88f0dec030987b8cd243bb0e681c5a7bc08c04ff", "filename": "tasks/section_09_level1.yml", "previous_filename": null, "additions": 3, "deletions": 4, "changes": 7, "blob_url": "https://github.com/awailly/cis-ubuntu-ansible/blob/d674673e65cff8b704bea6efd9005251680b5351/tasks/section_09_level1.yml", "raw_url": "https://github.com/awailly/cis-ubuntu-ansible/raw/d674673e65cff8b704bea6efd9005251680b5351/tasks/section_09_level1.yml", "status": "modified", "patch": "@@ -10,10 +10,9 @@\n       - section9.1.1.1\n \n   - name: 9.1.1.2 Enable cron Daemon (Scored)\n-    lineinfile: >\n-        dest='/etc/init/cron.conf'\n-        line='start on runlevel [2345]'\n-        state=present\n+    service: >\n+        name=cron\n+        state=enabled\n     when: not cron_conf_stat.stat.exists\n     tags:\n       - section9", "release": "2cfa28fd756194b32e320ab9c0df1e455f27dc38"}]}, {"repo": "Capgemini/Apollo", "_Commit__release_start_at": "308889b1c7c114ab9079c9050ee083fffe5508be", "author_id": "MDQ6VXNlcjE2ODE4OTY=", "author_name": "Graham Taylor", "committer_id": "MDQ6VXNlcjE2ODE4OTY=", "committer_name": "Graham Taylor", "committer_email": "gtayzlor@gmail.com", "message": "Fix #473 - Add rebuild container to mesos/zookeeper/cadvisor/dnsmasq", "sha": "35e3fa9ab5349a9909da5d6f3897d265175c6f97", "url": "https://api.github.com/repos/Capgemini/Apollo/commits/35e3fa9ab5349a9909da5d6f3897d265175c6f97", "parents": ["f85435227eb23c6e474103286c17d7406baeff47"], "files": [{"sha": "92e1eb4cdb4a749ac4b36dd16b0230db621cba10", "filename": "roles/mesos/defaults/main.yml", "previous_filename": null, "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Capgemini/Apollo/blob/35e3fa9ab5349a9909da5d6f3897d265175c6f97/roles/mesos/defaults/main.yml", "raw_url": "https://github.com/Capgemini/Apollo/raw/35e3fa9ab5349a9909da5d6f3897d265175c6f97/roles/mesos/defaults/main.yml", "status": "modified", "patch": "@@ -14,12 +14,14 @@ mesos_containerizers: \"docker,mesos\"\n mesos_resources: \"ports(*):[31000-32000]\"\n mesos_slave_work_dir: \"/tmp/mesos\"\n mesos_slave_image: \"mesosphere/mesos-slave:{{ mesos_version }}\"\n+mesos_slave_rebuild_container: false\n \n # Defaults file for mesos-master\n mesos_zookeeper_group: zookeeper_servers\n mesos_master_port: 5050\n mesos_master_work_dir: \"/var/lib/mesos\"\n mesos_master_image: \"mesosphere/mesos-master:{{ mesos_version }}\"\n+mesos_master_rebuild_container: false\n \n prometheus_mesos_exporter_image: \"prom/mesos-exporter:latest\"\n prometheus_mesos_exporter_port: 9105", "release": "308889b1c7c114ab9079c9050ee083fffe5508be"}, {"sha": "14516053d5fc0d15e09f4434b5b070dcbe88077b", "filename": "roles/cadvisor/tasks/main.yml", "previous_filename": null, "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Capgemini/Apollo/blob/35e3fa9ab5349a9909da5d6f3897d265175c6f97/roles/cadvisor/tasks/main.yml", "raw_url": "https://github.com/Capgemini/Apollo/raw/35e3fa9ab5349a9909da5d6f3897d265175c6f97/roles/cadvisor/tasks/main.yml", "status": "modified", "patch": "@@ -1,4 +1,13 @@\n # tasks for running cadvisor\n+- name: destroy old cadvisor container\n+  when: cadvisor_rebuild_container\n+  docker:\n+    name: cadvisor\n+    image: \"{{ cadvisor_image }}\"\n+    state: absent\n+  tags:\n+    - cadvisor\n+\n - name: run cadvisor container\n   when: cadvisor_enabled\n   docker:", "release": "308889b1c7c114ab9079c9050ee083fffe5508be"}, {"sha": "3ffa6ba92d0ccfbdb2e0582e0d34a88430a197e7", "filename": "roles/zookeeper/tasks/main.yml", "previous_filename": null, "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Capgemini/Apollo/blob/35e3fa9ab5349a9909da5d6f3897d265175c6f97/roles/zookeeper/tasks/main.yml", "raw_url": "https://github.com/Capgemini/Apollo/raw/35e3fa9ab5349a9909da5d6f3897d265175c6f97/roles/zookeeper/tasks/main.yml", "status": "modified", "patch": "@@ -72,6 +72,15 @@\n   tags:\n     - zookeeper\n \n+- name: destroy old zookeeper container\n+  when: zookeeper_rebuild_container\n+  docker:\n+    name: zookeeper\n+    image: \"{{ zookeeper_image }}\"\n+    state: absent\n+  tags:\n+    - zookeeper\n+\n - name: run zookeeper container\n   docker:\n     name: zookeeper", "release": "308889b1c7c114ab9079c9050ee083fffe5508be"}, {"sha": "66a9cbcc21c0532b2bc4bc91c8316b1a50cb61ba", "filename": "roles/dnsmasq/tasks/main.yml", "previous_filename": null, "additions": 10, "deletions": 1, "changes": 11, "blob_url": "https://github.com/Capgemini/Apollo/blob/35e3fa9ab5349a9909da5d6f3897d265175c6f97/roles/dnsmasq/tasks/main.yml", "raw_url": "https://github.com/Capgemini/Apollo/raw/35e3fa9ab5349a9909da5d6f3897d265175c6f97/roles/dnsmasq/tasks/main.yml", "status": "modified", "patch": "@@ -22,12 +22,21 @@\n   tags:\n     - dnsmasq\n \n+- name: destroy old dnsmasq container\n+  when: dnsmasq_rebuild_container\n+  docker:\n+    name: dnsmasq\n+    image: \"{{ dnsmasq_image }}\"\n+    state: absent\n+  tags:\n+    - dnsmasq\n+\n # This should be using -cap-add=NET_ADMIN rather than privileged: true.\n # This will be supported in Ansible 2.0\n - name: run dnsmasq container\n   docker:\n     name: dnsmasq\n-    image: \"andyshinn/dnsmasq\"\n+    image: \"{{ dnsmasq_image }}\"\n     state: started\n     net: \"host\"\n     privileged: true", "release": "308889b1c7c114ab9079c9050ee083fffe5508be"}, {"sha": "3f26c78190cf10a8d222501b8e640544f4cb1d06", "filename": "roles/zookeeper/defaults/main.yml", "previous_filename": null, "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Capgemini/Apollo/blob/35e3fa9ab5349a9909da5d6f3897d265175c6f97/roles/zookeeper/defaults/main.yml", "raw_url": "https://github.com/Capgemini/Apollo/raw/35e3fa9ab5349a9909da5d6f3897d265175c6f97/roles/zookeeper/defaults/main.yml", "status": "modified", "patch": "@@ -22,3 +22,4 @@ zookeeper_id: \"\n     {%- endif -%}\n \"\n consul_dir: /etc/consul.d\n+zookeeper_rebuild_container: false", "release": "308889b1c7c114ab9079c9050ee083fffe5508be"}, {"sha": "038c8692755b64fd16a2d364fb4fb5f8e862d164", "filename": "roles/cadvisor/defaults/main.yml", "previous_filename": null, "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Capgemini/Apollo/blob/35e3fa9ab5349a9909da5d6f3897d265175c6f97/roles/cadvisor/defaults/main.yml", "raw_url": "https://github.com/Capgemini/Apollo/raw/35e3fa9ab5349a9909da5d6f3897d265175c6f97/roles/cadvisor/defaults/main.yml", "status": "modified", "patch": "@@ -8,3 +8,4 @@ cadvisor_hostname: \"{{ ansible_ssh_host }}\"\n cadvisor_image: \"google/cadvisor:{{ cadvisor_version }}\"\n cadvisor_consul_dir: /etc/consul.d\n cadvisor_consul_service_id: \"{{ ansible_hostname }}:cadvisor:8080\"\n+cadvisor_rebuild_container: false", "release": "308889b1c7c114ab9079c9050ee083fffe5508be"}, {"sha": "ca9f04f1f431bf43ccab863e91b865c3cf7b2a82", "filename": "roles/dnsmasq/defaults/main.yml", "previous_filename": null, "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Capgemini/Apollo/blob/35e3fa9ab5349a9909da5d6f3897d265175c6f97/roles/dnsmasq/defaults/main.yml", "raw_url": "https://github.com/Capgemini/Apollo/raw/35e3fa9ab5349a9909da5d6f3897d265175c6f97/roles/dnsmasq/defaults/main.yml", "status": "modified", "patch": "@@ -2,3 +2,5 @@\n # defaults file for dnsmasq\n dnsmasq_config_folder: \"/etc/dnsmasq.d\"\n dnsmasq_resolvconf_file: \"{{ dnsmasq_config_folder }}/resolv.conf~\"\n+dnsmasq_rebuild_container: false\n+dnsmasq_image: \"andyshinn/dnsmasq\"", "release": "308889b1c7c114ab9079c9050ee083fffe5508be"}, {"sha": "918a982b10ded59e0f0251db45e741bf68a42a08", "filename": "roles/mesos/tasks/master.yml", "previous_filename": null, "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Capgemini/Apollo/blob/35e3fa9ab5349a9909da5d6f3897d265175c6f97/roles/mesos/tasks/master.yml", "raw_url": "https://github.com/Capgemini/Apollo/raw/35e3fa9ab5349a9909da5d6f3897d265175c6f97/roles/mesos/tasks/master.yml", "status": "modified", "patch": "@@ -22,6 +22,15 @@\n   tags:\n     - mesos-master\n \n+- name: destroy old mesos-master container\n+  when: mesos_master_rebuild_container\n+  docker:\n+    name: mesos-master\n+    image: \"{{ mesos_master_image }}\"\n+    state: absent\n+  tags:\n+    - mesos-master\n+\n - name: run mesos-master container\n   when: mesos_install_mode == \"master\"\n   docker:", "release": "308889b1c7c114ab9079c9050ee083fffe5508be"}, {"sha": "d8a225e51a9ca17f54084a7e551c373847fef863", "filename": "roles/mesos/tasks/slave.yml", "previous_filename": null, "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Capgemini/Apollo/blob/35e3fa9ab5349a9909da5d6f3897d265175c6f97/roles/mesos/tasks/slave.yml", "raw_url": "https://github.com/Capgemini/Apollo/raw/35e3fa9ab5349a9909da5d6f3897d265175c6f97/roles/mesos/tasks/slave.yml", "status": "modified", "patch": "@@ -11,6 +11,15 @@\n   tags:\n     - mesos-slave\n \n+- name: destroy old mesos-slave container\n+  when: mesos_slave_rebuild_container\n+  docker:\n+    name: mesos-slave\n+    image: \"{{ mesos_slave_image }}\"\n+    state: absent\n+  tags:\n+    - mesos-slave\n+\n - name: run mesos-slave container\n   when: mesos_install_mode == \"slave\"\n   docker:", "release": "308889b1c7c114ab9079c9050ee083fffe5508be"}]}, {"repo": "awailly/cis-ubuntu-ansible", "_Commit__release_start_at": "2cfa28fd756194b32e320ab9c0df1e455f27dc38", "author_id": "MDQ6VXNlcjk3MTc1NQ==", "author_name": "Aur\u00e9lien Wailly", "committer_id": "MDQ6VXNlcjk3MTc1NQ==", "committer_name": "Aur\u00e9lien Wailly", "committer_email": "aurelien.wailly@gmail.com", "message": "Fixes #44\n\n- Bug with remote logs sending on 127.0.0.1\n- Add new variable to specify local or remote log", "sha": "1ab6eab24253634453c2d2ab937b5d3620aa71ae", "url": "https://api.github.com/repos/awailly/cis-ubuntu-ansible/commits/1ab6eab24253634453c2d2ab937b5d3620aa71ae", "parents": ["4e5f889ccbec1ce7d10466a19c3a2613dc14092b"], "files": [{"sha": "1fd1c3aefe697d2cfc2062e1261c7aa31b240d3d", "filename": "tasks/section_08_level1.yml", "previous_filename": null, "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/awailly/cis-ubuntu-ansible/blob/1ab6eab24253634453c2d2ab937b5d3620aa71ae/tasks/section_08_level1.yml", "raw_url": "https://github.com/awailly/cis-ubuntu-ansible/raw/1ab6eab24253634453c2d2ab937b5d3620aa71ae/tasks/section_08_level1.yml", "status": "modified", "patch": "@@ -116,7 +116,7 @@\n        line=\"*.* @@{{Remote_Logs_Host_Address}}\"\n        insertafter=EOF\n        state=present\n-    when: remoteloghost.rc == 1\n+    when: send_rsyslog_remote == True and remoteloghost.rc == 1\n     tags:\n       - section8\n       - section8.2\n@@ -142,7 +142,7 @@\n     with_items:\n         - '$ModLoad imtcp'\n         - '$InputTCPServerRun 514'\n-    when: moadloadpresent.rc == 1\n+    when: send_rsyslog_remote == True and moadloadpresent.rc == 1\n     changed_when: False\n     notify: restart rsyslog\n     tags:", "release": "2cfa28fd756194b32e320ab9c0df1e455f27dc38"}]}, {"repo": "Capgemini/Apollo", "_Commit__release_starts_at": null, "_Commit__release_ends_at": "dfa8978dc272945b9b4fce761c4bb23af2dd6653", "author_id": "MDQ6VXNlcjE2ODE4OTY=", "author_name": "Graham Taylor", "committer_id": "MDQ6VXNlcjE2ODE4OTY=", "committer_name": "Graham Taylor", "committer_email": "gtayzlor@gmail.com", "message": "fix #133 Allow customisation of resources/containerizers/executor_registration_timeout", "sha": "38b3b7876cf98a70020ad31545a3654a44aff314", "url": "https://api.github.com/repos/Capgemini/Apollo/commits/38b3b7876cf98a70020ad31545a3654a44aff314", "parents": ["80530fde7df1a94ad361434e02816b0816a2c47a"], "files": [{"sha": "5238deacc1d7c5763513cb88d310b130fe5029ee", "filename": "roles/mesos/defaults/main.yml", "previous_filename": null, "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Capgemini/Apollo/blob/38b3b7876cf98a70020ad31545a3654a44aff314/roles/mesos/defaults/main.yml", "raw_url": "https://github.com/Capgemini/Apollo/raw/38b3b7876cf98a70020ad31545a3654a44aff314/roles/mesos/defaults/main.yml", "status": "modified", "patch": "@@ -5,3 +5,7 @@ mesos_zookeeper_group: zookeeper_servers\n mesos_master_port: 5050\n consul_dir: /etc/consul.d\n mesos_local_address: \"{{ ansible_default_ipv4.address }}\"\n+mesos_executor_registration_timeout: 10mins\n+mesos_cluster_name: \"Cluster01\"\n+mesos_containerizers: \"docker,mesos\"\n+mesos_resources: \"ports(*):[31000-32000]\"", "release_starts_at": null, "release_ends_at": "dfa8978dc272945b9b4fce761c4bb23af2dd6653"}, {"sha": "225904cdf5a675c160ddec8280ac505d486f2061", "filename": "roles/mesos/tasks/main.yml", "previous_filename": null, "additions": 21, "deletions": 0, "changes": 21, "blob_url": "https://github.com/Capgemini/Apollo/blob/38b3b7876cf98a70020ad31545a3654a44aff314/roles/mesos/tasks/main.yml", "raw_url": "https://github.com/Capgemini/Apollo/raw/38b3b7876cf98a70020ad31545a3654a44aff314/roles/mesos/tasks/main.yml", "status": "modified", "patch": "@@ -65,6 +65,27 @@\n   command: /bin/rm -f /etc/init/mesos-slave.override\n   when: mesos_install_mode == \"slave\"\n \n+- name: set executor registration timeout\n+  sudo: yes\n+  copy:\n+    dest: /etc/mesos-slave/executor_registration_timeout\n+    content: \"{{ mesos_executor_registration_timeout }}\"\n+  when: mesos_install_mode == \"slave\"\n+\n+- name: set containerizers\n+  sudo: yes\n+  copy:\n+    dest: /etc/mesos-slave/containerizers\n+    content: \"{{ mesos_containerizers }}\"\n+  when: mesos_install_mode == \"slave\"\n+\n+- name: set slave resources\n+  sudo: yes\n+  copy:\n+    dest: /etc/mesos-slave/resources\n+    content: \"{{ mesos_resources }}\"\n+  when: mesos_install_mode == \"slave\"\n+\n - name: Set Mesos Slave ip\n   copy:\n     content: \"{{mesos_local_address}}\"", "release_starts_at": null, "release_ends_at": "dfa8978dc272945b9b4fce761c4bb23af2dd6653"}], "release_starts_at": "38b3b7876cf98a70020ad31545a3654a44aff314"}, {"repo": "nusenu/ansible-relayor", "_Commit__release_start_at": "1224adf2811c827a09ff0bf133fbb476901a547d", "author_id": null, "author_name": "nusenu", "committer_id": null, "committer_name": "nusenu", "committer_email": "nusenu@openmailbox.org", "message": "FreeBSD: change pidir from /var/run/tor to /var/run/tor-instances (fixes #62)", "sha": "44be91805d4a4c003d28a7c5fd3f7a6317863435", "url": "https://api.github.com/repos/nusenu/ansible-relayor/commits/44be91805d4a4c003d28a7c5fd3f7a6317863435", "parents": ["694a4890fcf0daa375d6a173511f6ff7dd0f2335"], "files": [{"sha": "ecd05ee5fa3c823f5d4ecd97f24f5af00a50fb06", "filename": "tasks/freebsd_install.yml", "previous_filename": null, "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/nusenu/ansible-relayor/blob/44be91805d4a4c003d28a7c5fd3f7a6317863435/tasks/freebsd_install.yml", "raw_url": "https://github.com/nusenu/ansible-relayor/raw/44be91805d4a4c003d28a7c5fd3f7a6317863435/tasks/freebsd_install.yml", "status": "modified", "patch": "@@ -4,6 +4,7 @@\n   set_fact:\n     tor_DataDir: /var/db/tor-instances\n     tor_ConfDir: /usr/local/etc/tor/enabled\n+    tor_PidDir: /var/run/tor-instances\n   tags:\n    - reconfigure\n    - renewkey", "release": "1224adf2811c827a09ff0bf133fbb476901a547d"}]}, {"repo": "nusenu/ansible-relayor", "_Commit__release_start_at": "1224adf2811c827a09ff0bf133fbb476901a547d", "author_id": null, "author_name": "nusenu", "committer_id": null, "committer_name": "nusenu", "committer_email": "nusenu@openmailbox.org", "message": "including OS specific vars is always required (fixes #86)", "sha": "dbe5647c4e42252e9e428e50b9b0a3636f94842a", "url": "https://api.github.com/repos/nusenu/ansible-relayor/commits/dbe5647c4e42252e9e428e50b9b0a3636f94842a", "parents": ["2a8ca91248bb834daaa8c35f709d6f8158d81a38"], "files": [{"sha": "85b96a58a39f2e87779d5a98a40f2dcb9862d8f1", "filename": "tasks/main.yml", "previous_filename": null, "additions": 1, "deletions": 2, "changes": 3, "blob_url": "https://github.com/nusenu/ansible-relayor/blob/dbe5647c4e42252e9e428e50b9b0a3636f94842a/tasks/main.yml", "raw_url": "https://github.com/nusenu/ansible-relayor/raw/dbe5647c4e42252e9e428e50b9b0a3636f94842a/tasks/main.yml", "status": "modified", "patch": "@@ -11,8 +11,7 @@\n - name: Set OS specific variables\n   include_vars: \"{{ ansible_os_family }}.yml\"\n   tags:\n-   - renewkey\n-   - reconfigure\n+   - always\n \n - include: ip-list.yml\n   tags:", "release": "1224adf2811c827a09ff0bf133fbb476901a547d"}]}, {"repo": "UnderGreen/ansible-role-mongodb", "_Commit__release_start_at": "42487b9f4681a078ef82c07c3307a51653a19791", "author_id": "MDQ6VXNlcjUwMTI3Nzg=", "author_name": "rapkin", "committer_id": "MDQ6VXNlcjUwMTI3Nzg=", "committer_name": "rapkin", "committer_email": "mikola.parfenyuck@gmail.com", "message": "fixed `mongodb_replication_params is undefined` error (closes #37)", "sha": "42487b9f4681a078ef82c07c3307a51653a19791", "url": "https://api.github.com/repos/UnderGreen/ansible-role-mongodb/commits/42487b9f4681a078ef82c07c3307a51653a19791", "parents": ["61b008311c40b377e57e166b778232a20224f7c6"], "files": [{"sha": "b8eaed5d522499418ddd141a28af5e869d5a4b9b", "filename": "tasks/replication_init_auth.yml", "previous_filename": null, "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/UnderGreen/ansible-role-mongodb/blob/42487b9f4681a078ef82c07c3307a51653a19791/tasks/replication_init_auth.yml", "raw_url": "https://github.com/UnderGreen/ansible-role-mongodb/raw/42487b9f4681a078ef82c07c3307a51653a19791/tasks/replication_init_auth.yml", "status": "modified", "patch": "@@ -11,6 +11,7 @@\n     host_type: \"{{ item.host_type|default('replica') }}\"\n     hidden: \"{{ item.hidden|default(false) }}\"\n     priority: \"{{ item.priority|default(1.0) }}\"\n+  when: mongodb_replication_params is defined\n   with_items:\n     - \"{{ mongodb_replication_params }}\"\n   register: mongodb_replica_init\n@@ -31,6 +32,7 @@\n     host_type: \"{{ item.host_type|default('replica') }}\"\n     hidden: \"{{ item.hidden|default(false) }}\"\n     priority: \"{{ item.priority|default(1.0) }}\"\n+  when: mongodb_replication_params is defined\n   with_items:\n     - \"{{ mongodb_replication_params }}\"\n   when: mongodb_replica_init|failed", "release": "42487b9f4681a078ef82c07c3307a51653a19791"}]}, {"repo": "awailly/cis-ubuntu-ansible", "_Commit__release_start_at": "2cfa28fd756194b32e320ab9c0df1e455f27dc38", "author_id": "MDQ6VXNlcjk3MTc1NQ==", "author_name": "Aur\u00e9lien Wailly", "committer_id": "MDQ6VXNlcjk3MTc1NQ==", "committer_name": "Aur\u00e9lien Wailly", "committer_email": "aurelien.wailly@gmail.com", "message": "Fix #69\n\n- Check the sshd_config file presence in the global include of section 9\n- Refactor 9.3 to be in a dedicated file", "sha": "b769c26d983effecebb2f17ac1b94ddc1f93ee48", "url": "https://api.github.com/repos/awailly/cis-ubuntu-ansible/commits/b769c26d983effecebb2f17ac1b94ddc1f93ee48", "parents": ["82993d4cbc4985706cf9b863952976637c72e367"], "files": [{"sha": "9130a32a57b6c9fb6e66a9776f0f7564b70cd368", "filename": "tasks/section_09_level1.yml", "previous_filename": null, "additions": 1, "deletions": 179, "changes": 180, "blob_url": "https://github.com/awailly/cis-ubuntu-ansible/blob/b769c26d983effecebb2f17ac1b94ddc1f93ee48/tasks/section_09_level1.yml", "raw_url": "https://github.com/awailly/cis-ubuntu-ansible/raw/b769c26d983effecebb2f17ac1b94ddc1f93ee48/tasks/section_09_level1.yml", "status": "modified", "patch": "@@ -175,186 +175,8 @@\n       - section9.3\n       - section9.3.1\n \n-\n-  - name: 9.3.1 Set SSH Protocol to 2 (Scored)\n-    lineinfile: >\n-        dest='/etc/ssh/sshd_config'\n-        regexp='^Protocol'\n-        state=present\n-        line='Protocol 2'\n-    when: ssh_config_file.stat.exists == True\n-    notify: restart ssh\n-    tags:\n-      - section9\n-      - section9.3\n-      - section9.3.1\n-\n-  - name: 9.3.2 Set LogLevel to INFO (Scored)\n-    lineinfile: >\n-        dest='/etc/ssh/sshd_config'\n-        regexp='^LogLevel'\n-        state=present\n-        line='LogLevel INFO'\n-    when: ssh_config_file.stat.exists == True\n-    notify: restart ssh\n-    tags:\n-      - section9\n-      - section9.3\n-      - section9.3.2\n-\n-  - name: 9.3.3 Set Permissions on /etc/ssh/sshd_config (Scored)\n-    file: path='/etc/ssh/sshd_config' owner=root group=root mode=600\n+  - include: section_09_level1_03.yml\n     when: ssh_config_file.stat.exists == True\n-    notify: restart ssh\n-    tags:\n-      - section9\n-      - section9.3\n-      - section9.3.3\n-\n-#Regroups sections 9.3.4 9.3.7 9.3.8 9.3.9 9.3.10\n-  - name: 9.3.{4,7,8,9,10} Disable some SSH options (Scored)\n-    lineinfile: >\n-        dest='/etc/ssh/sshd_config'\n-        regexp='^{{ item }}'\n-        line='{{ item }} no'\n-        state=present\n-    with_items:\n-      - X11Forwarding\n-      - HostbasedAuthentication\n-      - PermitRootLogin\n-      - PermitEmptyPasswords\n-      - PermitUserEnvironment\n-    notify: restart ssh\n-    tags:\n-      - section9\n-      - section9.3\n-      - section9.3.4\n-      - section9.3.7\n-      - section9.3.8\n-      - section9.3.9\n-      - section9.3.10\n-\n-  - name: 9.3.5 Set SSH MaxAuthTries to 4 or Less (Scored)\n-    lineinfile: >\n-        dest='/etc/ssh/sshd_config'\n-        regexp='^MaxAuthTries'\n-        line='MaxAuthTries 4'\n-        state=present\n-    notify: restart ssh\n-    tags:\n-      - section9\n-      - section9.3\n-      - section9.3.5\n-\n-  - name: 9.3.6 Set SSH IgnoreRhosts to Yes (Scored)\n-    lineinfile: >\n-        dest='/etc/ssh/sshd_config'\n-        regexp='^IgnoreRhosts'\n-        line='IgnoreRhosts yes'\n-        state=present\n-    notify: restart ssh\n-    tags:\n-      - section9\n-      - section9.3\n-      - section9.3.6\n-\n-  - name: 9.3.11 Use Only Approved Cipher in Counter Mode (Scored)\n-    lineinfile: >\n-        dest='/etc/ssh/sshd_config'\n-        regexp='^Ciphers'\n-        line='Ciphers aes128-ctr,aes192-ctr,aes256-ctr'\n-        state=present\n-    notify: restart ssh\n-    tags:\n-      - section9\n-      - section9.3\n-      - section9.3.11\n-\n-  - name: 9.3.12.1 Set Idle Timeout Interval for User Login (Scored)\n-    lineinfile: >\n-        dest='/etc/ssh/sshd_config'\n-        regexp='^ClientAliveInterval'\n-        line='ClientAliveInterval 300'\n-        state=present\n-    tags:\n-      - section9\n-      - section9.3\n-      - section9.3.12\n-      - section9.3.12.1\n-\n-  - name: 9.3.12.2 Set Idle Timeout Interval for User Login (Scored)\n-    lineinfile: >\n-        dest='/etc/ssh/sshd_config'\n-        regexp='^ClientAliveCountMax'\n-        line='ClientAliveCountMax 0'\n-        state=present\n-    notify: restart ssh\n-    tags:\n-      - section9\n-      - section9.3\n-      - section9.3.12\n-      - section9.3.12.2\n-\n-  - name: 9.3.13.1 Limit Access via SSH (Scored)\n-    shell: grep AllowUsers /etc/ssh/sshd_config\n-    register: allow_rc\n-    failed_when: allow_rc.rc == 1\n-    changed_when: False\n-    ignore_errors: True\n-    tags:\n-      - section9\n-      - section9.3\n-      - section9.3.13\n-      - section9.3.13.1\n-\n-  - name: 9.3.13.2 Limit Access via SSH (Scored)\n-    shell: grep AllowGroups /etc/ssh/sshd_config\n-    register: allow_rc\n-    failed_when: allow_rc.rc == 1\n-    changed_when: False\n-    ignore_errors: True\n-    tags:\n-      - section9\n-      - section9.3\n-      - section9.3.13\n-      - section9.3.13.2\n-\n-  - name: 9.3.13.3 Limit Access via SSH (Scored)\n-    shell: grep DenyUsers /etc/ssh/sshd_config\n-    register: allow_rc\n-    failed_when: allow_rc.rc == 1\n-    changed_when: False\n-    ignore_errors: True\n-    tags:\n-      - section9\n-      - section9.3\n-      - section9.3.13\n-      - section9.3.13.3\n-\n-  - name: 9.3.13.4 Limit Access via SSH (Scored)\n-    shell: grep DenyGroups /etc/ssh/sshd_config\n-    register: allow_rc\n-    failed_when: allow_rc.rc == 1\n-    changed_when: False\n-    ignore_errors: True\n-    notify: restart ssh\n-    tags:\n-      - section9\n-      - section9.3\n-      - section9.3.13\n-      - section9.3.13.4\n-\n-  - name: 9.3.14 Set SSH Banner (Scored)\n-    lineinfile: >\n-        dest='/etc/ssh/sshd_config'\n-        regexp='^Banner'\n-        line='Banner /etc/issue.net'\n-        state=present\n-    notify: restart ssh\n-    tags:\n-      - section9\n-      - section9.3\n-      - section9.3.14\n \n   - name: 9.4 Restrict root Login to System Console (stat securetty) (Not Scored)\n     stat: path=/etc/securetty", "release": "2cfa28fd756194b32e320ab9c0df1e455f27dc38"}]}, {"repo": "sensu/sensu-ansible", "_Commit__release_starts_at": null, "_Commit__release_ends_at": "9b3cb140022faf899910398013334755c8050175", "author_id": "MDQ6VXNlcjc0NzM0Mg==", "author_name": "Daniel Miranda", "committer_id": "MDQ6VXNlcjExOTAyNDc2", "committer_name": "Stephen Muth", "committer_email": "smuth4@users.noreply.github.com", "message": "Fix server SSL configuration for non-default file names (#53)\n\nSSL certificate files were copied with their original names, but the\r\nconfiguration files always used the \"default\" names of cert.pem and\r\nkey.pem. Specify the destination basenames explicitly to avoid\r\nmismatches.", "sha": "c74bc211402b5a6f1a923ab8d71b9af74a5aa0e7", "url": "https://api.github.com/repos/sensu/sensu-ansible/commits/c74bc211402b5a6f1a923ab8d71b9af74a5aa0e7", "parents": ["b02504a0a0a8b0e4169d0327a865dfe08866e9ec"], "files": [{"sha": "35458a110117ef9e9b42fe3d0aaa5a9073643f62", "filename": "tasks/ssl.yml", "previous_filename": null, "additions": 4, "deletions": 4, "changes": 8, "blob_url": "https://github.com/sensu/sensu-ansible/blob/c74bc211402b5a6f1a923ab8d71b9af74a5aa0e7/tasks/ssl.yml", "raw_url": "https://github.com/sensu/sensu-ansible/raw/c74bc211402b5a6f1a923ab8d71b9af74a5aa0e7/tasks/ssl.yml", "status": "modified", "patch": "@@ -15,12 +15,12 @@\n \n   - name: Deploy the Sensu client SSL cert/key\n     copy:\n-      src: \"{{ item }}\"\n+      src: \"{{ item.src }}\"\n       owner: \"{{ sensu_user_name }}\"\n       remote_src: \"{{ sensu_ssl_deploy_remote_src }}\"\n       group: \"{{ sensu_group_name }}\"\n-      dest: \"{{ sensu_config_path }}/ssl\"\n+      dest: \"{{ sensu_config_path }}/ssl/{{ item.dest }}\"\n     with_items:\n-      - \"{{ sensu_ssl_client_cert }}\"\n-      - \"{{ sensu_ssl_client_key }}\"\n+      - {src: \"{{ sensu_ssl_client_cert }}\", dest: cert.pem}\n+      - {src: \"{{ sensu_ssl_client_key }}\", dest: key.pem}\n     notify: restart sensu-client service", "release_starts_at": null, "release_ends_at": "9b3cb140022faf899910398013334755c8050175"}], "release_starts_at": "f635e4cb6aa1fb00663aa57a4f116b2b2c83b804"}, {"repo": "awailly/cis-ubuntu-ansible", "_Commit__release_start_at": "2cfa28fd756194b32e320ab9c0df1e455f27dc38", "author_id": null, "author_name": "Ubuntu", "committer_id": null, "committer_name": "Ubuntu", "committer_email": "ubuntu@ip-172-31-38-171.eu-west-1.compute.internal", "message": "Fix #75 Modifying 13.8 to not remove but suggest removal\n\n- Closer to CIS rule\n- There was a race condition with 13.9", "sha": "893a1fff787d5de72ccc2033fc28ef228432b780", "url": "https://api.github.com/repos/awailly/cis-ubuntu-ansible/commits/893a1fff787d5de72ccc2033fc28ef228432b780", "parents": ["9eb1a8fa8e281ef06687c1851f51fa0beec3e232"], "files": [{"sha": "3ca1b18faf03c323aea9ac1272b1f63cf33a734b", "filename": "tasks/section_13_level1.yml", "previous_filename": null, "additions": 3, "deletions": 5, "changes": 8, "blob_url": "https://github.com/awailly/cis-ubuntu-ansible/blob/893a1fff787d5de72ccc2033fc28ef228432b780/tasks/section_13_level1.yml", "raw_url": "https://github.com/awailly/cis-ubuntu-ansible/raw/893a1fff787d5de72ccc2033fc28ef228432b780/tasks/section_13_level1.yml", "status": "modified", "patch": "@@ -235,18 +235,16 @@\n \n   - name: 13.18 Check for Presence of User .netrc Files (stat) (Scored)\n     stat: path='{{ item }}/.netrc'\n-    with_items: home_users.stdout_lines\n+    with_items: '{{ home_users.stdout_lines }}'\n     register: netrc_files\n     tags:\n       - section13\n       - section13.18\n \n   - name: 13.18 Check for Presence of User .netrc Files (Scored)\n-    file: >\n-        path='{{ item.stat.path }}'\n-        state=absent\n+    debug: msg='Check if {{ item.stat.path}} is needed, and remove otherwise'\n     when: item is defined and item.stat.exists == True\n-    with_items: netrc_files.results\n+    with_items: '{{ netrc_files.results }}'\n     tags:\n       - section13\n       - section13.18", "release": "2cfa28fd756194b32e320ab9c0df1e455f27dc38"}]}, {"repo": "awailly/cis-ubuntu-ansible", "_Commit__release_start_at": "2cfa28fd756194b32e320ab9c0df1e455f27dc38", "author_id": "MDQ6VXNlcjYyNjIyNg==", "author_name": "Emlyn Stokes", "committer_id": "MDQ6VXNlcjE3NjQyMTA=", "committer_name": "Paul Chaignon", "committer_email": "paul.chaignon@gmail.com", "message": "Fix rsyslog section numbering to match CIS doc (#123)", "sha": "2cfa28fd756194b32e320ab9c0df1e455f27dc38", "url": "https://api.github.com/repos/awailly/cis-ubuntu-ansible/commits/2cfa28fd756194b32e320ab9c0df1e455f27dc38", "parents": ["a58e5e6a7e5184c80cf44ff600e8eea60d32cba5"], "files": [{"sha": "c5ba59dd7c2365d764ae1a32c4b97f555f8439bb", "filename": "tasks/section_08_level1.yml", "previous_filename": null, "additions": 4, "deletions": 4, "changes": 8, "blob_url": "https://github.com/awailly/cis-ubuntu-ansible/blob/2cfa28fd756194b32e320ab9c0df1e455f27dc38/tasks/section_08_level1.yml", "raw_url": "https://github.com/awailly/cis-ubuntu-ansible/raw/2cfa28fd756194b32e320ab9c0df1e455f27dc38/tasks/section_08_level1.yml", "status": "modified", "patch": "@@ -17,7 +17,7 @@\n       - section8.2\n       - section8.2.1\n \n-  - name: 8.2.2 Ensure the rsyslog Service is activated (Scored)\n+  - name: 8.2.2.1 Ensure the rsyslog Service is activated (check) (Scored)\n     command: grep 'start on filesystem' /etc/rsyslog.conf\n     register: startonfilesystem\n     changed_when: False\n@@ -26,9 +26,9 @@\n     tags:\n       - section8\n       - section8.2\n-      - section8.2.5\n+      - section8.2.2\n \n-  - name: 8.2.5.2 Configure rsyslog to Send Logs to a Remote Log Host (start rsyslog) (Scored)\n+  - name: 8.2.2.2 Ensure the rsyslog Service is activated (Scored)\n     lineinfile:\n        dest=/etc/rsyslog.conf\n        line='start on filesystem'\n@@ -38,7 +38,7 @@\n     tags:\n       - section8\n       - section8.2\n-      - section8.2.5\n+      - section8.2.2\n \n   - name: 8.2.3 Configure /etc/rsyslog.conf (Not Scored)\n     lineinfile:", "release": "2cfa28fd756194b32e320ab9c0df1e455f27dc38"}]}, {"repo": "awailly/cis-ubuntu-ansible", "_Commit__release_start_at": "2cfa28fd756194b32e320ab9c0df1e455f27dc38", "author_id": "MDQ6VXNlcjk3MTc1NQ==", "author_name": "Aur\u00e9lien Wailly", "committer_id": "MDQ6VXNlcjk3MTc1NQ==", "committer_name": "Aur\u00e9lien Wailly", "committer_email": "aurelien.wailly@gmail.com", "message": "Fix #40 - Check operating system family\n\n- Added first check in tasks/main.yml for ansible_os_family\n- Removed unused file", "sha": "3cfb55b2d088a2fc0e477e9b55318102256c733a", "url": "https://api.github.com/repos/awailly/cis-ubuntu-ansible/commits/3cfb55b2d088a2fc0e477e9b55318102256c733a", "parents": ["c5ee48e16a5905db37ff878be57f5de16f769368"], "files": [{"sha": "05d3d68aba16906138e8460efb0095ec47b77fb6", "filename": "tasks/main.yml", "previous_filename": null, "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/awailly/cis-ubuntu-ansible/blob/3cfb55b2d088a2fc0e477e9b55318102256c733a/tasks/main.yml", "raw_url": "https://github.com/awailly/cis-ubuntu-ansible/raw/3cfb55b2d088a2fc0e477e9b55318102256c733a/tasks/main.yml", "status": "modified", "patch": "@@ -1,5 +1,9 @@\n ---\n \n+  - name: Check if OS is Debian-based (we do not support others)\n+    debug: \"Check family\"\n+    failed_when: ansible_os_family != \"Debian\"\n+\n   - include: section_01.yml\n     tags: section01\n ", "release": "2cfa28fd756194b32e320ab9c0df1e455f27dc38"}]}, {"repo": "awailly/cis-ubuntu-ansible", "_Commit__release_start_at": "2cfa28fd756194b32e320ab9c0df1e455f27dc38", "author_id": "MDQ6VXNlcjk3MTc1NQ==", "author_name": "Aur\u00e9lien Wailly", "committer_id": "MDQ6VXNlcjk3MTc1NQ==", "committer_name": "Aur\u00e9lien Wailly", "committer_email": "aurelien.wailly@gmail.com", "message": "Fix #3 Adding lines in the audit.rules files\n\nDetected file are automatically added to the file.", "sha": "65a0d28b6ec721aa7a5396f559b1085d61ac3c90", "url": "https://api.github.com/repos/awailly/cis-ubuntu-ansible/commits/65a0d28b6ec721aa7a5396f559b1085d61ac3c90", "parents": ["a774d7f239841cdb705317557a11935ca87238ad"], "files": [{"sha": "8252deeeecfb6adaa52cf98b45f21e1d1928cd03", "filename": "tasks/section_08_level2.yml", "previous_filename": null, "additions": 5, "deletions": 2, "changes": 7, "blob_url": "https://github.com/awailly/cis-ubuntu-ansible/blob/65a0d28b6ec721aa7a5396f559b1085d61ac3c90/tasks/section_08_level2.yml", "raw_url": "https://github.com/awailly/cis-ubuntu-ansible/raw/65a0d28b6ec721aa7a5396f559b1085d61ac3c90/tasks/section_08_level2.yml", "status": "modified", "patch": "@@ -233,14 +233,17 @@\n       - section8.1.12\n \n   - name: 8.1.12 Collect Use of Privileged Commands (infos) (Scored)\n-    debug: msg=\"Add a line in auditd for the privileged program\"\n+    lineinfile: >\n+        dest=/etc/audit/audit.rules\n+        line={{ item }}\n+        state=present\n+        create=yes\n     with_items: audit_lines_for_find.stdout_lines\n     tags:\n       - section8\n       - section8.1\n       - section8.1.12\n \n-\n   - name: 8.1.18 Make the Audit Configuration Immutable (Scored)\n     lineinfile: >\n         dest='/etc/audit/audit.rules'", "release": "2cfa28fd756194b32e320ab9c0df1e455f27dc38"}]}, {"repo": "nusenu/ansible-relayor", "_Commit__release_start_at": "1224adf2811c827a09ff0bf133fbb476901a547d", "author_id": null, "author_name": "nusenu", "committer_id": null, "committer_name": "nusenu", "committer_email": "nusenu@openmailbox.org", "message": "CentOS/Fedora: move DataDirs to /var/lib/tor-instances (fixes #58)\n\nmake sure SELinux type is set properly on /var/lib/tor-instances\n\nallow the systemd service to write to /var/lib/tor-instances (drop-in)\nThanks to Jamie Nguyen for suggesting that fix.\n\nlog via syslog on Linux systems", "sha": "51dcdf691a7801895b569a5a927e30030d8feb70", "url": "https://api.github.com/repos/nusenu/ansible-relayor/commits/51dcdf691a7801895b569a5a927e30030d8feb70", "parents": ["95a0ffb87f5a5ecbf178ee4a5b4f890acaba6cbe"], "files": [{"sha": "47d0b3c467647d4a309f7231d0a976906113bee3", "filename": "tasks/configure.yml", "previous_filename": null, "additions": 19, "deletions": 16, "changes": 35, "blob_url": "https://github.com/nusenu/ansible-relayor/blob/51dcdf691a7801895b569a5a927e30030d8feb70/tasks/configure.yml", "raw_url": "https://github.com/nusenu/ansible-relayor/raw/51dcdf691a7801895b569a5a927e30030d8feb70/tasks/configure.yml", "status": "modified", "patch": "@@ -83,20 +83,6 @@\n   tags:\n    - createdir\n \n-- name: Ensure per-instance DataDir exists\n-  become: yes\n-  file: path={{ tor_DataDir }}/{{ item[0] }}_{{ item.1.orport }}\n-    state=directory\n-    owner=\"_tor-{{ item[0] }}_{{ item.1.orport }}\"\n-    group=\"_tor-{{ item[0] }}_{{ item.1.orport }}\"\n-    mode=0700\n-    recurse=yes\n-  with_nested:\n-   - \"{{ tor_ips }}\"\n-   - \"{{ tor_ports }}\"\n-  tags:\n-   - createdir\n-\n - name: Ensure \"keys\" subfolder exists\n   become: yes\n   file: path={{ tor_DataDir }}/{{ item[0] }}_{{ item.1.orport }}/keys\n@@ -162,13 +148,30 @@\n    dest={{ tor_DataDir }}/{{ item[0] }}_{{ item.1.orport }}/keys/{{ item[2] }}\n    owner=\"_tor-{{ item[0] }}_{{ item.1.orport }}\"\n    mode=700\n+   setype=tor_var_lib_t\n   with_nested:\n    - \"{{ tor_ips }}\"\n    - \"{{ tor_ports }}\"\n    - [ 'ed25519_master_id_public_key', 'ed25519_signing_cert', 'ed25519_signing_secret_key' ]\n   tags:\n    - renewkey\n \n+# This needs to be at the end to fix SELinux contexts recursively\n+- name: Ensure per-instance DataDir exists\n+  become: yes\n+  file: path={{ tor_DataDir }}/{{ item[0] }}_{{ item.1.orport }}\n+    state=directory\n+    owner=\"_tor-{{ item[0] }}_{{ item.1.orport }}\"\n+    group=\"_tor-{{ item[0] }}_{{ item.1.orport }}\"\n+    mode=0700\n+    recurse=yes\n+    setype=tor_var_lib_t\n+  with_nested:\n+   - \"{{ tor_ips }}\"\n+   - \"{{ tor_ports }}\"\n+  tags:\n+   - createdir\n+\n - name: Ensure Tor config directory exists\n   become: yes\n   file: path={{ tor_ConfDir }}\n@@ -183,7 +186,7 @@\n     state=directory\n     owner=root\n     mode=755\n-  when: ansible_pkg_mgr != 'apt'\n+  when: ansible_system != 'Linux'\n \n # we only use distinct logfiles on systems that have no SyslogIdentityTag support yet (all non-Debian plaforms)\n # otherwise we log to syslog with SyslogIdentityTag to avoid the filesystem permissions troubles with logrotate.\n@@ -202,7 +205,7 @@\n   with_nested:\n    - tor_ips\n    - tor_ports\n-  when: ansible_pkg_mgr != 'apt'\n+  when: ansible_system != 'Linux'\n \n - name: Generating torrc file(s)\n   become: yes", "release": "1224adf2811c827a09ff0bf133fbb476901a547d"}, {"sha": "8d16346f0b8e9948b65bf34e38a532d416e5ceb1", "filename": "tasks/rpm_install.yml", "previous_filename": null, "additions": 21, "deletions": 0, "changes": 21, "blob_url": "https://github.com/nusenu/ansible-relayor/blob/51dcdf691a7801895b569a5a927e30030d8feb70/tasks/rpm_install.yml", "raw_url": "https://github.com/nusenu/ansible-relayor/raw/51dcdf691a7801895b569a5a927e30030d8feb70/tasks/rpm_install.yml", "status": "modified", "patch": "@@ -5,9 +5,11 @@\n     tor_user: toranon\n     tor_ConfDir: /etc/tor\n     tor_RunAsDaemon: 0\n+    tor_DataDir: /var/lib/tor-instances\n   tags:\n    - reconfigure\n    - renewkey\n+   - createdir\n \n - name: Ensure tor package is installed (dnf)\n   become: yes\n@@ -34,3 +36,22 @@\n   seboolean: name=tor_can_network_relay state=yes persistent=yes\n   when: ansible_selinux.status == 'enabled'\n \n+- name: Ensure systemd drop-in folder is present\n+  become: yes\n+  file: path=/etc/systemd/system/tor@.service.d\n+    state=directory\n+    owner=root\n+    mode=0755\n+\n+# this is needed for a small service file modification (allow it to write to /var/lib/tor-instances)\n+# without replacing the maintainer's file, for details see\n+# http://www.freedesktop.org/software/systemd/man/systemd.unit.html#id-1.11.3\n+- name: Ensure service file drop-in is present\n+  become: yes\n+  copy: src=local.conf\n+   dest=/etc/systemd/system/tor@.service.d/local.conf\n+   owner=root\n+   mode=640\n+  notify: systemctl daemon-reload\n+\n+- meta: flush_handlers", "release": "1224adf2811c827a09ff0bf133fbb476901a547d"}]}, {"repo": "nusenu/ansible-relayor", "_Commit__release_start_at": "9f2f1160c4dc3fea2f6e81e42ba8a6254ef093db", "author_id": "MDQ6VXNlcjExMTY1ODQ4", "author_name": "nusenu", "committer_id": "MDQ6VXNlcjExMTY1ODQ4", "committer_name": "nusenu", "committer_email": "nusenu-github@riseup.net", "message": "fix ansible-lint spacing [E206] (#193)", "sha": "9f2f1160c4dc3fea2f6e81e42ba8a6254ef093db", "url": "https://api.github.com/repos/nusenu/ansible-relayor/commits/9f2f1160c4dc3fea2f6e81e42ba8a6254ef093db", "parents": ["7f02cba4441b5367d6916857c9b41f3abae915db"], "files": [{"sha": "27d3f5f8c4469632bd158d52f5894919e55ae7cc", "filename": "tasks/ip-list.yml", "previous_filename": null, "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/nusenu/ansible-relayor/blob/9f2f1160c4dc3fea2f6e81e42ba8a6254ef093db/tasks/ip-list.yml", "raw_url": "https://github.com/nusenu/ansible-relayor/raw/9f2f1160c4dc3fea2f6e81e42ba8a6254ef093db/tasks/ip-list.yml", "status": "modified", "patch": "@@ -14,7 +14,7 @@\n \n - name: workaround for ansible bug 14829 (2/3)\n   set_fact:\n-    tor_v6ips: \"{{ tor_available_public_ipv6s[0:tor_ipv4_count|int]|ipv6('address') }}\"\n+    tor_v6ips: \"{{ tor_available_public_ipv6s[0:tor_ipv4_count|int] | ipv6('address') }}\"\n \n - name: workaround for ansible bug 14829 (3/3)\n   set_fact:\n@@ -33,4 +33,4 @@\n \n - name: setup IP list (2/2)\n   set_fact:\n-    tor_ips: \"{{ tor_ipsinterm.results | map(attribute='ansible_facts.ips')|list}}\"\n+    tor_ips: \"{{ tor_ipsinterm.results | map(attribute='ansible_facts.ips') | list }}\"", "release": "9f2f1160c4dc3fea2f6e81e42ba8a6254ef093db"}]}, {"repo": "nusenu/ansible-relayor", "_Commit__release_start_at": "1224adf2811c827a09ff0bf133fbb476901a547d", "author_id": null, "author_name": "nusenu", "committer_id": null, "committer_name": "nusenu", "committer_email": "nusenu@openmailbox.org", "message": "fix for #11\nThis avoids troubles if the relay operator migrated the datadir\nfrom another server but forgot to fix filepermissions.", "sha": "25268594e4bf662f487ddd8792c22b93b27160fc", "url": "https://api.github.com/repos/nusenu/ansible-relayor/commits/25268594e4bf662f487ddd8792c22b93b27160fc", "parents": ["7a3aa0de9bf76ff1b18e6da304031150e4550142"], "files": [{"sha": "492991728f4d67dbfeefed516a2998d2d43791eb", "filename": "tasks/configure.yml", "previous_filename": null, "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/nusenu/ansible-relayor/blob/25268594e4bf662f487ddd8792c22b93b27160fc/tasks/configure.yml", "raw_url": "https://github.com/nusenu/ansible-relayor/raw/25268594e4bf662f487ddd8792c22b93b27160fc/tasks/configure.yml", "status": "modified", "patch": "@@ -6,6 +6,7 @@\n     state=directory\n     owner={{ tor_user }}\n     mode=0700\n+    recurse=yes\n   with_nested:\n    - \"{{ tor_ips }}\"\n    - \"{{ tor_ports }}\"", "release": "1224adf2811c827a09ff0bf133fbb476901a547d"}]}, {"repo": "nusenu/ansible-relayor", "_Commit__release_start_at": "1224adf2811c827a09ff0bf133fbb476901a547d", "author_id": null, "author_name": "nusenu", "committer_id": null, "committer_name": "nusenu", "committer_email": "nusenu@openmailbox.org", "message": "OpenBSD: fix a bug in openfiles-max handling (closes #37) Users of previous versions can remove the line \"tordaemon::openfiles-max=13500::tc=daemon:\" from their /etc/login.conf files", "sha": "c5b489aa56c545dd0b51910b5a0d701d838ff071", "url": "https://api.github.com/repos/nusenu/ansible-relayor/commits/c5b489aa56c545dd0b51910b5a0d701d838ff071", "parents": ["12d2d30c292e5749809cd7476458762a4de31554"], "files": [{"sha": "3929e7fce2cbb6891d2f9e994ddd158f933f973e", "filename": "tasks/openbsd_install.yml", "previous_filename": null, "additions": 6, "deletions": 7, "changes": 13, "blob_url": "https://github.com/nusenu/ansible-relayor/blob/c5b489aa56c545dd0b51910b5a0d701d838ff071/tasks/openbsd_install.yml", "raw_url": "https://github.com/nusenu/ansible-relayor/raw/c5b489aa56c545dd0b51910b5a0d701d838ff071/tasks/openbsd_install.yml", "status": "modified", "patch": "@@ -32,14 +32,13 @@\n   lineinfile: dest=/etc/sysctl.conf regexp=^kern.maxfiles line=\"kern.maxfiles=20000\" create=yes\n   when: currentlimits.stdout|int < 20000\n \n+# We rise openfiles limits for every tor instance separately.\n+# An instance is identified by its rc.d file name.\n - name: Ensure Tor process file descriptor limits are reasonable (OpenBSD)\n   sudo: yes\n-  lineinfile: \"dest=/etc/login.conf line='{{ tor_loginclass }}::openfiles-max=13500::tc=daemon:'\"\n+  lineinfile: \"dest=/etc/login.conf line='tor{{ item[0]| replace('.','_') }}_{{ item.1.orport }}::openfiles-max=13500::tc=daemon:'\"\n+  with_nested:\n+   - tor_ips\n+   - tor_ports\n   #TODO\n   #notify: restart tor\n-\n-- name: Ensure 'tor_user' has appropriate login class set (OpenBSD)\n-  sudo: yes\n-  user: name={{ tor_user }} login_class={{ tor_loginclass }}\n-  #TODO \n-  #notify: restart tor", "release": "1224adf2811c827a09ff0bf133fbb476901a547d"}]}, {"repo": "Capgemini/Apollo", "_Commit__release_start_at": "308889b1c7c114ab9079c9050ee083fffe5508be", "author_id": "MDQ6VXNlcjE2ODE4OTY=", "author_name": "Graham Taylor", "committer_id": "MDQ6VXNlcjE2ODE4OTY=", "committer_name": "Graham Taylor", "committer_email": "gtayzlor@gmail.com", "message": "Fix #575 - remove rebuild_container in favour of just using systemd files", "sha": "127772fc5ffc3183dcbbef24e56aa9ed6c93da2d", "url": "https://api.github.com/repos/Capgemini/Apollo/commits/127772fc5ffc3183dcbbef24e56aa9ed6c93da2d", "parents": ["3e6af1f0f55cd8f3bfb91cac5560c476d8145a32"], "files": [{"sha": "becb68096fd3cabb17b1b80aefa489048c544e28", "filename": "roles/marathon/defaults/main.yml", "previous_filename": null, "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/Capgemini/Apollo/blob/127772fc5ffc3183dcbbef24e56aa9ed6c93da2d/roles/marathon/defaults/main.yml", "raw_url": "https://github.com/Capgemini/Apollo/raw/127772fc5ffc3183dcbbef24e56aa9ed6c93da2d/roles/marathon/defaults/main.yml", "status": "modified", "patch": "@@ -12,7 +12,6 @@ marathon_java_settings: '-Xmx512m -Xms512m -XX:+HeapDumpOnOutOfMemoryError'\n marathon_artifact_store: 'file:///store'\n marathon_artifact_store_dir: '/etc/marathon/store'\n marathon_server_zk_group: marathon_servers\n-marathon_rebuild_container: False\n marathon_image: \"mesosphere/marathon:v{{ marathon_version }}\"\n marathon_master_peers: \"zk://{{ zookeeper_peers_nodes }}/mesos\"\n marathon_zk_peers: \"zk://{{ zookeeper_peers_nodes }}/marathon\"", "release": "308889b1c7c114ab9079c9050ee083fffe5508be"}, {"sha": "d64038473437f1ed08189396ec04e65845069ca7", "filename": "roles/cadvisor/defaults/main.yml", "previous_filename": null, "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/Capgemini/Apollo/blob/127772fc5ffc3183dcbbef24e56aa9ed6c93da2d/roles/cadvisor/defaults/main.yml", "raw_url": "https://github.com/Capgemini/Apollo/raw/127772fc5ffc3183dcbbef24e56aa9ed6c93da2d/roles/cadvisor/defaults/main.yml", "status": "modified", "patch": "@@ -8,4 +8,3 @@ cadvisor_hostname: \"{{ ansible_ssh_host }}\"\n cadvisor_image: \"google/cadvisor:{{ cadvisor_version }}\"\n cadvisor_consul_dir: /etc/consul.d\n cadvisor_consul_service_id: \"{{ ansible_hostname }}:cadvisor:8080\"\n-cadvisor_rebuild_container: false", "release": "308889b1c7c114ab9079c9050ee083fffe5508be"}, {"sha": "8c10c21748929a40bcb641e843fee3254248aea2", "filename": "roles/mesos/defaults/main.yml", "previous_filename": null, "additions": 0, "deletions": 2, "changes": 2, "blob_url": "https://github.com/Capgemini/Apollo/blob/127772fc5ffc3183dcbbef24e56aa9ed6c93da2d/roles/mesos/defaults/main.yml", "raw_url": "https://github.com/Capgemini/Apollo/raw/127772fc5ffc3183dcbbef24e56aa9ed6c93da2d/roles/mesos/defaults/main.yml", "status": "modified", "patch": "@@ -14,14 +14,12 @@ mesos_containerizers: \"docker,mesos\"\n mesos_resources: \"ports(*):[31000-32000]\"\n mesos_slave_work_dir: \"/tmp/mesos\"\n mesos_slave_image: \"mesosphere/mesos-slave:{{ mesos_version }}\"\n-mesos_slave_rebuild_container: false\n \n # Defaults file for mesos-master\n mesos_zookeeper_group: zookeeper_servers\n mesos_master_port: 5050\n mesos_master_work_dir: \"/var/lib/mesos\"\n mesos_master_image: \"mesosphere/mesos-master:{{ mesos_version }}\"\n-mesos_master_rebuild_container: false\n \n prometheus_mesos_exporter_image: \"prom/mesos-exporter:latest\"\n prometheus_mesos_exporter_port: 9105", "release": "308889b1c7c114ab9079c9050ee083fffe5508be"}, {"sha": "28d7bbb49fb9907fcc24b415e0c4d312d7892020", "filename": "roles/zookeeper/defaults/main.yml", "previous_filename": null, "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/Capgemini/Apollo/blob/127772fc5ffc3183dcbbef24e56aa9ed6c93da2d/roles/zookeeper/defaults/main.yml", "raw_url": "https://github.com/Capgemini/Apollo/raw/127772fc5ffc3183dcbbef24e56aa9ed6c93da2d/roles/zookeeper/defaults/main.yml", "status": "modified", "patch": "@@ -1,6 +1,5 @@\n ---\n consul_dir: /etc/consul.d\n-zookeeper_rebuild_container: false\n zookeeper_config_dir: /etc/zookeeper/conf\n zookeeper_image: \"mesosphere/mesos:0.26.0-0.2.145.ubuntu1404\"\n zookeeper_client_port: 2181", "release": "308889b1c7c114ab9079c9050ee083fffe5508be"}]}, {"repo": "Capgemini/Apollo", "_Commit__release_start_at": "308889b1c7c114ab9079c9050ee083fffe5508be", "author_id": "MDQ6VXNlcjE2ODE4OTY=", "author_name": "Graham Taylor", "committer_id": "MDQ6VXNlcjE2ODE4OTY=", "committer_name": "Graham Taylor", "committer_email": "gtayzlor@gmail.com", "message": "Fix #497, #496, #502 - Upgrade mesos and marathon to latest stable versions", "sha": "ecbbe0b1fe5397830faf4c88cc4919146b2e6b11", "url": "https://api.github.com/repos/Capgemini/Apollo/commits/ecbbe0b1fe5397830faf4c88cc4919146b2e6b11", "parents": ["21712b74b7f5d936e70186bbed6bb37e3a7ad5e6"], "files": [{"sha": "72cfdcad0e57931884baedba6e81399dde19d195", "filename": "roles/zookeeper/tasks/main.yml", "previous_filename": null, "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Capgemini/Apollo/blob/ecbbe0b1fe5397830faf4c88cc4919146b2e6b11/roles/zookeeper/tasks/main.yml", "raw_url": "https://github.com/Capgemini/Apollo/raw/ecbbe0b1fe5397830faf4c88cc4919146b2e6b11/roles/zookeeper/tasks/main.yml", "status": "modified", "patch": "@@ -75,7 +75,7 @@\n - name: run zookeeper container\n   docker:\n     name: zookeeper\n-    image: \"mesosphere/mesos:0.23.0-1.0.ubuntu1404\"\n+    image: \"{{ zookeeper_image }}\"\n     state: started\n     volumes:\n     - \"{{ zookeeper_config_dir }}/:{{ zookeeper_config_dir }}/\"", "release": "308889b1c7c114ab9079c9050ee083fffe5508be"}, {"sha": "d7431cbd7efff438af55b61edb261b0e2b6c8a71", "filename": "roles/mesos/tasks/slave.yml", "previous_filename": null, "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Capgemini/Apollo/blob/ecbbe0b1fe5397830faf4c88cc4919146b2e6b11/roles/mesos/tasks/slave.yml", "raw_url": "https://github.com/Capgemini/Apollo/raw/ecbbe0b1fe5397830faf4c88cc4919146b2e6b11/roles/mesos/tasks/slave.yml", "status": "modified", "patch": "@@ -15,7 +15,7 @@\n   when: mesos_install_mode == \"slave\"\n   docker:\n     name: mesos-slave\n-    image: \"mesosphere/mesos-slave:0.23.0-1.0.ubuntu1404\"\n+    image: \"{{ mesos_slave_image }}\"\n     state: started\n     privileged: true\n     volumes:", "release": "308889b1c7c114ab9079c9050ee083fffe5508be"}, {"sha": "036cb479c1a313ba556a9c2690862004ab5e6e55", "filename": "roles/mesos/defaults/main.yml", "previous_filename": null, "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Capgemini/Apollo/blob/ecbbe0b1fe5397830faf4c88cc4919146b2e6b11/roles/mesos/defaults/main.yml", "raw_url": "https://github.com/Capgemini/Apollo/raw/ecbbe0b1fe5397830faf4c88cc4919146b2e6b11/roles/mesos/defaults/main.yml", "status": "modified", "patch": "@@ -6,17 +6,20 @@ mesos_cluster_name: \"Cluster01\"\n mesos_ip: \"{{ ansible_default_ipv4.address }}\"\n mesos_hostname: \"{{ ansible_ssh_host }}\"\n mesos_docker_socket: \"/var/run/weave/weave.sock\"\n+mesos_version: \"0.25.0-0.2.70.ubuntu1404\"\n \n # Defaults file for mesos-salve\n mesos_slave_port: 5051\n mesos_containerizers: \"docker,mesos\"\n mesos_resources: \"ports(*):[31000-32000]\"\n mesos_slave_work_dir: \"/tmp/mesos\"\n+mesos_slave_image: \"mesosphere/mesos-slave:{{ mesos_version }}\"\n \n # Defaults file for mesos-master\n mesos_zookeeper_group: zookeeper_servers\n mesos_master_port: 5050\n mesos_master_work_dir: \"/var/lib/mesos\"\n+mesos_master_image: \"mesosphere/mesos-master:{{ mesos_version }}\"\n \n # The Mesos quorum value is based on the number of Mesos Masters. Take the\n # number of masters, divide by 2, and round-up to nearest integer. For example,", "release": "308889b1c7c114ab9079c9050ee083fffe5508be"}, {"sha": "96332335081d128ae85c81eadf9ed2b9b005ae12", "filename": "roles/mesos/tasks/master.yml", "previous_filename": null, "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Capgemini/Apollo/blob/ecbbe0b1fe5397830faf4c88cc4919146b2e6b11/roles/mesos/tasks/master.yml", "raw_url": "https://github.com/Capgemini/Apollo/raw/ecbbe0b1fe5397830faf4c88cc4919146b2e6b11/roles/mesos/tasks/master.yml", "status": "modified", "patch": "@@ -26,7 +26,7 @@\n   when: mesos_install_mode == \"master\"\n   docker:\n     name: mesos-master\n-    image: \"mesosphere/mesos-master:0.23.0-1.0.ubuntu1404\"\n+    image: \"{{ mesos_master_image }}\"\n     state: started\n     volumes:\n     - \"{{ mesos_master_work_dir }}:{{ mesos_master_work_dir }}\"", "release": "308889b1c7c114ab9079c9050ee083fffe5508be"}, {"sha": "5dfba28358408db871316d05ded3388319b22c2d", "filename": "roles/zookeeper/defaults/main.yml", "previous_filename": null, "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Capgemini/Apollo/blob/ecbbe0b1fe5397830faf4c88cc4919146b2e6b11/roles/zookeeper/defaults/main.yml", "raw_url": "https://github.com/Capgemini/Apollo/raw/ecbbe0b1fe5397830faf4c88cc4919146b2e6b11/roles/zookeeper/defaults/main.yml", "status": "modified", "patch": "@@ -1,6 +1,7 @@\n ---\n # defaults file for zookeeper\n zookeeper_config_dir: \"/etc/zookeeper/conf\"\n+zookeeper_image: \"mesosphere/mesos:0.25.0-0.2.70.ubuntu1404\"\n zookeeper_client_port: 2181\n zookeeper_leader_connect_port: 2888\n zookeeper_leader_election_port: 3888", "release": "308889b1c7c114ab9079c9050ee083fffe5508be"}, {"sha": "61cb9e578478b8283a214846577e5410078334c6", "filename": "roles/marathon/defaults/main.yml", "previous_filename": null, "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Capgemini/Apollo/blob/ecbbe0b1fe5397830faf4c88cc4919146b2e6b11/roles/marathon/defaults/main.yml", "raw_url": "https://github.com/Capgemini/Apollo/raw/ecbbe0b1fe5397830faf4c88cc4919146b2e6b11/roles/marathon/defaults/main.yml", "status": "modified", "patch": "@@ -2,7 +2,7 @@\n # defaults file for marathon\n marathon_consul_dir: /etc/consul.d\n marathon_enabled: true\n-marathon_version: '0.10.1'\n+marathon_version: '0.11.1'\n marathon_restart_policy: 'always'\n marathon_net: 'host'\n marathon_hostname: \"{{ ansible_ssh_host }}\"", "release": "308889b1c7c114ab9079c9050ee083fffe5508be"}]}, {"repo": "Capgemini/Apollo", "_Commit__release_start_at": "308889b1c7c114ab9079c9050ee083fffe5508be", "author_id": "MDQ6VXNlcjE2ODE4OTY=", "author_name": "Graham Taylor", "committer_id": "MDQ6VXNlcjE2ODE4OTY=", "committer_name": "Graham Taylor", "committer_email": "gtayzlor@gmail.com", "message": "Fix #175 - add tags for roles, and some slight refactoring / style fixes", "sha": "60cfb509e3db6d2c3f90b63cc543508f163383fe", "url": "https://api.github.com/repos/Capgemini/Apollo/commits/60cfb509e3db6d2c3f90b63cc543508f163383fe", "parents": ["9966c6de1ed4ef5071a9bea83b4bb69a11dd32ba"], "files": [{"sha": "5725195d5a7843718f63a5675404078e40a10c97", "filename": "roles/zookeeper/tasks/main.yml", "previous_filename": null, "additions": 9, "deletions": 1, "changes": 10, "blob_url": "https://github.com/Capgemini/Apollo/blob/60cfb509e3db6d2c3f90b63cc543508f163383fe/roles/zookeeper/tasks/main.yml", "raw_url": "https://github.com/Capgemini/Apollo/raw/60cfb509e3db6d2c3f90b63cc543508f163383fe/roles/zookeeper/tasks/main.yml", "status": "modified", "patch": "@@ -2,10 +2,14 @@\n   service: name=zookeeper state=started enabled=yes\n \n - name: Create zookeeper config file\n-  template: src=zoo.cfg.j2 dest=/etc/zookeeper/conf/zoo.cfg\n+  template:\n+    src: zoo.cfg.j2\n+    dest: /etc/zookeeper/conf/zoo.cfg\n   sudo: yes\n   notify:\n     - Restart zookeeper\n+  tags:\n+    - zookeeper\n \n - name: Create zookeeper myid file\n   copy:\n@@ -15,6 +19,8 @@\n   sudo: yes\n   notify:\n     - Restart zookeeper\n+  tags:\n+    - zookeeper\n \n - name: Set Zookeeper consul service definition\n   sudo: yes\n@@ -23,3 +29,5 @@\n     dest: \"{{ consul_dir }}/zookeeper.json\"\n   notify:\n     - Restart consul\n+  tags:\n+    - zookeeper", "release": "308889b1c7c114ab9079c9050ee083fffe5508be"}, {"sha": "16ed5a586b55c9fe4fdd47f38823afef7e183dcc", "filename": "roles/dnsmasq/tasks/main.yml", "previous_filename": null, "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Capgemini/Apollo/blob/60cfb509e3db6d2c3f90b63cc543508f163383fe/roles/dnsmasq/tasks/main.yml", "raw_url": "https://github.com/Capgemini/Apollo/raw/60cfb509e3db6d2c3f90b63cc543508f163383fe/roles/dnsmasq/tasks/main.yml", "status": "modified", "patch": "@@ -2,9 +2,13 @@\n # tasks file for dnsmasq\n - name: remove dnsmasq override\n   file: path=/etc/init/dnsmasq.override state=absent\n+  tags:\n+    - dnsmasq\n \n - name: ensure dnsmasq is running (and enable it at boot)\n   service: name=dnsmasq state=started enabled=yes\n+  tags:\n+    - dnsmasq\n \n - name: configure dnsmasq\n   sudo: yes", "release": "308889b1c7c114ab9079c9050ee083fffe5508be"}, {"sha": "08cbb1bd26906f4c3378277851ea10de194c4d89", "filename": "roles/docker/tasks/main.yml", "previous_filename": null, "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Capgemini/Apollo/blob/60cfb509e3db6d2c3f90b63cc543508f163383fe/roles/docker/tasks/main.yml", "raw_url": "https://github.com/Capgemini/Apollo/raw/60cfb509e3db6d2c3f90b63cc543508f163383fe/roles/docker/tasks/main.yml", "status": "modified", "patch": "@@ -2,6 +2,10 @@\n # tasks file for docker\n - name: remove docker override\n   file: path=/etc/init/docker.override state=absent\n+  tags:\n+    - docker\n \n - name: ensure docker is running (and enable it at boot)\n   service: name=docker state=started enabled=yes\n+  tags:\n+    - docker", "release": "308889b1c7c114ab9079c9050ee083fffe5508be"}, {"sha": "440abd93fdbbc41aa311cc636ca6c99cc44c0a5e", "filename": "roles/registrator/tasks/main.yml", "previous_filename": null, "additions": 7, "deletions": 1, "changes": 8, "blob_url": "https://github.com/Capgemini/Apollo/blob/60cfb509e3db6d2c3f90b63cc543508f163383fe/roles/registrator/tasks/main.yml", "raw_url": "https://github.com/Capgemini/Apollo/raw/60cfb509e3db6d2c3f90b63cc543508f163383fe/roles/registrator/tasks/main.yml", "status": "modified", "patch": "@@ -1,7 +1,11 @@\n ---\n \n # Install (docker-py) python package as is a docker module dependency.\n-- pip: name=docker-py version=1.1.0\n+- pip:\n+    name: docker-py\n+    version: 1.1.0\n+  tags:\n+    - registrator\n \n # tasks file for docker registrator\n - name: run registrator container\n@@ -15,3 +19,5 @@\n     hostname: \"{{ hostname }}\"\n     volumes:\n     - \"/var/run/docker.sock:/tmp/docker.sock\"\n+  tags:\n+    - registrator", "release": "308889b1c7c114ab9079c9050ee083fffe5508be"}, {"sha": "85100564a74e907d868f6a89452c18d9bbac9ff4", "filename": "roles/weave/tasks/main.yml", "previous_filename": null, "additions": 9, "deletions": 2, "changes": 11, "blob_url": "https://github.com/Capgemini/Apollo/blob/60cfb509e3db6d2c3f90b63cc543508f163383fe/roles/weave/tasks/main.yml", "raw_url": "https://github.com/Capgemini/Apollo/raw/60cfb509e3db6d2c3f90b63cc543508f163383fe/roles/weave/tasks/main.yml", "status": "modified", "patch": "@@ -9,13 +9,20 @@\n     - weave\n \n - name: Start up docker\n-  service: name=docker state=started\n+  service:\n+    name: docker\n+    state: started\n   tags:\n     - weave\n \n - name: configure weave\n   sudo: yes\n-  template: src=interfaces.j2 dest=/etc/network/interfaces.d/weave.cfg owner=root group=root mode=0644\n+  template:\n+    src: interfaces.j2\n+    dest: /etc/network/interfaces.d/weave.cfg\n+    owner: root\n+    group: root\n+    mode: 0644\n   tags:\n     - weave\n ", "release": "308889b1c7c114ab9079c9050ee083fffe5508be"}, {"sha": "70bcee16de04a4e151434138160d7a05ca816b12", "filename": "roles/haproxy/tasks/main.yml", "previous_filename": null, "additions": 20, "deletions": 4, "changes": 24, "blob_url": "https://github.com/Capgemini/Apollo/blob/60cfb509e3db6d2c3f90b63cc543508f163383fe/roles/haproxy/tasks/main.yml", "raw_url": "https://github.com/Capgemini/Apollo/raw/60cfb509e3db6d2c3f90b63cc543508f163383fe/roles/haproxy/tasks/main.yml", "status": "modified", "patch": "@@ -1,21 +1,35 @@\n ---\n # tasks file for haproxy\n-- name: assures {{ consul_template_dir }} dirs exists\n-  file: path={{ consul_template_dir }}/{{ item.path }} state=directory\n+- name: \"assures {{ consul_template_dir }} dirs exists\"\n+  file:\n+    path: \"{{ consul_template_dir }}/{{ item.path }}\"\n+    state: directory\n   with_items:\n     - { path: 'config' }\n     - { path: 'templates' }\n+  tags:\n+    - haproxy\n \n - name: upload template config files\n-  template: src=consul.cfg.j2 dest=\"{{ consul_template_dir }}/config/consul.cfg\" mode=0644\n+  template:\n+    src: consul.cfg.j2\n+    dest: \"{{ consul_template_dir }}/config/consul.cfg\"\n+    mode: 0644\n   sudo: yes\n+  tags:\n+    - haproxy\n \n - name: upload static config files\n-  copy: src={{ item.src }} dest=\"{{ consul_template_dir }}/{{ item.dst }}\" mode=0644\n+  copy:\n+    src: \"{{ item.src }}\"\n+    dest: \"{{ consul_template_dir }}/{{ item.dst }}\"\n+    mode: 0644\n   sudo: yes\n   with_items:\n     - { src: haproxy.cfg, dst: 'config/haproxy.cfg' }\n     - { src: haproxy.tmpl, dst: 'templates/haproxy.tmpl' }\n+  tags:\n+    - haproxy\n \n - name: run haproxy container\n   docker:\n@@ -36,3 +50,5 @@\n     volumes:\n     - \"{{ consul_template_dir }}/config:/config\"\n     - \"{{ consul_template_dir }}/templates:/templates\"\n+  tags:\n+    - haproxy", "release": "308889b1c7c114ab9079c9050ee083fffe5508be"}, {"sha": "dc1a95a34120575072494e88b77326d9fe4b594e", "filename": "roles/marathon/tasks/main.yml", "previous_filename": null, "additions": 24, "deletions": 7, "changes": 31, "blob_url": "https://github.com/Capgemini/Apollo/blob/60cfb509e3db6d2c3f90b63cc543508f163383fe/roles/marathon/tasks/main.yml", "raw_url": "https://github.com/Capgemini/Apollo/raw/60cfb509e3db6d2c3f90b63cc543508f163383fe/roles/marathon/tasks/main.yml", "status": "modified", "patch": "@@ -1,17 +1,15 @@\n ---\n # tasks file for marathon\n - name: Set Marathon hostname\n+  sudo: yes\n   copy:\n     content: \"{{marathon_local_address}}\"\n     dest: /etc/marathon/conf/hostname\n     mode: 0644\n-  sudo: yes\n-\n-- name: remove marathon override\n-  file: path=/etc/init/marathon.override state=absent\n-\n-- name: ensure marathon is running (and enable it at boot)\n-  service: name=marathon state=started enabled=yes\n+  notify:\n+    - Restart marathon\n+  tags:\n+    - marathon\n \n - name: Set Marathon consul service definition\n   sudo: yes\n@@ -20,3 +18,22 @@\n     dest: \"{{ consul_dir }}/marathon.json\"\n   notify:\n     - Restart consul\n+  tags:\n+    - marathon\n+\n+- name: remove marathon override\n+  sudo: yes\n+  file:\n+    path: /etc/init/marathon.override\n+    state: absent\n+  tags:\n+    - marathon\n+\n+- name: ensure marathon is running (and enable it at boot)\n+  sudo: yes\n+  service:\n+    name: marathon\n+    state: started\n+    enabled: yes\n+  tags:\n+    - marathon", "release": "308889b1c7c114ab9079c9050ee083fffe5508be"}, {"sha": "21638613d81c6652628a5c8136502e976c4ff578", "filename": "roles/consul/tasks/main.yml", "previous_filename": null, "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Capgemini/Apollo/blob/60cfb509e3db6d2c3f90b63cc543508f163383fe/roles/consul/tasks/main.yml", "raw_url": "https://github.com/Capgemini/Apollo/raw/60cfb509e3db6d2c3f90b63cc543508f163383fe/roles/consul/tasks/main.yml", "status": "modified", "patch": "@@ -38,19 +38,25 @@\n     name: consul\n     enabled: yes\n     state: started\n+  tags:\n+    - consul\n \n # Give some time for leader election to occur\n - name: wait for leader\n   wait_for:\n     host: \"{{ consul_bind_addr }}\"\n     port: 8301\n     delay: 10\n+  tags:\n+    - consul\n \n - name: remove consul-join override\n   file:\n     path: /etc/init/consul-join.override\n     state: absent\n   when: consul_join is defined\n+  tags:\n+    - consul\n \n - name: configure consul-join\n   sudo: yes\n@@ -72,9 +78,13 @@\n - name: force reload consul\n   sudo: yes\n   command: /sbin/restart consul\n+  tags:\n+    - consul\n \n - name: force wait for leader\n   wait_for:\n     host: \"{{ consul_bind_addr }}\"\n     port: 8301\n     delay: 10\n+  tags:\n+    - consul", "release": "308889b1c7c114ab9079c9050ee083fffe5508be"}, {"sha": "fa5682f6f31e74dda30d68d4654d1ba9b333de92", "filename": "roles/marathon/handlers/main.yml", "previous_filename": null, "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Capgemini/Apollo/blob/60cfb509e3db6d2c3f90b63cc543508f163383fe/roles/marathon/handlers/main.yml", "raw_url": "https://github.com/Capgemini/Apollo/raw/60cfb509e3db6d2c3f90b63cc543508f163383fe/roles/marathon/handlers/main.yml", "status": "modified", "patch": "@@ -2,5 +2,5 @@\n # handlers file for marathon\n # Restart service marathon, in all cases\n - name: Restart marathon\n-  service: name=marathon state=restarted\n   sudo: yes\n+  shell: /sbin/restart marathon", "release": "308889b1c7c114ab9079c9050ee083fffe5508be"}]}, {"repo": "mikolak-net/ansible-raspi-config", "_Commit__release_starts_at": null, "_Commit__release_ends_at": "3d62ad13598da398a7b54cd7b215e6ccaea2cb6a", "author_id": "MDQ6VXNlcjE3Mjk5MDA=", "author_name": "Miko\u0142aj Koziarkiewicz", "committer_id": "MDQ6VXNlcjE3Mjk5MDA=", "committer_name": "Miko\u0142aj Koziarkiewicz", "committer_email": "mikolak-net@users.noreply.github.com", "message": "Fixed #1.", "sha": "c6c140d3b402a3f91020e8095f8468e2cf8cbf9c", "url": "https://api.github.com/repos/mikolak-net/ansible-raspi-config/commits/c6c140d3b402a3f91020e8095f8468e2cf8cbf9c", "parents": ["584d564218d6e2e63d3ecca157daf817fe4d533c"], "files": [{"sha": "36d7777a3868889ec32147d660a13712208153f2", "filename": "meta/main.yml", "previous_filename": null, "additions": 10, "deletions": 3, "changes": 13, "blob_url": "https://github.com/mikolak-net/ansible-raspi-config/blob/c6c140d3b402a3f91020e8095f8468e2cf8cbf9c/meta/main.yml", "raw_url": "https://github.com/mikolak-net/ansible-raspi-config/raw/c6c140d3b402a3f91020e8095f8468e2cf8cbf9c/meta/main.yml", "status": "modified", "patch": "@@ -11,6 +11,13 @@ galaxy_info:\n   - development\n   - system\n dependencies:\n-  - { role: \"knopki.locale\", version: \"v1.0.3\", locale_all: \"{{raspi_config_locale}}\" }\n-  - { role: \"Stouts.timezone\", version: \"2.0.1\", timezone_timezone: \"{{raspi_config_timezone}}\" }\n-  - { role: \"Stouts.hostname\", version: \"1.0.3\", hostname_hostname: \"{{raspi_config_hostname}}\" }\n\\ No newline at end of file\n+  - name: \"knopki.locale\"\n+    src: \"git+https://github.com/knopki/ansible-locale.git\"\n+    version: \"a1232f836b5514c58da381d9479640e40d874906\" # includes fix for superfluous locale switch\n+  - role: \"Stouts.timezone\"\n+    version: \"2.0.1\"\n+    timezone_timezone: \"raspi_config_timezone\"\n+    locale_all: \"raspi_config_locale\"\n+  - role: \"Stouts.hostname\"\n+    version: \"1.0.3\"\n+    hostname_hostname: \"raspi_config_hostname\"\n\\ No newline at end of file", "release_starts_at": null, "release_ends_at": "3d62ad13598da398a7b54cd7b215e6ccaea2cb6a"}], "release_starts_at": "c6c140d3b402a3f91020e8095f8468e2cf8cbf9c"}, {"repo": "awailly/cis-ubuntu-ansible", "_Commit__release_start_at": "2cfa28fd756194b32e320ab9c0df1e455f27dc38", "author_id": "MDQ6VXNlcjE3NjQyMTA=", "author_name": "Paul Chaignon", "committer_id": "MDQ6VXNlcjk3MTc1NQ==", "committer_name": "Aur\u00e9lien Wailly", "committer_email": "aurelien.wailly@gmail.com", "message": "Fix password expiration policies (#107)\n\n* Fix password expiration configuration\r\n\r\nChange password expiration configuration only if insufficient\r\n\r\n* Fix missing parameters in config line", "sha": "b36675b91a1963ce0be0c221858d49c854572d2c", "url": "https://api.github.com/repos/awailly/cis-ubuntu-ansible/commits/b36675b91a1963ce0be0c221858d49c854572d2c", "parents": ["92d2f38d01d7b33610c667cfdc03e28ab2912edc"], "files": [{"sha": "9d788befede443a6f70b38815531a62715a67d1b", "filename": "tasks/section_10_level1.yml", "previous_filename": null, "additions": 34, "deletions": 2, "changes": 36, "blob_url": "https://github.com/awailly/cis-ubuntu-ansible/blob/b36675b91a1963ce0be0c221858d49c854572d2c/tasks/section_10_level1.yml", "raw_url": "https://github.com/awailly/cis-ubuntu-ansible/raw/b36675b91a1963ce0be0c221858d49c854572d2c/tasks/section_10_level1.yml", "status": "modified", "patch": "@@ -1,31 +1,63 @@\n ---\n \n+  - name: 10.1.1 Set Password Expiration Days (check) (Scored)\n+    command: grep -oP '(?<=^PASS_MAX_DAYS\\s)[0-9]+' /etc/login.defs\n+    register: pass_max_days\n+    changed_when: False\n+    always_run: True\n+    tags:\n+      - section10\n+      - section10.1\n+      - section10.1.1\n+\n   - name: 10.1.1 Set Password Expiration Days (Scored)\n     lineinfile: >\n         dest='/etc/login.defs'\n         line='PASS_MAX_DAYS 90'\n-        state=present\n         regexp='^PASS_MAX_DAYS'\n+    when: pass_max_days.stdout_lines > 90\n     tags:\n       - section10\n       - section10.1\n       - section10.1.1\n \n+  - name: 10.1.2 Set Password Change Minimum Number of Days (check) (Scored)\n+    command: grep -oP '(?<=^PASS_MIN_DAYS\\s)[0-9]+' /etc/login.defs\n+    register: pass_min_days\n+    changed_when: False\n+    always_run: True\n+    tags:\n+      - section10\n+      - section10.1\n+      - section10.1.2\n+\n   - name: 10.1.2 Set Password Change Minimum Number of Days (Scored)\n     lineinfile: >\n         dest='/etc/login.defs'\n         line='PASS_MIN_DAYS 7'\n         regexp='^PASS_MIN_DAYS'\n+    when: pass_min_days.stdout_lines < 7\n     tags:\n       - section10\n       - section10.1\n       - section10.1.2\n \n+  - name: 10.1.3 Set Password Expiring Warning Days (check) (Scored)\n+    command: grep -oP '(?<=^PASS_WARN_AGE\\s)[0-9]+' /etc/login.defs\n+    register: pass_warn_age\n+    changed_when: False\n+    always_run: True\n+    tags:\n+      - section10\n+      - section10.1\n+      - section10.1.3\n+\n   - name: 10.1.3 Set Password Expiring Warning Days (Scored)\n     lineinfile: >\n         dest='/etc/login.defs'\n-        line='PASS_WARN_AGE'\n+        line='PASS_WARN_AGE 7'\n         regexp='^PASS_WARN_AGE'\n+    when: pass_warn_age.stdout_lines < 7\n     tags:\n       - section10\n       - section10.1", "release": "2cfa28fd756194b32e320ab9c0df1e455f27dc38"}]}, {"repo": "awailly/cis-ubuntu-ansible", "_Commit__release_start_at": "2cfa28fd756194b32e320ab9c0df1e455f27dc38", "author_id": "MDQ6VXNlcjk3MTc1NQ==", "author_name": "Aur\u00e9lien Wailly", "committer_id": "MDQ6VXNlcjk3MTc1NQ==", "committer_name": "Aur\u00e9lien Wailly", "committer_email": "aurelien.wailly@gmail.com", "message": "Fix #4\n\n- Added global variable to prevent dangerous behavior, but still set to\n  True.\n- Quickfix: Add \"false\" to the egrep match", "sha": "bc7af5efcd2c8565acee0dc5948c8b752f6c8990", "url": "https://api.github.com/repos/awailly/cis-ubuntu-ansible/commits/bc7af5efcd2c8565acee0dc5948c8b752f6c8990", "parents": ["903181fe699ba052fc8c94ccf16e531b40064f51"], "files": [{"sha": "7298a05b217bff1699236376ac9d7d5c85068a91", "filename": "tasks/section_13_level1.yml", "previous_filename": null, "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/awailly/cis-ubuntu-ansible/blob/bc7af5efcd2c8565acee0dc5948c8b752f6c8990/tasks/section_13_level1.yml", "raw_url": "https://github.com/awailly/cis-ubuntu-ansible/raw/bc7af5efcd2c8565acee0dc5948c8b752f6c8990/tasks/section_13_level1.yml", "status": "modified", "patch": "@@ -94,7 +94,7 @@\n       - section13.6\n \n   - name: 13.7.1 Check Permissions on User Home Directories (gather users) (Scored)\n-    shell: /bin/egrep -v '(root|halt|sync|shutdown)' /etc/passwd | /usr/bin/awk -F':' '($7 != \"/usr/sbin/nologin\") { print $6 }'\n+    shell: /bin/egrep -v '(root|halt|sync|shutdown|false)' /etc/passwd | /usr/bin/awk -F':' '($7 != \"/usr/sbin/nologin\") { print $6 }'\n     register: home_users\n     changed_when: False\n     failed_when: False\n@@ -109,6 +109,7 @@\n         state=directory\n     with_items:\n         home_users.stdout_lines\n+    when: modify_user_homes == True\n     tags:\n       - section13\n       - section13.7", "release": "2cfa28fd756194b32e320ab9c0df1e455f27dc38"}]}, {"repo": "nusenu/ansible-relayor", "_Commit__release_start_at": "1224adf2811c827a09ff0bf133fbb476901a547d", "author_id": null, "author_name": "nusenu", "committer_id": null, "committer_name": "nusenu", "committer_email": "nusenu@openmailbox.org", "message": "don't fail on CentOS with SELinux disabled (fixes #42)", "sha": "33341b8cd483ae2583a4bd7c1bd79c82e4a12e4b", "url": "https://api.github.com/repos/nusenu/ansible-relayor/commits/33341b8cd483ae2583a4bd7c1bd79c82e4a12e4b", "parents": ["8cf75eb68465f1126872131afd102e05068a9df2"], "files": [{"sha": "4c996ca850c8faf1b20f4a6b7afe7ddfbf32e62e", "filename": "tasks/yum_install.yml", "previous_filename": null, "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/nusenu/ansible-relayor/blob/33341b8cd483ae2583a4bd7c1bd79c82e4a12e4b/tasks/yum_install.yml", "raw_url": "https://github.com/nusenu/ansible-relayor/raw/33341b8cd483ae2583a4bd7c1bd79c82e4a12e4b/tasks/yum_install.yml", "status": "modified", "patch": "@@ -26,6 +26,7 @@\n - name: Ensure setsebool (SELinux) dependencies are installed (CentOS)\n   sudo: yes\n   yum: name=libsemanage-python state=present\n+  when: ansible_selinux.status == 'enabled'\n \n - name: Ensure the presence of the multi-instance systemd unit file (CentOS)\n   sudo: yes\n@@ -35,5 +36,6 @@\n - name: Ensure SELinux boolean (tor_can_network_relay) is set appropriately (CentOS)\n   sudo: yes\n   seboolean: name=tor_can_network_relay state=yes persistent=yes\n+  when: ansible_selinux.status == 'enabled'\n \n - meta: flush_handlers", "release": "1224adf2811c827a09ff0bf133fbb476901a547d"}]}, {"repo": "brianshumate/ansible-consul", "_Commit__release_starts_at": null, "_Commit__release_ends_at": "6f2fdbaf6a98476a156102c6215391a09c3e6a42", "author_id": "MDQ6VXNlcjEwNjcxNTU5", "author_name": "Bas Meijer", "committer_id": "MDQ6VXNlcjEwNjcxNTU5", "committer_name": "Bas Meijer", "committer_email": "bas.meijer@me.com", "message": "Fix for #325 for Consul > 1.4.0", "sha": "47eb83c431cc68262d286df231c98c0a927b1e8a", "url": "https://api.github.com/repos/brianshumate/ansible-consul/commits/47eb83c431cc68262d286df231c98c0a927b1e8a", "parents": ["ba9f7d378ad95ef9bb2be6c768dd83e81244b795"], "files": [{"sha": "f3cf636f5b2e0ccf1ab10e9cfea6ab9bb4f4dbd4", "filename": "tasks/acl.yml", "previous_filename": null, "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/brianshumate/ansible-consul/blob/47eb83c431cc68262d286df231c98c0a927b1e8a/tasks/acl.yml", "raw_url": "https://github.com/brianshumate/ansible-consul/raw/47eb83c431cc68262d286df231c98c0a927b1e8a/tasks/acl.yml", "status": "modified", "patch": "@@ -49,8 +49,8 @@\n     - name: Read ACL replication token from previously boostrapped server\n       shell: >\n         cat {{ consul_config_path }}/config.json |\n-        grep \"acl_replication_token\" |\n-        sed -E 's/\"acl_replication_token\": \"(.+)\",?/\\1/' |\n+        grep \"replication\" |\n+        sed -E 's/\"replication\": \"(.+)\",?/\\1/' |\n         sed 'is/^ *//;s/ *$//'\n       changed_when: false\n       check_mode: false", "release_starts_at": null, "release_ends_at": "6f2fdbaf6a98476a156102c6215391a09c3e6a42"}], "release_starts_at": "47eb83c431cc68262d286df231c98c0a927b1e8a"}, {"repo": "nusenu/ansible-relayor", "_Commit__release_start_at": "1224adf2811c827a09ff0bf133fbb476901a547d", "author_id": null, "author_name": "nusenu", "committer_id": null, "committer_name": "nusenu", "committer_email": "nusenu@openmailbox.org", "message": "BSD: drop support for log files, change default DataDir location to avoid permission conflicts with the packages (fixes #59)", "sha": "b5d6f33218259b7205796d55ad4b976d3b9f3305", "url": "https://api.github.com/repos/nusenu/ansible-relayor/commits/b5d6f33218259b7205796d55ad4b976d3b9f3305", "parents": ["fa66f2d6f5193cce5c2f9086e78f9bff39133e60"], "files": [{"sha": "167e44f8652d0288e4728fec053960f6b6cbf7fa", "filename": "tasks/configure.yml", "previous_filename": null, "additions": 0, "deletions": 27, "changes": 27, "blob_url": "https://github.com/nusenu/ansible-relayor/blob/b5d6f33218259b7205796d55ad4b976d3b9f3305/tasks/configure.yml", "raw_url": "https://github.com/nusenu/ansible-relayor/raw/b5d6f33218259b7205796d55ad4b976d3b9f3305/tasks/configure.yml", "status": "modified", "patch": "@@ -180,33 +180,6 @@\n     group={{ tor_user }}\n     mode=755\n \n-- name: Ensure LogDir exists\n-  become: yes\n-  file: path={{ tor_LogDir }}\n-    state=directory\n-    owner=root\n-    mode=755\n-  when: ansible_system != 'Linux'\n-\n-# we only use distinct logfiles on systems that have no SyslogIdentityTag support yet (all non-Debian plaforms)\n-# otherwise we log to syslog with SyslogIdentityTag to avoid the filesystem permissions troubles with logrotate.\n-# We aim to log to syslog+SyslogIdentityTag for all platforms eventually.\n-# This is a medium-term workaround until all platform get SyslogIdentityTag support\n-# without this workaround tor will fail to start after logrotate created new logfiles because\n-# logrotate is not not aware that every tor instance runs under a distinct user.\n-# This effectively disables logrotate.\n-- name: Ensure per-instance LogDir exists\n-  become: yes\n-  file: path={{ tor_LogDir }}/{{ item[0] }}_{{ item.1.orport }}\n-    state=directory\n-    owner=_tor-{{ item[0] }}_{{ item.1.orport }}\n-    group=_tor-{{ item[0] }}_{{ item.1.orport }}\n-    mode=700\n-  with_nested:\n-   - tor_ips\n-   - tor_ports\n-  when: ansible_system != 'Linux'\n-\n - name: Generating torrc file(s)\n   become: yes\n   template: >", "release": "1224adf2811c827a09ff0bf133fbb476901a547d"}, {"sha": "3f58f5380a772b43005b4700b11af8649c790b8a", "filename": "tasks/openbsd_install.yml", "previous_filename": null, "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/nusenu/ansible-relayor/blob/b5d6f33218259b7205796d55ad4b976d3b9f3305/tasks/openbsd_install.yml", "raw_url": "https://github.com/nusenu/ansible-relayor/raw/b5d6f33218259b7205796d55ad4b976d3b9f3305/tasks/openbsd_install.yml", "status": "modified", "patch": "@@ -2,7 +2,7 @@\n \n - name: Setup OpenBSD specific variables (set_fact)\n   set_fact:\n-    tor_DataDir: /var/tor\n+    tor_DataDir: /var/tor-instances\n     tor_ConfDir: /etc/tor/enabled\n   tags:\n    - reconfigure", "release": "1224adf2811c827a09ff0bf133fbb476901a547d"}, {"sha": "857baff789042ceb93356c9ccbeff3052c5f6d46", "filename": "tasks/freebsd_install.yml", "previous_filename": null, "additions": 1, "deletions": 6, "changes": 7, "blob_url": "https://github.com/nusenu/ansible-relayor/blob/b5d6f33218259b7205796d55ad4b976d3b9f3305/tasks/freebsd_install.yml", "raw_url": "https://github.com/nusenu/ansible-relayor/raw/b5d6f33218259b7205796d55ad4b976d3b9f3305/tasks/freebsd_install.yml", "status": "modified", "patch": "@@ -2,7 +2,7 @@\n \n - name: Setup FreeBSD specific variables (set_fact)\n   set_fact:\n-    tor_DataDir: /var/db/tor\n+    tor_DataDir: /var/db/tor-instances\n     tor_ConfDir: /usr/local/etc/tor/enabled\n   tags:\n    - reconfigure\n@@ -21,11 +21,6 @@\n    - tor_ips\n    - tor_ports\n \n-- name: If LogDir is a file, rename it (FreeBSD)\n-  become: yes\n-  shell: \"test -f {{ tor_LogDir }} && mv {{ tor_LogDir }} {{ tor_LogDir }}.bk-`date '+%Y-%m-%d_%H%M%S'`\"\n-  ignore_errors: yes\n-\n - name: Ensure sequential IP IDs are avoided (net.inet.ip.random_id)\n   become: yes\n   sysctl: name=net.inet.ip.random_id value=1 reload=no sysctl_set=yes", "release": "1224adf2811c827a09ff0bf133fbb476901a547d"}]}, {"repo": "dev-sec/ansible-mysql-hardening", "_Commit__release_starts_at": null, "_Commit__release_ends_at": "98e30c4cab55a2719db71947e68249f80b5c9322", "author_id": "MDQ6VXNlcjEwMjQzODYx", "author_name": "Anton Lugovoi", "committer_id": "MDQ6VXNlcjE5ODY0NDQ3", "committer_name": "GitHub", "committer_email": "noreply@github.com", "message": "Merge pull request #21 from rndmh3ro/add_follow\n\nadd follow=yes to my.cnf protect task, incase its a symlink. fixes #20", "sha": "b6a9c11e2a3d4b51f7a7867dff92ea6fab312226", "url": "https://api.github.com/repos/dev-sec/ansible-mysql-hardening/commits/b6a9c11e2a3d4b51f7a7867dff92ea6fab312226", "parents": ["1510f92858b85f9f623690db747bdfff9b5b0515", "74a3b03fd984278f2f819b1070e5906824f3a401"], "files": [{"sha": "699fbee641b3158f42d19feb6296efd824fa53e9", "filename": "tasks/configure.yml", "previous_filename": null, "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/dev-sec/ansible-mysql-hardening/blob/b6a9c11e2a3d4b51f7a7867dff92ea6fab312226/tasks/configure.yml", "raw_url": "https://github.com/dev-sec/ansible-mysql-hardening/raw/b6a9c11e2a3d4b51f7a7867dff92ea6fab312226/tasks/configure.yml", "status": "modified", "patch": "@@ -1,7 +1,7 @@\n ---\n \n - name: protect my.cnf\n-  file: path='{{mysql_hardening_mysql_conf}}' mode=0600 owner=root group=root\n+  file: path='{{mysql_hardening_mysql_conf}}' mode=0600 owner=root group=root follow=yes\n \n - name: ensure permissions on mysql-datadir are correct\n   file: path='{{mysql_datadir}}' state=directory owner='{{mysql_hardening_user}}' group='{{mysql_hardening_user}}'", "release_starts_at": null, "release_ends_at": "98e30c4cab55a2719db71947e68249f80b5c9322"}], "release_starts_at": "b6a9c11e2a3d4b51f7a7867dff92ea6fab312226"}, {"repo": "StackStorm/ansible-st2", "_Commit__release_starts_at": null, "_Commit__release_ends_at": "2d0f3f1cf5d5919432c94bb3659c16b85d1cb1db", "author_id": "MDQ6VXNlcjE3ODg4NjI=", "author_name": "Johan Dahlberg", "committer_id": "MDQ6VXNlcjE1MzM4MTg=", "committer_name": "Eugen C", "committer_email": "armab@users.noreply.github.com", "message": "Use new bundled packages (#42)\n\nUse new bundled packages\r\n\r\nCloses #43, fixes #40, fixes #39, fixes #38, closes #36, closes #14, resolves #4", "sha": "36f63dc3647721266cdb0d09e6836ce99546505e", "url": "https://api.github.com/repos/StackStorm/ansible-st2/commits/36f63dc3647721266cdb0d09e6836ce99546505e", "parents": ["e42f58bc7e876fea3462e363d8ab780889ef000c"], "files": [{"sha": "c5fef60a5b48464f05c35087d716a55105a4e986", "filename": "roles/st2/defaults/main.yml", "previous_filename": null, "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/StackStorm/ansible-st2/blob/36f63dc3647721266cdb0d09e6836ce99546505e/roles/st2/defaults/main.yml", "raw_url": "https://github.com/StackStorm/ansible-st2/raw/36f63dc3647721266cdb0d09e6836ce99546505e/roles/st2/defaults/main.yml", "status": "modified", "patch": "@@ -24,10 +24,10 @@ st2_packages:\n # Number of action runners to register. Defaults to number of vCPUs, but not less than 2\n st2_action_runners: \"{{ [ansible_processor_vcpus, 2] | max }}\"\n \n+enable_auth: true\n st2_auth_username: testu\n st2_auth_password: testp\n \n # Set to no if you do not want the st2_system_user to be added in\n # the sudoers file.\n st2_system_user_in_sudoers: yes\n-", "release_starts_at": null, "release_ends_at": "2d0f3f1cf5d5919432c94bb3659c16b85d1cb1db"}, {"sha": "0b48f13b64f1bc7f2814ed7506bebd6661f65f4a", "filename": "roles/st2/tasks/config_auth.yml", "previous_filename": null, "additions": 20, "deletions": 29, "changes": 49, "blob_url": "https://github.com/StackStorm/ansible-st2/blob/36f63dc3647721266cdb0d09e6836ce99546505e/roles/st2/tasks/config_auth.yml", "raw_url": "https://github.com/StackStorm/ansible-st2/raw/36f63dc3647721266cdb0d09e6836ce99546505e/roles/st2/tasks/config_auth.yml", "status": "modified", "patch": "@@ -1,37 +1,28 @@\n-- name: Config proxy auth\n-  sudo: true\n-  lineinfile:\n-    dest: /etc/st2/st2.conf\n-    regexp: \"^{{ item.option }}\\\\s*=\"\n-    value: \"{{ item.option }} = {{ item.value }}\"\n+- name: Install auth pre-reqs\n+  sudo: yes\n+  apt:\n+    name: \"{{ item }}\"\n+    state: present\n   with_items:\n-    - option: mode\n-      value: proxy\n-  when: \"st2_auth_username is undefined\"\n-  notify:\n-    - restart st2\n-\n-- name: Config stanalone auth\n-  sudo: true\n-  lineinfile:\n-    dest: /etc/st2/st2.conf\n-    regexp: \"^{{ item.option }}\\\\s*=\"\n-    value: \"{{ item.option }} = {{ item.value }}\"\n-  with_items:\n-    - option: mode\n-      value: standalone\n-    - option: backend\n-      value: flat_file\n-    - option: backend_kwargs\n-      value: \"{\\\"file_path\\\": \\\"/etc/st2/htpasswd\\\"}\"\n-  when: \"st2_auth_username is defined\"\n-  notify:\n-    - restart st2\n+    - python-passlib\n+    - apache2-utils\n \n - name: Create htpasswd file\n   sudo: true\n   htpasswd:\n     path: /etc/st2/htpasswd\n     name: \"{{ st2_auth_username }}\"\n     password: \"{{ st2_auth_password }}\"\n-  when: \"st2_auth_username is defined\"\n+  notify:\n+    - restart st2api/st2stream\n+\n+- name: Enable autentication\n+  sudo: yes\n+  ini_file:\n+    dest: /etc/st2/st2.conf\n+    section: auth\n+    option: enable\n+    value: True\n+    backup: yes\n+  notify: \n+    - restart st2api/st2stream", "release_starts_at": null, "release_ends_at": "2d0f3f1cf5d5919432c94bb3659c16b85d1cb1db"}, {"sha": "de6811b879196d3c36afdbb0aa91ca47532cad5a", "filename": "roles/mongodb/tasks/main.yml", "previous_filename": null, "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/StackStorm/ansible-st2/blob/36f63dc3647721266cdb0d09e6836ce99546505e/roles/mongodb/tasks/main.yml", "raw_url": "https://github.com/StackStorm/ansible-st2/raw/36f63dc3647721266cdb0d09e6836ce99546505e/roles/mongodb/tasks/main.yml", "status": "modified", "patch": "@@ -5,5 +5,4 @@\n     update_cache: yes\n     state: present\n   with_items:\n-    - mongodb\n     - mongodb-server", "release_starts_at": null, "release_ends_at": "2d0f3f1cf5d5919432c94bb3659c16b85d1cb1db"}, {"sha": "4f11af646525b65bc8003de828773f9631dd63d5", "filename": "roles/st2/meta/main.yml", "previous_filename": null, "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/StackStorm/ansible-st2/blob/36f63dc3647721266cdb0d09e6836ce99546505e/roles/st2/meta/main.yml", "raw_url": "https://github.com/StackStorm/ansible-st2/raw/36f63dc3647721266cdb0d09e6836ce99546505e/roles/st2/meta/main.yml", "status": "modified", "patch": "@@ -12,4 +12,5 @@ galaxy_info:\n         - precise\n   categories:\n     - system\n-dependencies: []\n+dependencies: \n+  - role: st2repos", "release_starts_at": null, "release_ends_at": "2d0f3f1cf5d5919432c94bb3659c16b85d1cb1db"}, {"sha": "5c23fd14fc585d950a5e3162cc75491dbfdf763a", "filename": "roles/st2/tasks/user.yml", "previous_filename": "roles/st2/tasks/3.user.yml", "additions": 19, "deletions": 0, "changes": 19, "blob_url": "https://github.com/StackStorm/ansible-st2/blob/36f63dc3647721266cdb0d09e6836ce99546505e/roles/st2/tasks/user.yml", "raw_url": "https://github.com/StackStorm/ansible-st2/raw/36f63dc3647721266cdb0d09e6836ce99546505e/roles/st2/tasks/user.yml", "status": "renamed", "patch": "@@ -32,3 +32,22 @@\n     state: \"{{ 'present' if st2_system_user_in_sudoers else 'absent' }}\"\n     validate: 'visudo -cf %s'\n   tags: [st2, user]\n+\n+\n+- name: Configure system user in /etc/st2/st2.conf\n+  sudo: yes\n+  ini_file:\n+    dest: /etc/st2/st2.conf\n+    section: system_user\n+    option: user\n+    value: \"{{ st2_system_user }}\"\n+    backup: yes\n+\n+- name: Configure system user ssh key in /etc/st2/st2.conf\n+  sudo: yes\n+  ini_file:\n+    dest: /etc/st2/st2.conf\n+    section: system_user\n+    option: ssh_key_file\n+    value: \"{{ _user.ssh_key_file }}\"\n+    backup: yes", "release_starts_at": null, "release_ends_at": "2d0f3f1cf5d5919432c94bb3659c16b85d1cb1db"}, {"sha": "b09cdd079871213ec3d977f92b7538f2142418b3", "filename": "roles/mistral/defaults/main.yml", "previous_filename": null, "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/StackStorm/ansible-st2/blob/36f63dc3647721266cdb0d09e6836ce99546505e/roles/mistral/defaults/main.yml", "raw_url": "https://github.com/StackStorm/ansible-st2/raw/36f63dc3647721266cdb0d09e6836ce99546505e/roles/mistral/defaults/main.yml", "status": "modified", "patch": "@@ -1,4 +1,4 @@\n-mistral_version: 0.13\n+mistral_version: stable\n mistral_db_username: mistral\n mistral_db_password: StackStorm\n mistral_db: mistral", "release_starts_at": null, "release_ends_at": "2d0f3f1cf5d5919432c94bb3659c16b85d1cb1db"}, {"sha": "0c4007d181b6ca8241749b787b0957c387e91285", "filename": "roles/rabbitmq/tasks/main.yml", "previous_filename": null, "additions": 0, "deletions": 25, "changes": 25, "blob_url": "https://github.com/StackStorm/ansible-st2/blob/36f63dc3647721266cdb0d09e6836ce99546505e/roles/rabbitmq/tasks/main.yml", "raw_url": "https://github.com/StackStorm/ansible-st2/raw/36f63dc3647721266cdb0d09e6836ce99546505e/roles/rabbitmq/tasks/main.yml", "status": "modified", "patch": "@@ -1,12 +1,3 @@\n-- name: Ensure rabbitmq repo\n-  sudo: true\n-  apt_repository:\n-    repo: deb http://www.rabbitmq.com/debian/ testing main\n-\n-- name: Ensure rabbitmq repo key\n-  sudo: true\n-  apt_key:\n-    url: http://www.rabbitmq.com/rabbitmq-signing-key-public.asc\n \n - name: Install rabbitmq packages\n   sudo: true\n@@ -15,19 +6,3 @@\n     update_cache: true\n   with_items:\n     - rabbitmq-server\n-\n-- name: Enable rabbitmq_management plugin\n-  sudo: true\n-  rabbitmq_plugin:\n-    names: rabbitmq_management\n-  notify:\n-    - restart rabbitmq\n-\n-- meta: flush_handlers\n-\n-- name: Install rabbitmqadmin\n-  sudo: true\n-  get_url:\n-    url: http://127.0.0.1:15672/cli/rabbitmqadmin\n-    dest: /usr/bin/rabbitmqadmin\n-    mode: 0755", "release_starts_at": null, "release_ends_at": "2d0f3f1cf5d5919432c94bb3659c16b85d1cb1db"}, {"sha": "026249289dea029405ce63c3126fc5bee174ad3b", "filename": "roles/mistral/tasks/main.yml", "previous_filename": null, "additions": 75, "deletions": 7, "changes": 82, "blob_url": "https://github.com/StackStorm/ansible-st2/blob/36f63dc3647721266cdb0d09e6836ce99546505e/roles/mistral/tasks/main.yml", "raw_url": "https://github.com/StackStorm/ansible-st2/raw/36f63dc3647721266cdb0d09e6836ce99546505e/roles/mistral/tasks/main.yml", "status": "modified", "patch": "@@ -1,7 +1,75 @@\n-- include: gather_facts.yml\n-- include: install_deps.yml\n-- include: install_mistral.yml\n-- include: install_actions.yml\n-- include: config.yml\n-- include: sync.yml\n-- include: install_client.yml\n+---\n+\n+- name: Install latest st2mistral\n+  sudo: yes\n+  apt: \n+    name: st2mistral\n+    state: latest\n+  when: mistral_version == \"stable\"\n+\n+- name: Install latest st2mistral\n+  sudo: yes\n+  apt:\n+    name: st2mistral={{ mistral_version }}\n+    state: present\n+  when: mistral_version != \"stable\"\n+\n+- name: Configure mistral\n+  sudo: yes\n+  ini_file:\n+    dest: /etc/mistral/mistral.conf\n+    section: database\n+    option: connection\n+    value: postgresql://{{ mistral_db_username }}:{{ mistral_db_password }}@localhost/{{ mistral_db }}\n+    backup: yes\n+\n+- name: Deploy database init script\n+  sudo: yes\n+  template:\n+    src: init_mistral_db.SQL.j2\n+    dest: /etc/mistral/init_mistral_db.SQL \n+  notify: \n+    - restart mistral\n+\n+- name: Initiate database\n+  become: yes\n+  become_user: postgres\n+  shell: psql < /etc/mistral/init_mistral_db.SQL\n+  args: \n+    creates: /etc/mistral/init_mistral_db.SQL.ansible.has.run\n+  notify:\n+    - restart mistral\n+\n+- name: Make sure \"Initiate database\" doesn't run twice\n+  sudo: yes\n+  file:\n+    path: /etc/mistral/init_mistral_db.SQL.ansible.has.run\n+    state: touch\n+\n+- name: Setup Mistral DB tables, etc\n+  sudo: yes\n+  command: /opt/stackstorm/mistral/bin/mistral-db-manage --config-file /etc/mistral/mistral.conf upgrade head\n+  args:\n+    creates: /etc/mistral/mistral-db-manage.upgrade.head.ansible.has.run\n+  notify: \n+    - restart mistral\n+\n+- name: Make sure \"Setup Mistral DB tables, etc\" does not run again\n+  sudo: yes\n+  file:\n+    path: /etc/mistral/mistral-db-manage.upgrade.head.ansible.has.run\n+    state: touch\n+\n+- name: Register mistral actions\n+  sudo: yes\n+  command: /opt/stackstorm/mistral/bin/mistral-db-manage --config-file /etc/mistral/mistral.conf populate\n+  args:\n+    creates: /etc/mistral/mistral-db-manage.populate.ansible.has.run\n+  notify:\n+    - restart mistral\n+\n+- name: Make sure \"Register mistral actions\" does not run again\n+  sudo: yes\n+  file:\n+    path: /etc/mistral/mistral-db-manage.upgrade.head.ansible.has.run\n+    state: touch", "release_starts_at": null, "release_ends_at": "2d0f3f1cf5d5919432c94bb3659c16b85d1cb1db"}, {"sha": "ac43644b4ddd0e7a3aa4f1cf9f0bb7dce0ae8094", "filename": "roles/st2/handlers/main.yml", "previous_filename": null, "additions": 11, "deletions": 4, "changes": 15, "blob_url": "https://github.com/StackStorm/ansible-st2/blob/36f63dc3647721266cdb0d09e6836ce99546505e/roles/st2/handlers/main.yml", "raw_url": "https://github.com/StackStorm/ansible-st2/raw/36f63dc3647721266cdb0d09e6836ce99546505e/roles/st2/handlers/main.yml", "status": "modified", "patch": "@@ -1,6 +1,13 @@\n - name: restart st2\n   sudo: true\n-  service:\n-    name: \"{{ item }}\"\n-    state: restarted\n-  with_items: st2_services\n+  command: \"{{ item }}\"\n+  with_items:\n+    - st2ctl reload --register-all\n+    - st2ctl restart\n+\n+- name: restart st2api/st2stream\n+  sudo: true\n+  command: \"st2ctl restart-component {{ item }}\"\n+  with_items:\n+    - st2api\n+    - st2stream", "release_starts_at": null, "release_ends_at": "2d0f3f1cf5d5919432c94bb3659c16b85d1cb1db"}, {"sha": "a07d5797f2ffbc8a6e9c12b58de2fdbd52912903", "filename": "roles/st2/tasks/main.yml", "previous_filename": null, "additions": 23, "deletions": 10, "changes": 33, "blob_url": "https://github.com/StackStorm/ansible-st2/blob/36f63dc3647721266cdb0d09e6836ce99546505e/roles/st2/tasks/main.yml", "raw_url": "https://github.com/StackStorm/ansible-st2/raw/36f63dc3647721266cdb0d09e6836ce99546505e/roles/st2/tasks/main.yml", "status": "modified", "patch": "@@ -1,11 +1,24 @@\n-- include: 1.requirements.yml\n-- include: 2.version.yml\n-- include: 3.user.yml\n-- include: 4.dependencies.yml\n-- include: 5.packages.yml\n-- include: 6.upstart.yml\n+---\n+\n+- name: Install latest st2 package\n+  sudo: yes\n+  apt:\n+    name: st2\n+    state: latest\n+  when: st2_version == \"stable\"\n+  notify:\n+    - restart st2\n+\n+- name: Install latest st2 package\n+  sudo: yes\n+  apt:\n+    name: st2={{ st2_version }}.{{ st2_revision }}\n+    state: present\n+  when: st2_version != \"stable\"\n+  notify:\n+    - restart st2\n+\n+- include: user.yml\n+\n - include: config_auth.yml\n-  when: \"'st2auth' in st2_packages\"\n-- name: Register content\n-  shell: \"python /usr/lib/python2.7/dist-packages/st2common/bin/st2-register-content\n-          --config-file /etc/st2/st2.conf --register-all 2>&1\"\n+  when: enable_auth", "release_starts_at": null, "release_ends_at": "2d0f3f1cf5d5919432c94bb3659c16b85d1cb1db"}, {"sha": "672364ac9d672ab9450a7eb8ce05b8aa434c45f9", "filename": "roles/mistral/meta/main.yml", "previous_filename": null, "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/StackStorm/ansible-st2/blob/36f63dc3647721266cdb0d09e6836ce99546505e/roles/mistral/meta/main.yml", "raw_url": "https://github.com/StackStorm/ansible-st2/raw/36f63dc3647721266cdb0d09e6836ce99546505e/roles/mistral/meta/main.yml", "status": "modified", "patch": "@@ -23,3 +23,4 @@ dependencies:\n       - name: \"{{ mistral_db_username }}\"\n         pass: \"{{ mistral_db_password }}\"\n         encrypted: yes\n+  - role: st2repos", "release_starts_at": null, "release_ends_at": "2d0f3f1cf5d5919432c94bb3659c16b85d1cb1db"}], "release_starts_at": "36f63dc3647721266cdb0d09e6836ce99546505e"}, {"repo": "UnderGreen/ansible-role-mongodb", "_Commit__release_start_at": "42487b9f4681a078ef82c07c3307a51653a19791", "author_id": "MDQ6VXNlcjI2NTY3Mzc=", "author_name": "Sergei Antipov", "committer_id": "MDQ6VXNlcjI2NTY3Mzc=", "committer_name": "Sergei Antipov", "committer_email": "s.antipov@2gis.ru", "message": "Fixed issue #3", "sha": "d25113e8fab871b2ead95ca976c5a43e4759ea26", "url": "https://api.github.com/repos/UnderGreen/ansible-role-mongodb/commits/d25113e8fab871b2ead95ca976c5a43e4759ea26", "parents": ["ec4de12ae75f7191a5f71aa775e0344679ea1477"], "files": [{"sha": "a78702622a74ad0fde534669f16be4af249741ff", "filename": "tasks/auth_initialization.yml", "previous_filename": null, "additions": 11, "deletions": 11, "changes": 22, "blob_url": "https://github.com/UnderGreen/ansible-role-mongodb/blob/d25113e8fab871b2ead95ca976c5a43e4759ea26/tasks/auth_initialization.yml", "raw_url": "https://github.com/UnderGreen/ansible-role-mongodb/raw/d25113e8fab871b2ead95ca976c5a43e4759ea26/tasks/auth_initialization.yml", "status": "modified", "patch": "@@ -3,7 +3,7 @@\n - include: auth_initialization_ald.yml\n   when: ansible_local.mongodb.mongodb.mongodb_login_port is defined\n \n-- name: create administrative user siteRootAdmin\n+- name: create administrative user siteUserAdmin\n   mongodb_user:\n     database: admin\n     name: \"{{ item.name }}\"\n@@ -12,14 +12,14 @@\n     login_host: 127.0.0.1\n   with_items:\n     - {\n-      name: \"{{ mongodb_root_admin_name }}\",\n-      password: \"{{ mongodb_root_admin_password }}\",\n-      roles: \"root\"\n+      name: \"{{ mongodb_user_admin_name }}\",\n+      password: \"{{ mongodb_user_admin_password }}\",\n+      roles: \"userAdminAnyDatabase\"\n       }\n-  register: rootadmin_user_result\n+  register: useradmin_user_result\n   when: ansible_local.mongodb.mongodb.mongodb_login_port is undefined\n \n-- name: create administrative user siteUserAdmin\n+- name: create administrative user siteRootAdmin\n   mongodb_user:\n     database: admin\n     name: \"{{ item.name }}\"\n@@ -28,11 +28,11 @@\n     login_host: 127.0.0.1\n   with_items:\n     - {\n-      name: \"{{ mongodb_user_admin_name }}\",\n-      password: \"{{ mongodb_user_admin_password }}\",\n-      roles: \"userAdminAnyDatabase\"\n+      name: \"{{ mongodb_root_admin_name }}\",\n+      password: \"{{ mongodb_root_admin_password }}\",\n+      roles: \"root\"\n       }\n-  register: useradmin_user_result\n+  register: rootadmin_user_result\n   when: ansible_local.mongodb.mongodb.mongodb_login_port is undefined\n \n - name: create normal users\n@@ -59,5 +59,5 @@\n - name: Create facts file for mongodb\n   copy:\n     dest: /etc/ansible/facts.d/mongodb.fact\n-    content: \"[mongodb]\\nmongodb_login_port={{ mongodb_conf_port }}\\n\"\n+    content: \"[mongodb]\\nmongodb_login_port={{ mongodb_conf_port }}\\n\\n\"\n   when: rootadmin_user_result|changed or useradmin_user_result|changed", "release": "42487b9f4681a078ef82c07c3307a51653a19791"}, {"sha": "5fd7ead47a88000ab4e1f1e771b62abca1cbb4ae", "filename": "tasks/auth_initialization_ald.yml", "previous_filename": null, "additions": 10, "deletions": 8, "changes": 18, "blob_url": "https://github.com/UnderGreen/ansible-role-mongodb/blob/d25113e8fab871b2ead95ca976c5a43e4759ea26/tasks/auth_initialization_ald.yml", "raw_url": "https://github.com/UnderGreen/ansible-role-mongodb/raw/d25113e8fab871b2ead95ca976c5a43e4759ea26/tasks/auth_initialization_ald.yml", "status": "modified", "patch": "@@ -1,4 +1,4 @@\n-- name: create administrative user siteRootAdmin port=yes\n+- name: create administrative user siteUserAdmin port=yes\n   mongodb_user:\n     database: admin\n     name: \"{{ item.name }}\"\n@@ -8,24 +8,26 @@\n     login_port: \"{{ ansible_local.mongodb.mongodb.mongodb_login_port }}\"\n   with_items:\n     - {\n-      name: \"{{ mongodb_root_admin_name }}\",\n-      password: \"{{ mongodb_root_admin_password }}\",\n-      roles: \"root\"\n+      name: \"{{ mongodb_user_admin_name }}\",\n+      password: \"{{ mongodb_user_admin_password }}\",\n+      roles: \"userAdminAnyDatabase\"\n       }\n \n-- name: create administrative user siteUserAdmin port=yes\n+- name: create administrative user siteRootAdmin port=yes\n   mongodb_user:\n     database: admin\n     name: \"{{ item.name }}\"\n     password: \"{{ item.password }}\"\n     roles: \"{{ item.roles }}\"\n     login_host: 127.0.0.1\n     login_port: \"{{ ansible_local.mongodb.mongodb.mongodb_login_port }}\"\n+    login_user: \"{{ mongodb_user_admin_name }}\"\n+    login_password: \"{{ mongodb_user_admin_password }}\"\n   with_items:\n     - {\n-      name: \"{{ mongodb_user_admin_name }}\",\n-      password: \"{{ mongodb_user_admin_password }}\",\n-      roles: \"userAdminAnyDatabase\"\n+      name: \"{{ mongodb_root_admin_name }}\",\n+      password: \"{{ mongodb_root_admin_password }}\",\n+      roles: \"root\"\n       }\n \n - name: create normal users", "release": "42487b9f4681a078ef82c07c3307a51653a19791"}]}, {"repo": "awailly/cis-ubuntu-ansible", "_Commit__release_start_at": "2cfa28fd756194b32e320ab9c0df1e455f27dc38", "author_id": null, "author_name": "spoonboy", "committer_id": null, "committer_name": "spoonboy", "committer_email": "sabri.eddir@orange.com", "message": "Fix #22\n\ncheck CONFIG_DEFAULT_SECURITY_APPARMOR and change kernel mode accordingly", "sha": "78cd45d689806d77b405ff1f57b1472d5dae5b66", "url": "https://api.github.com/repos/awailly/cis-ubuntu-ansible/commits/78cd45d689806d77b405ff1f57b1472d5dae5b66", "parents": ["d6b9aef3a890db0fa37a2812da7b3aa1b418c15f"], "files": [{"sha": "16d8d8f090af089022b348b89c945be28b65a882", "filename": "tasks/section_04_level2.yml", "previous_filename": null, "additions": 11, "deletions": 3, "changes": 14, "blob_url": "https://github.com/awailly/cis-ubuntu-ansible/blob/78cd45d689806d77b405ff1f57b1472d5dae5b66/tasks/section_04_level2.yml", "raw_url": "https://github.com/awailly/cis-ubuntu-ansible/raw/78cd45d689806d77b405ff1f57b1472d5dae5b66/tasks/section_04_level2.yml", "status": "modified", "patch": "@@ -8,6 +8,14 @@\n     stat: path=/extlinux.conf\n     register: extlinux_cfg_file\n \n+  - name: Determines if apparmor is already set in boot config\n+    lineinfile: >\n+        dest='/boot/config-{{ ansible_kernel }}'\n+        regexp='CONFIG_DEFAULT_SECURITY_APPARMOR'\n+        line=\"CONFIG_DEFAULT_SECURITY_APPARMOR=y\"\n+        state=present\n+    register: boot_cfg_apparmor\n+\n   - name: 4.5 Activate AppArmor (install) (Scored)\n     apt: >\n         name=apparmor\n@@ -33,11 +41,11 @@\n         dest='/extlinux.conf'\n         regexp=\"^append initrd=\"\n         line=\"append initrd={{ ansible_cmdline['initrd'] }} root={{ ansible_cmdline['root'] }} console=tty0 console={{ ansible_cmdline['console'] }} apparmor=1 security=apparmor ro quiet\"\n-    when: use_apparmor == True and extlinux_cfg_file.stat.exists\n+    when: (use_apparmor == True and extlinux_cfg_file.stat.exists) and boot_cfg_apparmor.changed != \"False\"\n     tags:\n       - section4\n       - section4.5\n-  \n+\n   - name: 4.5 Activate AppArmor (start) (Scored)\n     service: >\n         name=apparmor\n@@ -51,7 +59,7 @@\n \n   - name: Determine if Apparmor started without error\n     fail: msg=\"Apparmor can not be started. This is normal behavior if you run the playbook for the first time. Please run it again to proceed with the rest of the playbook.\"\n-    when: apparmor_status.state != \"started\"\n+    when: apparmor_status.failed is defined\n \n   - name: 4.5 Activate AppArmor (fix profiles) (Scored)\n     service: >", "release": "2cfa28fd756194b32e320ab9c0df1e455f27dc38"}]}, {"repo": "nusenu/ansible-relayor", "_Commit__release_start_at": "1224adf2811c827a09ff0bf133fbb476901a547d", "author_id": null, "author_name": "nusenu", "committer_id": null, "committer_name": "nusenu", "committer_email": "nusenu@openmailbox.org", "message": "bugfix: make conditional service reload after torrc change a handler (fixes #83)", "sha": "c25e1f96cb3a91dfef803f4de935c51c597bd19d", "url": "https://api.github.com/repos/nusenu/ansible-relayor/commits/c25e1f96cb3a91dfef803f4de935c51c597bd19d", "parents": ["dc73f16743fa376672b427980c6ca044dd6fa68a"], "files": [{"sha": "40c2a0aab1694994d5a45958f0086449cf1d43e4", "filename": "tasks/linux_service.yml", "previous_filename": null, "additions": 0, "deletions": 10, "changes": 10, "blob_url": "https://github.com/nusenu/ansible-relayor/blob/c25e1f96cb3a91dfef803f4de935c51c597bd19d/tasks/linux_service.yml", "raw_url": "https://github.com/nusenu/ansible-relayor/raw/c25e1f96cb3a91dfef803f4de935c51c597bd19d/tasks/linux_service.yml", "status": "modified", "patch": "@@ -3,16 +3,6 @@\n # Linux/systemd section (uses service module)\n # ===========================================\n \n-- name: Ensure Tor instances are reloaded if its torrc changed (Linux/systemd)\n-  become: yes\n-  service:\n-    name: \"tor@{{ item.item.0.ipv4 }}_{{ item.item.1.orport }}.service\"\n-    state: reloaded\n-  with_items: \"{{ instances.results }}\"\n-  when: item.changed == True\n-  tags:\n-   - reconfigure\n-\n - name: Ensure Tor instances are enabled and started (Linux/systemd)\n   become: yes\n   service:", "release": "1224adf2811c827a09ff0bf133fbb476901a547d"}, {"sha": "5e3caef9204c63c07f638687fa38ac81774205e4", "filename": "handlers/main.yml", "previous_filename": null, "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/nusenu/ansible-relayor/blob/c25e1f96cb3a91dfef803f4de935c51c597bd19d/handlers/main.yml", "raw_url": "https://github.com/nusenu/ansible-relayor/raw/c25e1f96cb3a91dfef803f4de935c51c597bd19d/handlers/main.yml", "status": "modified", "patch": "@@ -31,3 +31,11 @@\n     name: tor\n     state: reloaded\n   when: ansible_system == 'FreeBSD'\n+\n+- name: Ensure Tor instances are reloaded if its torrc changed (Linux)\n+  become: yes\n+  service:\n+    name: \"tor@{{ item.item.0.ipv4 }}_{{ item.item.1.orport }}.service\"\n+    state: reloaded\n+  with_items: \"{{ instances.results }}\"\n+  when: item.changed == True and ansible_system == 'Linux'", "release": "1224adf2811c827a09ff0bf133fbb476901a547d"}, {"sha": "653500718877a2fa7023080e141f21c83078bb45", "filename": "tasks/configure.yml", "previous_filename": null, "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/nusenu/ansible-relayor/blob/c25e1f96cb3a91dfef803f4de935c51c597bd19d/tasks/configure.yml", "raw_url": "https://github.com/nusenu/ansible-relayor/raw/c25e1f96cb3a91dfef803f4de935c51c597bd19d/tasks/configure.yml", "status": "modified", "patch": "@@ -214,5 +214,6 @@\n   register: instances\n   notify:\n     - Ensure Tor instances are reloaded if its torrc changed (FreeBSD)\n+    - Ensure Tor instances are reloaded if its torrc changed (Linux)\n   tags:\n    - reconfigure", "release": "1224adf2811c827a09ff0bf133fbb476901a547d"}]}, {"repo": "StackStorm/ansible-st2", "_Commit__release_starts_at": null, "_Commit__release_ends_at": "2d0f3f1cf5d5919432c94bb3659c16b85d1cb1db", "author_id": "MDQ6VXNlcjE1MzM4MTg=", "author_name": "armab", "committer_id": "MDQ6VXNlcjE1MzM4MTg=", "committer_name": "armab", "committer_email": "armab@users.noreply.github.com", "message": "Merge pull request #23 from armab/18-mysql-to-postgresql\n\nMove from MySQL to PostgreSQL for Mistral\r\ncloses #18, closes #8, fixes #25", "sha": "82afe0627db4b05dacb3111563e876f74edd89b0", "url": "https://api.github.com/repos/StackStorm/ansible-st2/commits/82afe0627db4b05dacb3111563e876f74edd89b0", "parents": ["e8eb28b4b4b1c4fb2490b8198570166b9ca23ab2", "ce1177a17abafd0e681c57a4e7333c0e7c2f5455"], "files": [{"sha": "1a20a8fdec4e0b0259b12f56e0522c84cbf62138", "filename": "roles/mistral/tasks/install_mistral.yml", "previous_filename": null, "additions": 2, "deletions": 7, "changes": 9, "blob_url": "https://github.com/StackStorm/ansible-st2/blob/82afe0627db4b05dacb3111563e876f74edd89b0/roles/mistral/tasks/install_mistral.yml", "raw_url": "https://github.com/StackStorm/ansible-st2/raw/82afe0627db4b05dacb3111563e876f74edd89b0/roles/mistral/tasks/install_mistral.yml", "status": "modified", "patch": "@@ -10,21 +10,16 @@\n     repo: https://github.com/StackStorm/mistral.git\n     version: \"{{ mistral_branch }}\"\n     dest: /opt/openstack/mistral\n+    force: yes\n \n - name: Install requirements\n   sudo: true\n   pip:\n     requirements: /opt/openstack/mistral/requirements.txt\n     virtualenv: /opt/openstack/mistral/.venv\n \n-- name: Install additional requirements\n-  sudo: true\n-  pip:\n-    name: mysql-python\n-    virtualenv: /opt/openstack/mistral/.venv\n-\n - name: Install Mistral\n   sudo: true\n-  shell: /opt/openstack/mistral/.venv/bin/python setup.py develop\n+  shell: /opt/openstack/mistral/.venv/bin/python setup.py install\n   args:\n     chdir: /opt/openstack/mistral", "release_starts_at": null, "release_ends_at": "2d0f3f1cf5d5919432c94bb3659c16b85d1cb1db"}, {"sha": "12db42bf90412963e6eddcfcc17a39810b492a2f", "filename": "roles/mistral/tasks/sync.yml", "previous_filename": null, "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/StackStorm/ansible-st2/blob/82afe0627db4b05dacb3111563e876f74edd89b0/roles/mistral/tasks/sync.yml", "raw_url": "https://github.com/StackStorm/ansible-st2/raw/82afe0627db4b05dacb3111563e876f74edd89b0/roles/mistral/tasks/sync.yml", "status": "modified", "patch": "@@ -2,3 +2,4 @@\n   shell: /opt/openstack/mistral/.venv/bin/python ./tools/sync_db.py --config-file /etc/mistral/mistral.conf\n   args:\n     chdir: /opt/openstack/mistral\n+    creates: /etc/mistral/database_setup.lock", "release_starts_at": null, "release_ends_at": "2d0f3f1cf5d5919432c94bb3659c16b85d1cb1db"}, {"sha": "7fc8e317a733f132b8b6fa4d87e7d5aa18a24bd1", "filename": "roles/mistral/vars/main.yml", "previous_filename": null, "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/StackStorm/ansible-st2/blob/82afe0627db4b05dacb3111563e876f74edd89b0/roles/mistral/vars/main.yml", "raw_url": "https://github.com/StackStorm/ansible-st2/raw/82afe0627db4b05dacb3111563e876f74edd89b0/roles/mistral/vars/main.yml", "status": "modified", "patch": "@@ -7,3 +7,5 @@ mistral_branches:\n     then: st2-0.8.1\n   - if: 0.9.0\n     then: st2-0.9.0\n+  - if: 0.13\n+    then: st2-0.13.0", "release_starts_at": null, "release_ends_at": "2d0f3f1cf5d5919432c94bb3659c16b85d1cb1db"}, {"sha": "9e3a35742194d6565a390de34e73bfa462ebae44", "filename": "roles/mistral/tasks/config.yml", "previous_filename": null, "additions": 0, "deletions": 6, "changes": 6, "blob_url": "https://github.com/StackStorm/ansible-st2/blob/82afe0627db4b05dacb3111563e876f74edd89b0/roles/mistral/tasks/config.yml", "raw_url": "https://github.com/StackStorm/ansible-st2/raw/82afe0627db4b05dacb3111563e876f74edd89b0/roles/mistral/tasks/config.yml", "status": "modified", "patch": "@@ -29,9 +29,3 @@\n     dest: /etc/init/mistral.conf\n   notify:\n     - restart mistral\n-\n-- name: Enable the service\n-  sudo: true\n-  service:\n-    name: mysql\n-    enabled: yes", "release_starts_at": null, "release_ends_at": "2d0f3f1cf5d5919432c94bb3659c16b85d1cb1db"}, {"sha": "c460d09606a3f186d380d6d258cf7615742fae2a", "filename": "roles/mistral/tasks/install_actions.yml", "previous_filename": null, "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/StackStorm/ansible-st2/blob/82afe0627db4b05dacb3111563e876f74edd89b0/roles/mistral/tasks/install_actions.yml", "raw_url": "https://github.com/StackStorm/ansible-st2/raw/82afe0627db4b05dacb3111563e876f74edd89b0/roles/mistral/tasks/install_actions.yml", "status": "modified", "patch": "@@ -13,6 +13,6 @@\n \n - name: Install Mistral actions\n   sudo: true\n-  shell: /opt/openstack/mistral/.venv/bin/python setup.py develop\n+  shell: /opt/openstack/mistral/.venv/bin/python setup.py install\n   args:\n     chdir: /etc/mistral/actions/st2mistral", "release_starts_at": null, "release_ends_at": "2d0f3f1cf5d5919432c94bb3659c16b85d1cb1db"}, {"sha": "5493082be6cd2b672046bd6b5641dc00a0f84b86", "filename": "roles/mistral/tasks/install_deps.yml", "previous_filename": null, "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/StackStorm/ansible-st2/blob/82afe0627db4b05dacb3111563e876f74edd89b0/roles/mistral/tasks/install_deps.yml", "raw_url": "https://github.com/StackStorm/ansible-st2/raw/82afe0627db4b05dacb3111563e876f74edd89b0/roles/mistral/tasks/install_deps.yml", "status": "modified", "patch": "@@ -10,9 +10,9 @@\n     - libffi-dev\n     - libxml2-dev\n     - libxslt1-dev\n+    - libpq-dev\n     - python-dev\n     - python-pip\n-    - libmysqlclient-dev\n \n - name: Install pip virtualenv\n   sudo: true", "release_starts_at": null, "release_ends_at": "2d0f3f1cf5d5919432c94bb3659c16b85d1cb1db"}, {"sha": "3811d186813881df1e4668427f7facff4c07d55a", "filename": "roles/mistral/defaults/main.yml", "previous_filename": null, "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/StackStorm/ansible-st2/blob/82afe0627db4b05dacb3111563e876f74edd89b0/roles/mistral/defaults/main.yml", "raw_url": "https://github.com/StackStorm/ansible-st2/raw/82afe0627db4b05dacb3111563e876f74edd89b0/roles/mistral/defaults/main.yml", "status": "modified", "patch": "@@ -1 +1 @@\n-version: 0.9.0\n+version: 0.13", "release_starts_at": null, "release_ends_at": "2d0f3f1cf5d5919432c94bb3659c16b85d1cb1db"}], "release_starts_at": "36f63dc3647721266cdb0d09e6836ce99546505e"}, {"repo": "awailly/cis-ubuntu-ansible", "_Commit__release_start_at": "2cfa28fd756194b32e320ab9c0df1e455f27dc38", "author_id": "MDQ6VXNlcjk3MTc1NQ==", "author_name": "Aur\u00e9lien Wailly", "committer_id": "MDQ6VXNlcjk3MTc1NQ==", "committer_name": "Aur\u00e9lien Wailly", "committer_email": "aurelien.wailly@gmail.com", "message": "Fix #15 No more travis_env variable\n\n- Better configuration files to create travis compliance", "sha": "3fec379fb9c629de7360f9eee6d320e0ba907c05", "url": "https://api.github.com/repos/awailly/cis-ubuntu-ansible/commits/3fec379fb9c629de7360f9eee6d320e0ba907c05", "parents": ["addbee435e20e706e7cf5d2f0a3723e17f79b527"], "files": [{"sha": "9f75d88c4170f076577720ada65d19c6a2f575bb", "filename": "tasks/section_07_level1.yml", "previous_filename": null, "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/awailly/cis-ubuntu-ansible/blob/3fec379fb9c629de7360f9eee6d320e0ba907c05/tasks/section_07_level1.yml", "raw_url": "https://github.com/awailly/cis-ubuntu-ansible/raw/3fec379fb9c629de7360f9eee6d320e0ba907c05/tasks/section_07_level1.yml", "status": "modified", "patch": "@@ -254,7 +254,7 @@\n       - net.ipv6.conf.all.disable_ipv6\n       - net.ipv6.conf.default.disable_ipv6\n       - net.ipv6.conf.lo.disable_ipv6\n-    when: travis_env == False\n+    when: disable_ipv6 == True\n     tags:\n       - section7\n       - section7.3", "release": "2cfa28fd756194b32e320ab9c0df1e455f27dc38"}, {"sha": "def22b71e29a9b9485fc201fc28ff4cb2fc5b3fd", "filename": "tasks/section_04_level1.yml", "previous_filename": null, "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/awailly/cis-ubuntu-ansible/blob/3fec379fb9c629de7360f9eee6d320e0ba907c05/tasks/section_04_level1.yml", "raw_url": "https://github.com/awailly/cis-ubuntu-ansible/raw/3fec379fb9c629de7360f9eee6d320e0ba907c05/tasks/section_04_level1.yml", "status": "modified", "patch": "@@ -12,7 +12,7 @@\n         name=fs.suid_dumpable\n         value=0\n         state=present\n-    when: travis_env == False\n+    when: restrict_core_dumps == True\n     tags:\n       - section4\n       - section4.1", "release": "2cfa28fd756194b32e320ab9c0df1e455f27dc38"}, {"sha": "beca447b8e213a8875e704b75de7d45b25a1674e", "filename": "tasks/section_01_level1.yml", "previous_filename": null, "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/awailly/cis-ubuntu-ansible/blob/3fec379fb9c629de7360f9eee6d320e0ba907c05/tasks/section_01_level1.yml", "raw_url": "https://github.com/awailly/cis-ubuntu-ansible/raw/3fec379fb9c629de7360f9eee6d320e0ba907c05/tasks/section_01_level1.yml", "status": "modified", "patch": "@@ -9,7 +9,7 @@\n \n   - name: 1.1.2 Install Updates, Patches and Additional Security Software (NotScored)\n     apt: upgrade=yes\n-    when: travis_env == False\n+    when: apt_upgrade == False\n     tags:\n       - section1\n       - section1.1", "release": "2cfa28fd756194b32e320ab9c0df1e455f27dc38"}, {"sha": "5a03ce9abd50bd9d9028e72fa82a250b7834a51a", "filename": "tasks/section_04_level2.yml", "previous_filename": null, "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/awailly/cis-ubuntu-ansible/blob/3fec379fb9c629de7360f9eee6d320e0ba907c05/tasks/section_04_level2.yml", "raw_url": "https://github.com/awailly/cis-ubuntu-ansible/raw/3fec379fb9c629de7360f9eee6d320e0ba907c05/tasks/section_04_level2.yml", "status": "modified", "patch": "@@ -33,7 +33,7 @@\n     failed_when: '\"0 profiles are loaded\" in aa_status_lines.stdout_lines or \"0 processes are in complain mode.\" not in aa_status_lines.stdout_lines or \"0 processes are unconfined but have a profile defined.\" not in aa_status_lines.stdout_lines'\n         # - '\"0 processes are unconfined but have a profile defined.\" not in aa_status_lines.stdout_lines'\n     changed_when: False\n-    when: travis_env == False and use_apparmor == True\n+    when: use_apparmor == True\n     tags:\n       - section4\n       - section4.5", "release": "2cfa28fd756194b32e320ab9c0df1e455f27dc38"}]}, {"repo": "nusenu/ansible-relayor", "_Commit__release_start_at": "1224adf2811c827a09ff0bf133fbb476901a547d", "author_id": null, "author_name": "nusenu", "committer_id": null, "committer_name": "nusenu", "committer_email": "nusenu@openmailbox.org", "message": "add support for private IPv4 addresses (fixes #102)\n\nUse public IPs only by default and fallback\nto a single private IP in case we have no public IP.\nUsing public _and_ private IPv4 addresses at the same\ntime on a single host is not supported.\n\nFixes a bug where we created more than two\ntor instances per public IPv4 address when the\nhost had private and public IPv4 addresses.\n\nVariable 'tor_v4ips' can no longer be set since it is\npotentially overwritten at runtime.\n\ntor_maxips is replaced with tor_maxPublicIPs + tor_maxPrivateIPs\n\ntorrc: no longer include 'Address' line.\n\nThis would be simpler without bug ansible/ansible#14829 (#80).", "sha": "1224adf2811c827a09ff0bf133fbb476901a547d", "url": "https://api.github.com/repos/nusenu/ansible-relayor/commits/1224adf2811c827a09ff0bf133fbb476901a547d", "parents": ["f5364b57f100ae9fa898af59b7812ec0c447ac42"], "files": [{"sha": "1988f01ef9d24891230f86caf9f6bb0c5d99b828", "filename": "tasks/ip-list.yml", "previous_filename": null, "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/nusenu/ansible-relayor/blob/1224adf2811c827a09ff0bf133fbb476901a547d/tasks/ip-list.yml", "raw_url": "https://github.com/nusenu/ansible-relayor/raw/1224adf2811c827a09ff0bf133fbb476901a547d/tasks/ip-list.yml", "status": "modified", "patch": "@@ -1,5 +1,9 @@\n ---\n \n+- name: Use a single private IPv4 address if we have no public IPv4 address\n+  include_vars: private_IPv4_only.yml\n+  when: tor_v4ips == []\n+\n # workaround for this ansible IPv6 filter bug\n # https://github.com/ansible/ansible/issues/14829\n # we simply convert False to empty lists", "release": "1224adf2811c827a09ff0bf133fbb476901a547d"}]}, {"repo": "Capgemini/Apollo", "_Commit__release_starts_at": null, "_Commit__release_ends_at": "dfa8978dc272945b9b4fce761c4bb23af2dd6653", "author_id": "MDQ6VXNlcjE2ODE4OTY=", "author_name": "Graham Taylor", "committer_id": "MDQ6VXNlcjE2ODE4OTY=", "committer_name": "Graham Taylor", "committer_email": "gtayzlor@gmail.com", "message": "Fix #119 - consul not coming up correctly in AWS", "sha": "fdda70a652ab2d1b7332afb252489cd8bc4da715", "url": "https://api.github.com/repos/Capgemini/Apollo/commits/fdda70a652ab2d1b7332afb252489cd8bc4da715", "parents": ["4e9fdb819a1d7565413b47dca677f7811946668d"], "files": [{"sha": "a8566f14f8bc3d7dc24c5ef16a8efc83b4f8bc68", "filename": "roles/consul/tasks/main.yml", "previous_filename": null, "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/Capgemini/Apollo/blob/fdda70a652ab2d1b7332afb252489cd8bc4da715/roles/consul/tasks/main.yml", "raw_url": "https://github.com/Capgemini/Apollo/raw/fdda70a652ab2d1b7332afb252489cd8bc4da715/roles/consul/tasks/main.yml", "status": "modified", "patch": "@@ -3,6 +3,9 @@\n - name: remove consul override\n   command: /bin/rm -f /etc/init/consul.override\n \n+- name: start consul\n+  service: name=consul state=started\n+\n - name: configure consul\n   sudo: yes\n   template: src=consul.json.j2 dest=/etc/consul.d/consul.json owner=root group=root mode=0644\n@@ -20,9 +23,6 @@\n   tags:\n     - consul\n \n-- name: start consul\n-  service: name=consul state=started\n-\n - name: remove consul-join override\n   command: /bin/rm -f /etc/init/consul-join.override\n   when: consul_join is defined", "release_starts_at": null, "release_ends_at": "dfa8978dc272945b9b4fce761c4bb23af2dd6653"}], "release_starts_at": "38b3b7876cf98a70020ad31545a3654a44aff314"}, {"repo": "nusenu/ansible-relayor", "_Commit__release_start_at": "1224adf2811c827a09ff0bf133fbb476901a547d", "author_id": null, "author_name": "nusenu", "committer_id": null, "committer_name": "nusenu", "committer_email": "nusenu@openmailbox.org", "message": "Debian: allow \"_\" and \".\" in instance names, so our instances are started properly after package upgrade (fixes #72)", "sha": "0406395a8758f12abd57914532cc0ff17894d015", "url": "https://api.github.com/repos/nusenu/ansible-relayor/commits/0406395a8758f12abd57914532cc0ff17894d015", "parents": ["32211ebd2a9f45112f8dceda80bc95d0db029fb4"], "files": [{"sha": "ffad5368a5a2f427dd880a5eab0d98ef0af0eeca", "filename": "tasks/apt_install.yml", "previous_filename": null, "additions": 19, "deletions": 0, "changes": 19, "blob_url": "https://github.com/nusenu/ansible-relayor/blob/0406395a8758f12abd57914532cc0ff17894d015/tasks/apt_install.yml", "raw_url": "https://github.com/nusenu/ansible-relayor/raw/0406395a8758f12abd57914532cc0ff17894d015/tasks/apt_install.yml", "status": "modified", "patch": "@@ -35,6 +35,25 @@\n   notify:\n     - stop-and-mask default tor instance\n \n+# Background:\n+# https://github.com/nusenu/ansible-relayor/issues/72\n+- name: Ensure systemd generator folder exists (Debian Testing and Ubuntu)\n+  become: yes\n+  file: path=/etc/systemd/system-generators state=directory mode=755\n+  when: ansible_lsb.codename != 'jessie'\n+\n+- name: Ensure custom systemd generator is in place (Debian/Ubuntu only)\n+  become: yes\n+  copy: src=tor-generator\n+   dest=\"{{ (ansible_lsb.codename == 'jessie')|ternary('/lib/systemd/system-generators/relayor-generator', '/etc/systemd/system-generators/tor-generator') }}\"\n+   owner=root\n+   mode=755\n+\n+- name: Ensure the maintainer's generator is disabled (Debian 8 only)\n+  become: yes\n+  command: dpkg-statoverride --update --add root root 644 /lib/systemd/system-generators/tor-generator\n+  when: ansible_lsb.codename == 'jessie'\n+\n \n #- name: Ensure AppArmor allows access to necessary files (Ubuntu)\n #  become: yes", "release": "1224adf2811c827a09ff0bf133fbb476901a547d"}]}, {"repo": "awailly/cis-ubuntu-ansible", "_Commit__release_start_at": "2cfa28fd756194b32e320ab9c0df1e455f27dc38", "author_id": "MDQ6VXNlcjk3MTc1NQ==", "author_name": "Aur\u00e9lien Wailly", "committer_id": "MDQ6VXNlcjk3MTc1NQ==", "committer_name": "Aur\u00e9lien Wailly", "committer_email": "aurelien.wailly@gmail.com", "message": "Fix #5 with remount in fstab\n\n- Loop locking the system", "sha": "301523849a643976f79ca1767eddaf3d1c00fff8", "url": "https://api.github.com/repos/awailly/cis-ubuntu-ansible/commits/301523849a643976f79ca1767eddaf3d1c00fff8", "parents": ["c64269916ee60a23098a45df4b08f814dc7235d2"], "files": [{"sha": "274d42661aea1b83bd292430330ca60a63d46c9d", "filename": "tasks/section_02_level1.yml", "previous_filename": null, "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/awailly/cis-ubuntu-ansible/blob/301523849a643976f79ca1767eddaf3d1c00fff8/tasks/section_02_level1.yml", "raw_url": "https://github.com/awailly/cis-ubuntu-ansible/raw/301523849a643976f79ca1767eddaf3d1c00fff8/tasks/section_02_level1.yml", "status": "modified", "patch": "@@ -72,7 +72,7 @@\n       - section2.13\n \n   - name: 2.14 - 16 Add nodev Option to /run/shm Partition (Scored)\n-    mount: name=\"/run/shm\" src=\"/run/shm\" state=\"mounted\" opts=\"remount,nodev,nosuid,noexec\" fstype=\"tmpfs\"\n+    mount: name=\"/run/shm\" src=\"/run/shm\" state=\"mounted\" opts=\"nodev,nosuid,noexec\" fstype=\"tmpfs\"\n     tags:\n       - section2\n       - section2.14", "release": "2cfa28fd756194b32e320ab9c0df1e455f27dc38"}]}, {"repo": "Capgemini/Apollo", "_Commit__release_starts_at": null, "_Commit__release_ends_at": "dfa8978dc272945b9b4fce761c4bb23af2dd6653", "author_id": "MDQ6VXNlcjE2ODE4OTY=", "author_name": "Graham Taylor", "committer_id": "MDQ6VXNlcjE2ODE4OTY=", "committer_name": "Graham Taylor", "committer_email": "graham.x.taylor@capgemini.com", "message": "Fix #98 weave launch needs to be cluster aware", "sha": "56ac5c94dfd461f984a11d85c639121a176abfc6", "url": "https://api.github.com/repos/Capgemini/Apollo/commits/56ac5c94dfd461f984a11d85c639121a176abfc6", "parents": ["4aaf839a9916f65d12b8964b23dbc6848a73ca67"], "files": [{"sha": "2af660284841bf389715f654682f4f78069c993d", "filename": "roles/weave/handlers/main.yml", "previous_filename": null, "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Capgemini/Apollo/blob/56ac5c94dfd461f984a11d85c639121a176abfc6/roles/weave/handlers/main.yml", "raw_url": "https://github.com/Capgemini/Apollo/raw/56ac5c94dfd461f984a11d85c639121a176abfc6/roles/weave/handlers/main.yml", "status": "modified", "patch": "@@ -13,7 +13,7 @@\n   sudo: yes\n \n - name: Weave launch\n-  command: /usr/local/bin/weave launch\n+  command: /usr/local/bin/weave launch {{ weave_launch_peers }}\n   sudo: yes\n   tags:\n     - weave", "release_starts_at": null, "release_ends_at": "dfa8978dc272945b9b4fce761c4bb23af2dd6653"}, {"sha": "176e9b84b00024dc89d8ec93bb4b814d98fb3eb8", "filename": "roles/weave/defaults/main.yml", "previous_filename": null, "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Capgemini/Apollo/blob/56ac5c94dfd461f984a11d85c639121a176abfc6/roles/weave/defaults/main.yml", "raw_url": "https://github.com/Capgemini/Apollo/raw/56ac5c94dfd461f984a11d85c639121a176abfc6/roles/weave/defaults/main.yml", "status": "modified", "patch": "@@ -9,3 +9,12 @@ weave_docker_subnet: \"\n       {%- endif -%}\n     {%- endfor -%}\n \"\n+weave_launch_peers: \"\n+  {%- set weave_peers = [] -%}\n+  {%- for host in groups[weave_server_group] -%}\n+    {%- if host != inventory_hostname and host not in weave_peers -%}\n+      {% do weave_peers.append(hostvars[host]['ansible_eth0']['ipv4']['address']) %}\n+    {%- endif -%}\n+  {%- endfor -%}\n+  {{ weave_peers|join(' ') }}\n+\"", "release_starts_at": null, "release_ends_at": "dfa8978dc272945b9b4fce761c4bb23af2dd6653"}], "release_starts_at": "38b3b7876cf98a70020ad31545a3654a44aff314"}, {"repo": "nusenu/ansible-relayor", "_Commit__release_start_at": "1224adf2811c827a09ff0bf133fbb476901a547d", "author_id": null, "author_name": "nusenu", "committer_id": null, "committer_name": "nusenu", "committer_email": "nusenu@openmailbox.org", "message": "remove task 'Check for local requirements' (fixes #96)\n\nit does not work on macOS (the only platform it was written for)", "sha": "196c5c74623fe97d88ea1e2527b96d7ccef784a5", "url": "https://api.github.com/repos/nusenu/ansible-relayor/commits/196c5c74623fe97d88ea1e2527b96d7ccef784a5", "parents": ["8af8d9f258ac145b451e2f0db433e5e9ad335ea2"], "files": [{"sha": "d98ea2a48d9f37fc6707bb9161c2400c1679169c", "filename": "tasks/main.yml", "previous_filename": null, "additions": 0, "deletions": 7, "changes": 7, "blob_url": "https://github.com/nusenu/ansible-relayor/blob/196c5c74623fe97d88ea1e2527b96d7ccef784a5/tasks/main.yml", "raw_url": "https://github.com/nusenu/ansible-relayor/raw/196c5c74623fe97d88ea1e2527b96d7ccef784a5/tasks/main.yml", "status": "modified", "patch": "@@ -10,13 +10,6 @@\n   tags:\n     - always\n \n-- name: Check for local requirements\n-  shell: tor --version && sha1sum --version && sort --version && uniq --version && wc --version && cut --version\n-  run_once: true\n-  delegate_to: 127.0.0.1\n-  tags:\n-    - always\n-\n - name: Set OS specific variables\n   include_vars: \"{{ ansible_os_family }}.yml\"\n   tags:", "release": "1224adf2811c827a09ff0bf133fbb476901a547d"}]}, {"repo": "brianshumate/ansible-consul", "_Commit__release_starts_at": null, "_Commit__release_ends_at": "6f2fdbaf6a98476a156102c6215391a09c3e6a42", "author_id": "MDQ6VXNlcjc3NTYz", "author_name": "Brian Shumate", "committer_id": "MDQ6VXNlcjc3NTYz", "committer_name": "Brian Shumate", "committer_email": "brian@brianshumate.com", "message": "Fix links and lower Debian, fixes #63 fixes #64", "sha": "589eabd2deead42e14966eb4aa7f9b20e2a9efde", "url": "https://api.github.com/repos/brianshumate/ansible-consul/commits/589eabd2deead42e14966eb4aa7f9b20e2a9efde", "parents": ["e37580d4f68ca3a8c5acaaef3fafad034bc499c3"], "files": [{"sha": "c99403370bc7068e668309c699a6fcd9bfb33f05", "filename": "tasks/asserts.yml", "previous_filename": null, "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/brianshumate/ansible-consul/blob/589eabd2deead42e14966eb4aa7f9b20e2a9efde/tasks/asserts.yml", "raw_url": "https://github.com/brianshumate/ansible-consul/raw/589eabd2deead42e14966eb4aa7f9b20e2a9efde/tasks/asserts.yml", "status": "modified", "patch": "@@ -18,7 +18,7 @@\n     msg: \"{{ ansible_distribution_version }} is not a supported version.\"\n   when:\n     - ansible_distribution == \"Debian\"\n-    - ansible_distribution_version|version_compare(8.5, '<')\n+    - ansible_distribution_version|version_compare(8, '<')\n \n - name: Check FreeBSD version\n   fail:", "release_starts_at": null, "release_ends_at": "6f2fdbaf6a98476a156102c6215391a09c3e6a42"}], "release_starts_at": "47eb83c431cc68262d286df231c98c0a927b1e8a"}, {"repo": "nusenu/ansible-relayor", "_Commit__release_start_at": "1224adf2811c827a09ff0bf133fbb476901a547d", "author_id": null, "author_name": "nusenu", "committer_id": null, "committer_name": "nusenu", "committer_email": "nusenu@openmailbox.org", "message": "OpenBSD: tor was not started appropriately with \"-f config\" during initial install due to an ordering issue (closes #34)", "sha": "850b64e62ec69d7b4d32f0ad9258e608b0e50ca2", "url": "https://api.github.com/repos/nusenu/ansible-relayor/commits/850b64e62ec69d7b4d32f0ad9258e608b0e50ca2", "parents": ["72a9fefcabb6edccd82abb23946bd305035db334"], "files": [{"sha": "44617d6949d8b6bf3e0ad200b6f158d7436a298a", "filename": "tasks/configure.yml", "previous_filename": null, "additions": 9, "deletions": 9, "changes": 18, "blob_url": "https://github.com/nusenu/ansible-relayor/blob/850b64e62ec69d7b4d32f0ad9258e608b0e50ca2/tasks/configure.yml", "raw_url": "https://github.com/nusenu/ansible-relayor/raw/850b64e62ec69d7b4d32f0ad9258e608b0e50ca2/tasks/configure.yml", "status": "modified", "patch": "@@ -148,15 +148,6 @@\n   tags:\n    - openbsd\n \n-- name: Ensure Tor instances are reloaded if its torrc changed (OpenBSD)\n-  sudo: yes\n-  service: name=tor{{ item.item[0]|replace('.','_') }}_{{ item.item.1.orport }} state=reloaded\n-  with_items: instances.results\n-  when: ansible_system == 'OpenBSD' and item.changed == True\n-  tags:\n-   - openbsd\n-   - configure\n-\n - name: Ensure Tor instances are enabled and started (OpenBSD)\n   sudo: yes\n   service: name=tor{{ item[0]|replace('.','_') }}_{{ item.1.orport }}\n@@ -168,6 +159,15 @@\n   tags:\n    - openbsd\n \n+- name: Ensure Tor instances are reloaded if its torrc changed (OpenBSD)\n+  sudo: yes\n+  service: name=tor{{ item.item[0]|replace('.','_') }}_{{ item.item.1.orport }} state=reloaded\n+  with_items: instances.results\n+  when: ansible_system == 'OpenBSD' and item.changed == True\n+  tags:\n+   - openbsd\n+   - configure\n+\n \n # FreeBSD section\n # ================", "release": "1224adf2811c827a09ff0bf133fbb476901a547d"}]}, {"repo": "awailly/cis-ubuntu-ansible", "_Commit__release_start_at": "2cfa28fd756194b32e320ab9c0df1e455f27dc38", "author_id": "MDQ6VXNlcjk3MTc1NQ==", "author_name": "Aur\u00e9lien Wailly", "committer_id": "MDQ6VXNlcjk3MTc1NQ==", "committer_name": "Aur\u00e9lien Wailly", "committer_email": "aurelien.wailly@gmail.com", "message": "Fix #44 - /var/utmp is not present on all systems", "sha": "6b4857f187e399e3fb1e8ac20d92f80d1f790786", "url": "https://api.github.com/repos/awailly/cis-ubuntu-ansible/commits/6b4857f187e399e3fb1e8ac20d92f80d1f790786", "parents": ["067d6cbb20adb31a1e2bd9f689b5b6e259c30288"], "files": [{"sha": "f5fbb03fde1054509b5349729e64f55517a620be", "filename": "tasks/section_04_level2.yml", "previous_filename": null, "additions": 12, "deletions": 1, "changes": 13, "blob_url": "https://github.com/awailly/cis-ubuntu-ansible/blob/6b4857f187e399e3fb1e8ac20d92f80d1f790786/tasks/section_04_level2.yml", "raw_url": "https://github.com/awailly/cis-ubuntu-ansible/raw/6b4857f187e399e3fb1e8ac20d92f80d1f790786/tasks/section_04_level2.yml", "status": "modified", "patch": "@@ -66,10 +66,21 @@\n       - section4\n       - section4.5\n \n-  - name: Determine if Apparmor started without error\n+  - name: 4.5 Determine if Apparmor started without error\n     fail: msg=\"Apparmor can not be started. This is normal behavior if you run the playbook for the first time.\\nPlease reboot the machine and run it again to proceed with the rest of the playbook.\"\n     when: apparmor_status.failed is defined\n \n+  - name: 4.5 Fix rsyslog /run/utmp permissions\n+    lineinfile: >\n+        dest=\"/etc/apparmor.d/usr.sbin.rsyslogd\"\n+        line=\"  /run/utmp rk,\"\n+        insertbefore=\"  /var/spool/rsyslog/ r,\"\n+        state=present\n+    when: use_apparmor == True\n+    tags:\n+      - section4\n+      - section4.5\n+\n   - name: 4.5 Activate AppArmor (fix profiles) (Scored)\n     service: >\n         name=rsyslog", "release": "2cfa28fd756194b32e320ab9c0df1e455f27dc38"}]}, {"repo": "awailly/cis-ubuntu-ansible", "_Commit__release_start_at": "2cfa28fd756194b32e320ab9c0df1e455f27dc38", "author_id": null, "author_name": "spoonboy", "committer_id": null, "committer_name": "spoonboy", "committer_email": "sabri.eddir@orange.com", "message": "Fix #23\nAdded some modification on Section 2, for mount options.", "sha": "50cad8d63538c0a863f2da59de9bc9c8b472a0ba", "url": "https://api.github.com/repos/awailly/cis-ubuntu-ansible/commits/50cad8d63538c0a863f2da59de9bc9c8b472a0ba", "parents": ["9ad67b6ef151d5fbaa05230e6cecb4bed1db7d9d"], "files": [{"sha": "dccaf0b50a38336210205e2b20ea840905a302b1", "filename": "tasks/section_02_level1.yml", "previous_filename": null, "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/awailly/cis-ubuntu-ansible/blob/50cad8d63538c0a863f2da59de9bc9c8b472a0ba/tasks/section_02_level1.yml", "raw_url": "https://github.com/awailly/cis-ubuntu-ansible/raw/50cad8d63538c0a863f2da59de9bc9c8b472a0ba/tasks/section_02_level1.yml", "status": "modified", "patch": "@@ -47,7 +47,7 @@\n       - section2.9\n \n   - name: 2.10 Add nodev Option to /home (Scored)\n-    mount: name:/home state:mounted opts:remount,nodev\n+    mount: name=\"/home\" src=\"/home\" state=mounted opts=remount,nodev fstype=\"ext4\"\n     when: partitioning == True\n     tags:\n       - section2", "release": "2cfa28fd756194b32e320ab9c0df1e455f27dc38"}]}, {"repo": "Capgemini/Apollo", "_Commit__release_starts_at": null, "_Commit__release_ends_at": "dfa8978dc272945b9b4fce761c4bb23af2dd6653", "author_id": "MDQ6VXNlcjE2ODE4OTY=", "author_name": "Graham Taylor", "committer_id": "MDQ6VXNlcjE2ODE4OTY=", "committer_name": "Graham Taylor", "committer_email": "graham.x.taylor@capgemini.com", "message": "Fixes #61 - marathon hostname link was not resolving correctly from the web interface", "sha": "04b2bd756a11870d3839aa5cb50da0b9afa16aa6", "url": "https://api.github.com/repos/Capgemini/Apollo/commits/04b2bd756a11870d3839aa5cb50da0b9afa16aa6", "parents": ["0f46bc2b1f4dac71c882be0ee48a25332a90ed40"], "files": [{"sha": "098c031a3dac9fb15e86d0b9208242cb14de5eeb", "filename": "roles/marathon/tasks/main.yml", "previous_filename": null, "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Capgemini/Apollo/blob/04b2bd756a11870d3839aa5cb50da0b9afa16aa6/roles/marathon/tasks/main.yml", "raw_url": "https://github.com/Capgemini/Apollo/raw/04b2bd756a11870d3839aa5cb50da0b9afa16aa6/roles/marathon/tasks/main.yml", "status": "modified", "patch": "@@ -1,5 +1,12 @@\n ---\n # tasks file for marathon\n+- name: Set Marathon hostname\n+  copy:\n+    content: \"{{marathon_local_address}}\"\n+    dest: /etc/marathon/conf/hostname\n+    mode: 0644\n+  sudo: yes\n+\n - name: remove marathon override\n   command: /bin/rm -f /etc/init/marathon.override\n ", "release_starts_at": null, "release_ends_at": "dfa8978dc272945b9b4fce761c4bb23af2dd6653"}, {"sha": "002953d6de58465657ee785cd5a3fe3239ba4802", "filename": "roles/marathon/defaults/main.yml", "previous_filename": null, "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Capgemini/Apollo/blob/04b2bd756a11870d3839aa5cb50da0b9afa16aa6/roles/marathon/defaults/main.yml", "raw_url": "https://github.com/Capgemini/Apollo/raw/04b2bd756a11870d3839aa5cb50da0b9afa16aa6/roles/marathon/defaults/main.yml", "status": "modified", "patch": "@@ -2,3 +2,4 @@\n # defaults file for marathon\n marathon_port: 8080\n consul_dir: /etc/consul.d\n+marathon_local_address: \"{{ansible_eth0.ipv4.address}}\"", "release_starts_at": null, "release_ends_at": "dfa8978dc272945b9b4fce761c4bb23af2dd6653"}], "release_starts_at": "38b3b7876cf98a70020ad31545a3654a44aff314"}, {"repo": "sensu/sensu-ansible", "_Commit__release_starts_at": null, "_Commit__release_ends_at": "9b3cb140022faf899910398013334755c8050175", "author_id": "MDQ6VXNlcjI0NDY2MjUw", "author_name": "awhite-telstra", "committer_id": "MDQ6VXNlcjExOTAyNDc2", "committer_name": "Stephen Muth", "committer_email": "smuth4@users.noreply.github.com", "message": "Fixes for ansible (#77)\n\n* static: false for SmartOS include\r\n\r\n* add static=false to all conditional template include", "sha": "a43c23c44c9aae1a13343ccea4b99acac997c4e1", "url": "https://api.github.com/repos/sensu/sensu-ansible/commits/a43c23c44c9aae1a13343ccea4b99acac997c4e1", "parents": ["f565940c5163524c7834123625c804e5f69c2b10"], "files": [{"sha": "eeddca97d5c70fe44719d383d17367b9242d0c85", "filename": "tasks/main.yml", "previous_filename": null, "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/sensu/sensu-ansible/blob/a43c23c44c9aae1a13343ccea4b99acac997c4e1/tasks/main.yml", "raw_url": "https://github.com/sensu/sensu-ansible/raw/a43c23c44c9aae1a13343ccea4b99acac997c4e1/tasks/main.yml", "status": "modified", "patch": "@@ -10,6 +10,7 @@\n     tags: redis\n     when: redis_server\n           and sensu_deploy_redis\n+    static: false\n \n   - include: ssl.yml\n     tags: ssl\n@@ -18,21 +19,25 @@\n     tags: rabbitmq\n     when: rabbitmq_server\n           and sensu_deploy_rabbitmq\n+    static: false\n \n   - include: common.yml\n     tags: common\n \n   - include: server.yml\n     tags: server\n     when: sensu_master\n+    static: false\n \n   - include: dashboard.yml\n     tags: dashboard\n     when: sensu_include_dashboard\n+    static: false\n \n   - include: client.yml\n     tags: client\n \n   - include: plugins.yml\n     tags: plugins\n     when: sensu_include_plugins\n+    static: false", "release_starts_at": null, "release_ends_at": "9b3cb140022faf899910398013334755c8050175"}, {"sha": "f88f161d38ffc9ddb5e764ec5439576f8391e12b", "filename": "tasks/server.yml", "previous_filename": null, "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/sensu/sensu-ansible/blob/a43c23c44c9aae1a13343ccea4b99acac997c4e1/tasks/server.yml", "raw_url": "https://github.com/sensu/sensu-ansible/raw/a43c23c44c9aae1a13343ccea4b99acac997c4e1/tasks/server.yml", "status": "modified", "patch": "@@ -13,6 +13,7 @@\n \n   - include: SmartOS/server.yml\n     when: ansible_distribution == \"SmartOS\"\n+    static: false\n \n   - name: Ensure Sensu server service is running\n     service: name=sensu-server state=started enabled=yes", "release_starts_at": null, "release_ends_at": "9b3cb140022faf899910398013334755c8050175"}, {"sha": "a11efb83b90d0e86b372a0320e1bdd50b3f06808", "filename": "tasks/ssl.yml", "previous_filename": null, "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/sensu/sensu-ansible/blob/a43c23c44c9aae1a13343ccea4b99acac997c4e1/tasks/ssl.yml", "raw_url": "https://github.com/sensu/sensu-ansible/raw/a43c23c44c9aae1a13343ccea4b99acac997c4e1/tasks/ssl.yml", "status": "modified", "patch": "@@ -12,6 +12,7 @@\n \n   - include: ssl_generate.yml\n     when: sensu_ssl_gen_certs\n+    static: false\n \n   - name: Deploy the Sensu client SSL cert/key\n     copy:", "release_starts_at": null, "release_ends_at": "9b3cb140022faf899910398013334755c8050175"}, {"sha": "5395ac8e7deb21b292b0bf2b570519fcd184af35", "filename": "tasks/client.yml", "previous_filename": null, "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/sensu/sensu-ansible/blob/a43c23c44c9aae1a13343ccea4b99acac997c4e1/tasks/client.yml", "raw_url": "https://github.com/sensu/sensu-ansible/raw/a43c23c44c9aae1a13343ccea4b99acac997c4e1/tasks/client.yml", "status": "modified", "patch": "@@ -13,6 +13,7 @@\n \n   - include: SmartOS/client.yml\n     when: ansible_distribution == \"SmartOS\"\n+    static: false\n \n   - name: Ensure Sensu client service is running\n     service: name=sensu-client state=started enabled=yes", "release_starts_at": null, "release_ends_at": "9b3cb140022faf899910398013334755c8050175"}], "release_starts_at": "f635e4cb6aa1fb00663aa57a4f116b2b2c83b804"}, {"repo": "sensu/sensu-ansible", "_Commit__release_starts_at": null, "_Commit__release_ends_at": "9b3cb140022faf899910398013334755c8050175", "author_id": "MDQ6VXNlcjEzMzM0OTc0", "author_name": "ttic-admin", "committer_id": "MDQ6VXNlcjExOTAyNDc2", "committer_name": "Stephen Muth", "committer_email": "smuth4@users.noreply.github.com", "message": "fixed unarchive (#25)", "sha": "64f24862e74ee4db9efca3941a8f526e2b308af5", "url": "https://api.github.com/repos/sensu/sensu-ansible/commits/64f24862e74ee4db9efca3941a8f526e2b308af5", "parents": ["6d51642c8f7babe4c8185b60872420333a5d3caa"], "files": [{"sha": "751e7d8f0bdbf227e3db20f37cc66fb2e72c7d8f", "filename": "tasks/ssl_generate.yml", "previous_filename": null, "additions": 2, "deletions": 6, "changes": 8, "blob_url": "https://github.com/sensu/sensu-ansible/blob/64f24862e74ee4db9efca3941a8f526e2b308af5/tasks/ssl_generate.yml", "raw_url": "https://github.com/sensu/sensu-ansible/raw/64f24862e74ee4db9efca3941a8f526e2b308af5/tasks/ssl_generate.yml", "status": "modified", "patch": "@@ -21,17 +21,13 @@\n \n   - block:\n \n-    - name: Fetch the ssl_certs tarball from sensuapp.org\n-      get_url:\n-        url: http://sensuapp.org/docs/{{ sensu_ssl_tool_version }}/files/sensu_ssl_tool.tar\n-        dest: \"{{ sensu_config_path }}/ssl_generation/sensu_ssl_tool.tar\"\n-\n     - name: Untar the ssl_certs tarball from sensuapp.org\n       unarchive:\n       args:\n-        src: \"{{ sensu_config_path }}/ssl_generation/sensu_ssl_tool.tar\"\n+        src: http://sensuapp.org/docs/{{ sensu_ssl_tool_version }}/files/sensu_ssl_tool.tar\n         dest: \"{{ sensu_config_path }}/ssl_generation/\"\n         creates: \"{{ sensu_config_path }}/ssl_generation/sensu_ssl_tool\"\n+        copy: no\n \n     - name: Generate SSL certs\n       command: \"_ {{ sensu_config_path }}/ssl_generation/sensu_ssl_tool/ssl_certs.sh generate\"", "release_starts_at": null, "release_ends_at": "9b3cb140022faf899910398013334755c8050175"}], "release_starts_at": "f635e4cb6aa1fb00663aa57a4f116b2b2c83b804"}, {"repo": "awailly/cis-ubuntu-ansible", "_Commit__release_start_at": "2cfa28fd756194b32e320ab9c0df1e455f27dc38", "author_id": "MDQ6VXNlcjk3MTc1NQ==", "author_name": "Aur\u00e9lien Wailly", "committer_id": "MDQ6VXNlcjk3MTc1NQ==", "committer_name": "Aur\u00e9lien Wailly", "committer_email": "aurelien.wailly@gmail.com", "message": "Fix #9 together with new defaults/main.yml\n\nThe multiples use_apparmor should be factored.", "sha": "bc418d30bf4fa5f6a0038115a6af7f90049db84f", "url": "https://api.github.com/repos/awailly/cis-ubuntu-ansible/commits/bc418d30bf4fa5f6a0038115a6af7f90049db84f", "parents": ["a2393d46f0b98700161c4cefd9260d7694bd0bf3"], "files": [{"sha": "6c874d43c6b4cf561554873117a07835888968a3", "filename": "tasks/section_04_level2.yml", "previous_filename": null, "additions": 5, "deletions": 1, "changes": 6, "blob_url": "https://github.com/awailly/cis-ubuntu-ansible/blob/bc418d30bf4fa5f6a0038115a6af7f90049db84f/tasks/section_04_level2.yml", "raw_url": "https://github.com/awailly/cis-ubuntu-ansible/raw/bc418d30bf4fa5f6a0038115a6af7f90049db84f/tasks/section_04_level2.yml", "status": "modified", "patch": "@@ -4,6 +4,7 @@\n     apt: >\n         name=apparmor\n         state=present\n+    when: use_apparmor == True\n     tags:\n       - section4\n       - section4.5\n@@ -12,6 +13,7 @@\n     service: >\n         name=apparmor\n         state=started\n+    when: use_apparmor == True\n     tags:\n       - section4\n       - section4.5\n@@ -22,7 +24,7 @@\n     failed_when: '\"0 profiles are loaded\" in aa_status_lines.stdout_lines or \"0 processes are in complain mode.\" not in aa_status_lines.stdout_lines or \"0 processes are unconfined but have a profile defined.\" not in aa_status_lines.stdout_lines'\n         # - '\"0 processes are unconfined but have a profile defined.\" not in aa_status_lines.stdout_lines'\n     changed_when: False\n-    when: travis_env == False\n+    when: travis_env == False and use_apparmor == True\n     tags:\n       - section4\n       - section4.5\n@@ -31,6 +33,7 @@\n     apt: >\n         name=apparmor-utils\n         state=present\n+    when: use_apparmor == True\n     tags:\n       - section4\n       - section4.5\n@@ -41,6 +44,7 @@\n     register: aaenforce_rc\n     failed_when: aaenforce_rc.rc == 1\n     changed_when: False\n+    when: use_apparmor == True\n     tags:\n       - section4\n       - section4.5", "release": "2cfa28fd756194b32e320ab9c0df1e455f27dc38"}]}, {"repo": "threatstack/threatstack-ansible", "_Commit__release_start_at": "75580f72159e180dd1e97bbcf5870293a9ee5e36", "author_id": "MDQ6VXNlcjQ3ODc3MQ==", "author_name": "Aleksey Vazhnov", "committer_id": "MDQ6VXNlcjQ3ODc3MQ==", "committer_name": "Aleksey Vazhnov", "committer_email": "vazhnov@yandex.ru", "message": "Fixed issue #8 \u00abWrong template src path: templates/config.j2\u00bb", "sha": "75580f72159e180dd1e97bbcf5870293a9ee5e36", "url": "https://api.github.com/repos/threatstack/threatstack-ansible/commits/75580f72159e180dd1e97bbcf5870293a9ee5e36", "parents": ["c0a575a4d0d5cd8c461b6388abf28ee3a245fd42"], "files": [{"sha": "ec6906b48a9ef2a0fa72c0c4cfb4fc923e5a863f", "filename": "tasks/cloudsight_setup.yml", "previous_filename": null, "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/threatstack/threatstack-ansible/blob/75580f72159e180dd1e97bbcf5870293a9ee5e36/tasks/cloudsight_setup.yml", "raw_url": "https://github.com/threatstack/threatstack-ansible/raw/75580f72159e180dd1e97bbcf5870293a9ee5e36/tasks/cloudsight_setup.yml", "status": "modified", "patch": "@@ -6,7 +6,7 @@\n \n - name: Create ThreatStack Config File\n   template:\n-    src: templates/config.j2\n+    src: config.j2\n     dest: \"{{ threatstack_config }}\"\n     owner: root\n     group: root", "release": "75580f72159e180dd1e97bbcf5870293a9ee5e36"}]}, {"repo": "Capgemini/Apollo", "_Commit__release_start_at": "308889b1c7c114ab9079c9050ee083fffe5508be", "author_id": "MDQ6VXNlcjE2ODE4OTY=", "author_name": "Graham Taylor", "committer_id": "MDQ6VXNlcjE2ODE4OTY=", "committer_name": "Graham Taylor", "committer_email": "gtayzlor@gmail.com", "message": "Fix #251 - mesos redirect", "sha": "765922d0016d0b82ce5e514b36d0ac0bab7c1fe9", "url": "https://api.github.com/repos/Capgemini/Apollo/commits/765922d0016d0b82ce5e514b36d0ac0bab7c1fe9", "parents": ["35ca6852d9333ef6c3ed223239f45b840c487d60"], "files": [{"sha": "1da27989f0690e2b003596a83ca7852708ac9481", "filename": "roles/mesos/tasks/main.yml", "previous_filename": null, "additions": 21, "deletions": 24, "changes": 45, "blob_url": "https://github.com/Capgemini/Apollo/blob/765922d0016d0b82ce5e514b36d0ac0bab7c1fe9/roles/mesos/tasks/main.yml", "raw_url": "https://github.com/Capgemini/Apollo/raw/765922d0016d0b82ce5e514b36d0ac0bab7c1fe9/roles/mesos/tasks/main.yml", "status": "modified", "patch": "@@ -7,27 +7,14 @@\n   sudo: yes\n \n # Tasks for Master nodes\n-- name: remove mesos-master override\n-  file:\n-    path: /etc/init/mesos-master.override\n-    state: absent\n-  when: mesos_install_mode == \"master\"\n-\n-- name: start mesos-master (and enable it at boot)\n-  service:\n-    name: mesos-master\n-    state: started\n-    enabled: yes\n-  when: mesos_install_mode == \"master\"\n-\n - name: Set Mesos Master ip\n   copy:\n     content: \"{{mesos_local_address}}\"\n     dest: /etc/mesos-master/ip\n     mode: 0644\n   sudo: yes\n   notify:\n-    - Restart mesos master\n+    - restart mesos master\n   when: mesos_install_mode == \"master\"\n \n - name: Set Mesos Master hostname\n@@ -37,7 +24,7 @@\n     mode: 0644\n   sudo: yes\n   notify:\n-    - Restart mesos master\n+    - restart mesos master\n   when: mesos_install_mode == \"master\"\n \n   # The Mesos quorum value is based on the number of Mesos Masters. Take the\n@@ -51,7 +38,7 @@\n     mode: 0644\n   sudo: yes\n   notify:\n-    - Restart mesos master\n+    - restart mesos master\n   when: mesos_install_mode == \"master\"\n \n - name: Set Mesos Master Cluster name\n@@ -61,7 +48,7 @@\n     mode: 0644\n   sudo: yes\n   notify:\n-    - Restart mesos master\n+    - restart mesos master\n   when: mesos_install_mode == \"master\"\n \n - name: Set Mesos Master consul service definition\n@@ -73,6 +60,14 @@\n     - Restart consul\n   when: mesos_install_mode == \"master\"\n \n+- name: remove mesos-master override\n+  file:\n+    path: /etc/init/mesos-master.override\n+    state: absent\n+  notify:\n+    - restart mesos master\n+  when: mesos_install_mode == \"master\"\n+\n - name: start mesos-master (and enable it at boot)\n   service:\n     name: mesos-master\n@@ -85,6 +80,8 @@\n   file:\n     path: /etc/init/mesos-slave.override\n     state: absent\n+  notify:\n+    - restart mesos slave\n   when: mesos_install_mode == \"slave\"\n \n - name: Set Mesos Slave hostname\n@@ -94,7 +91,7 @@\n     mode: 0644\n   sudo: yes\n   notify:\n-    - Restart mesos slave\n+    - restart mesos slave\n   when: mesos_install_mode == \"slave\"\n \n - name: set executor registration timeout\n@@ -103,7 +100,7 @@\n     dest: /etc/mesos-slave/executor_registration_timeout\n     content: \"{{ mesos_executor_registration_timeout }}\"\n   notify:\n-    - Restart mesos slave\n+    - restart mesos slave\n   when: mesos_install_mode == \"slave\"\n \n - name: set containerizers\n@@ -112,7 +109,7 @@\n     dest: /etc/mesos-slave/containerizers\n     content: \"{{ mesos_containerizers }}\"\n   notify:\n-    - Restart mesos slave\n+    - restart mesos slave\n   when: mesos_install_mode == \"slave\"\n \n - name: set slave resources\n@@ -121,7 +118,7 @@\n     dest: /etc/mesos-slave/resources\n     content: \"{{ mesos_resources }}\"\n   notify:\n-    - Restart mesos slave\n+    - restart mesos slave\n   when: mesos_install_mode == \"slave\"\n \n - name: Set Mesos Slave ip\n@@ -131,7 +128,7 @@\n     mode: 0644\n   sudo: yes\n   notify:\n-    - Restart mesos slave\n+    - restart mesos slave\n   when: mesos_install_mode == \"slave\"\n \n - name: Create Mesos Slave work area\n@@ -141,7 +138,7 @@\n     state: directory\n   sudo: yes\n   notify:\n-    - Restart mesos slave\n+    - restart mesos slave\n   when: mesos_install_mode == \"slave\"\n \n - name: Set Mesos Slave work area\n@@ -151,7 +148,7 @@\n     mode: 0644\n   sudo: yes\n   notify:\n-    - Restart mesos slave\n+    - restart mesos slave\n   when: mesos_install_mode == \"slave\"\n \n - name: start mesos-slave (and enable it at boot)", "release": "308889b1c7c114ab9079c9050ee083fffe5508be"}, {"sha": "d2548eb500ff0fb50a6f7ecb57ce132a706a1935", "filename": "roles/mesos/handlers/main.yml", "previous_filename": null, "additions": 4, "deletions": 4, "changes": 8, "blob_url": "https://github.com/Capgemini/Apollo/blob/765922d0016d0b82ce5e514b36d0ac0bab7c1fe9/roles/mesos/handlers/main.yml", "raw_url": "https://github.com/Capgemini/Apollo/raw/765922d0016d0b82ce5e514b36d0ac0bab7c1fe9/roles/mesos/handlers/main.yml", "status": "modified", "patch": "@@ -1,24 +1,24 @@\n ---\n # handlers file for mesos\n-- name: Start mesos master\n+- name: start mesos master\n   sudo: yes\n   service:\n     name: mesos-master\n     state: started\n \n-- name: Start mesos slave\n+- name: start mesos slave\n   sudo: yes\n   service:\n     name: mesos-slave\n     state: started\n \n-- name: Restart mesos master\n+- name: restart mesos master\n   sudo: yes\n   service:\n     name: mesos-master\n     state: restarted\n \n-- name: Restart mesos slave\n+- name: restart mesos slave\n   sudo: yes\n   service:\n     name: mesos-slave", "release": "308889b1c7c114ab9079c9050ee083fffe5508be"}]}, {"repo": "Capgemini/Apollo", "_Commit__release_start_at": "308889b1c7c114ab9079c9050ee083fffe5508be", "author_id": "MDQ6VXNlcjE2ODE4OTY=", "author_name": "Graham Taylor", "committer_id": "MDQ6VXNlcjE2ODE4OTY=", "committer_name": "Graham Taylor", "committer_email": "gtayzlor@gmail.com", "message": "Fix #278 - Lookup consul server variable dynamically by looking in the groups for the current host", "sha": "f006ca12b82e1e1bc2370b227f41655c42c4c846", "url": "https://api.github.com/repos/Capgemini/Apollo/commits/f006ca12b82e1e1bc2370b227f41655c42c4c846", "parents": ["bf6e08dcb2440421477b6536ff6a8d11adc2be17"], "files": [{"sha": "8bf9bd16e3a7cb3760910ed7cbcc3fba1c40522b", "filename": "roles/consul/defaults/main.yml", "previous_filename": null, "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/Capgemini/Apollo/blob/f006ca12b82e1e1bc2370b227f41655c42c4c846/roles/consul/defaults/main.yml", "raw_url": "https://github.com/Capgemini/Apollo/raw/f006ca12b82e1e1bc2370b227f41655c42c4c846/roles/consul/defaults/main.yml", "status": "modified", "patch": "@@ -1,6 +1,5 @@\n ---\n # defaults file for consul\n-consul_is_server: no\n consul_dc: dc1\n consul_servers_group: consul_servers\n consul_advertise: \"{{ inventory_hostname }}\"", "release": "308889b1c7c114ab9079c9050ee083fffe5508be"}]}, {"repo": "awailly/cis-ubuntu-ansible", "_Commit__release_start_at": "2cfa28fd756194b32e320ab9c0df1e455f27dc38", "author_id": "MDQ6VXNlcjk3MTc1NQ==", "author_name": "Aur\u00e9lien Wailly", "committer_id": "MDQ6VXNlcjk3MTc1NQ==", "committer_name": "Aur\u00e9lien Wailly", "committer_email": "aurelien.wailly@gmail.com", "message": "Fixes #43\n\n- Following @pchaigno suggestion on min version\n- Add verbose coveralls", "sha": "4d782f54f0661f79e14b84440e03f056faf6c19d", "url": "https://api.github.com/repos/awailly/cis-ubuntu-ansible/commits/4d782f54f0661f79e14b84440e03f056faf6c19d", "parents": ["c91b6076e3a957fb0a165131d0ff3b3b208ed419"], "files": [{"sha": "784755e471f37e62cdec644058d15eba17d4268d", "filename": "meta/main.yml", "previous_filename": null, "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/awailly/cis-ubuntu-ansible/blob/4d782f54f0661f79e14b84440e03f056faf6c19d/meta/main.yml", "raw_url": "https://github.com/awailly/cis-ubuntu-ansible/raw/4d782f54f0661f79e14b84440e03f056faf6c19d/meta/main.yml", "status": "modified", "patch": "@@ -7,7 +7,7 @@ galaxy_info:\n   author: Aur\u00e9lien Wailly\n   description: Ansible role to meet CIS (Center for Internet Security) requirements on ubuntu\n   license: GPLv2\n-  min_ansible_version: 1.6\n+  min_ansible_version: 1.9.0.1\n   platforms:\n     - name: Ubuntu\n       versions:", "release": "2cfa28fd756194b32e320ab9c0df1e455f27dc38"}]}, {"repo": "awailly/cis-ubuntu-ansible", "_Commit__release_start_at": "2cfa28fd756194b32e320ab9c0df1e455f27dc38", "author_id": "MDQ6VXNlcjk3MTc1NQ==", "author_name": "Aur\u00e9lien Wailly", "committer_id": "MDQ6VXNlcjk3MTc1NQ==", "committer_name": "Aur\u00e9lien Wailly", "committer_email": "aurelien.wailly@gmail.com", "message": "Fix #60\n\n- Add dedicated tests for separate partitions\n- Beware that partitions may be mounted differently, such as systemd\n  handling /tmp", "sha": "171ec49fe7ca7352d0a35c39529ec28ce947bfb2", "url": "https://api.github.com/repos/awailly/cis-ubuntu-ansible/commits/171ec49fe7ca7352d0a35c39529ec28ce947bfb2", "parents": ["1bb50a6149f6ff7f2e6399411418d088e2c52d01"], "files": [{"sha": "7c1e87f87eb24da142c0d556bf5fa905c1014b76", "filename": "tasks/section_02_level1.yml", "previous_filename": null, "additions": 28, "deletions": 6, "changes": 34, "blob_url": "https://github.com/awailly/cis-ubuntu-ansible/blob/171ec49fe7ca7352d0a35c39529ec28ce947bfb2/tasks/section_02_level1.yml", "raw_url": "https://github.com/awailly/cis-ubuntu-ansible/raw/171ec49fe7ca7352d0a35c39529ec28ce947bfb2/tasks/section_02_level1.yml", "status": "modified", "patch": "@@ -1,7 +1,11 @@\n ---\n \n   - name: 2.1 Create Separate Partition for /tmp (Scored)\n-    debug: msg=\"/!\\ Ensure there is a separate partition dedicated to /tmp\"\n+    command: grep '\\s/tmp\\s' /etc/fstab\n+    register: tmp_partition\n+    failed_when: tmp_partition.rc == 1\n+    changed_when: tmp_partition.rc == 1\n+    ignore_errors: True\n     tags:\n       - section2\n       - section2.1\n@@ -16,7 +20,11 @@\n       - section2.4\n \n   - name: 2.5 Create Separate Partition for /var (Scored)\n-    debug: msg=\"/!\\ Ensure there is a separate partition dedicated to /var\"\n+    command: grep '\\s/var\\s' /etc/fstab\n+    register: var_partition\n+    failed_when: var_partition.rc == 1\n+    changed_when: var_partition.rc == 1\n+    ignore_errors: True\n     tags:\n       - section2\n       - section2.5\n@@ -29,19 +37,31 @@\n       - section2.6\n \n   - name: 2.7 Create Separate Partition for /var/log (Scored)\n-    debug: msg=\"/!\\ Ensure there is a separate partition dedicated to /var/log\"\n+    command: grep '\\s/var\\/log\\s' /etc/fstab\n+    register: var_log_partition\n+    failed_when: var_log_partition.rc == 1\n+    changed_when: var_log_partition.rc == 1\n+    ignore_errors: True\n     tags:\n       - section2\n       - section2.7\n \n   - name: 2.8 Create Separate Partition for /var/log/audit (Scored)\n-    debug: msg=\"/!\\ Ensure there is a separate partition dedicated to /var/log/audit\"\n+    command: grep '\\s/var\\/log\\/audit\\s' /etc/fstab\n+    register: var_log_audit_partition\n+    failed_when: var_log_audit_partition.rc == 1\n+    changed_when: var_log_audit_partition.rc == 1\n+    ignore_errors: True\n     tags:\n       - section2\n       - section2.8\n \n   - name: 2.9 Create Separate Partition for /home (Scored)\n-    debug: msg=\"/!\\ Ensure there is a separate partition dedicated to /home\"\n+    command: grep '\\s/home\\s' /etc/fstab\n+    register: home_partition\n+    failed_when: home_partition.rc == 1\n+    changed_when: home_partition.rc == 1\n+    ignore_errors: True\n     tags:\n       - section2\n       - section2.9\n@@ -92,7 +112,9 @@\n       - section2.17.1\n \n   - name: 2.17.2 Set Sticky Bit on All World-Writable Directories (Scored)\n-    file: path='{{ item }}' mode=\"a+t\"\n+    file:\n+        path: \"{{ item }}\"\n+        mode: \"a+t\"\n     with_items: sticky_bit_dirs.stdout_lines\n     tags:\n       - section2", "release": "2cfa28fd756194b32e320ab9c0df1e455f27dc38"}]}, {"repo": "awailly/cis-ubuntu-ansible", "_Commit__release_start_at": "2cfa28fd756194b32e320ab9c0df1e455f27dc38", "author_id": "MDQ6VXNlcjk3MTc1NQ==", "author_name": "Aur\u00e9lien Wailly", "committer_id": "MDQ6VXNlcjk3MTc1NQ==", "committer_name": "Aur\u00e9lien Wailly", "committer_email": "aurelien.wailly@gmail.com", "message": "Resolve #2\n\n- The current version of aa-tools in Trusty is 2.8.x, and the fix is\n  available in version >2.9. Using a manual loop do the trick and give\n  the same result.\n\n- Tested on 14.04", "sha": "9662c15ce2e4260fac5cc2bfdf5aaaaf0a2191dd", "url": "https://api.github.com/repos/awailly/cis-ubuntu-ansible/commits/9662c15ce2e4260fac5cc2bfdf5aaaaf0a2191dd", "parents": ["59bde5ac149cca3058d0b8a8bd4b2d0e21e8c861"], "files": [{"sha": "3f1e9020aed99a681e97f29edda9cac313d192d5", "filename": "tasks/section_04_level2.yml", "previous_filename": null, "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/awailly/cis-ubuntu-ansible/blob/9662c15ce2e4260fac5cc2bfdf5aaaaf0a2191dd/tasks/section_04_level2.yml", "raw_url": "https://github.com/awailly/cis-ubuntu-ansible/raw/9662c15ce2e4260fac5cc2bfdf5aaaaf0a2191dd/tasks/section_04_level2.yml", "status": "modified", "patch": "@@ -36,7 +36,8 @@\n       - section4.5\n \n   - name: 4.5 Activate AppArmor (enforce) (Scored)\n-    shell: 'aa-enforce /etc/apparmor.d/*'\n+    #shell: 'aa-enforce /etc/apparmor.d/*'\n+    shell: for profile in /etc/apparmor.d/*; do aa-enforce $profile; done\n     register: aaenforce_rc\n     failed_when: aaenforce_rc.rc == 1\n     changed_when: False", "release": "2cfa28fd756194b32e320ab9c0df1e455f27dc38"}]}, {"repo": "Capgemini/Apollo", "_Commit__release_start_at": "308889b1c7c114ab9079c9050ee083fffe5508be", "author_id": "MDQ6VXNlcjE2ODE4OTY=", "author_name": "Graham Taylor", "committer_id": "MDQ6VXNlcjE2ODE4OTY=", "committer_name": "Graham Taylor", "committer_email": "gtayzlor@gmail.com", "message": "Fix #342 - Weave network instability", "sha": "575c54fc21299154b7157de9f10c9072600dc993", "url": "https://api.github.com/repos/Capgemini/Apollo/commits/575c54fc21299154b7157de9f10c9072600dc993", "parents": ["af3dfdf7cf37437f5609f1a12e4ac7cbaebd4867"], "files": [{"sha": "ae111af148b114fe2029d9cf39517cfb5f260941", "filename": "roles/weave/defaults/main.yml", "previous_filename": null, "additions": 7, "deletions": 1, "changes": 8, "blob_url": "https://github.com/Capgemini/Apollo/blob/575c54fc21299154b7157de9f10c9072600dc993/roles/weave/defaults/main.yml", "raw_url": "https://github.com/Capgemini/Apollo/raw/575c54fc21299154b7157de9f10c9072600dc993/roles/weave/defaults/main.yml", "status": "modified", "patch": "@@ -1,6 +1,12 @@\n ---\n # defaults file for weave\n-weave_bridge: \"10.2.0.1/16\"\n+weave_bridge: \"\n+    {%- for host in groups[weave_server_group] -%}\n+      {%- if host == 'default' or host == inventory_hostname or host == ansible_fqdn or host in ansible_all_ipv4_addresses -%}\n+        10.2.0.{{ loop.index }}/16\n+      {%- endif -%}\n+    {%- endfor -%}\n+\"\n weave_server_group: weave_servers\n weave_docker_subnet: \"\n     {%- for host in groups[weave_server_group] -%}", "release": "308889b1c7c114ab9079c9050ee083fffe5508be"}]}, {"repo": "StackStorm/ansible-st2", "_Commit__release_starts_at": null, "_Commit__release_ends_at": "c9fae17a7c09d2ca31d2d2605ed6da4ac8d37d67", "author_id": "MDQ6VXNlcjE1MzM4MTg=", "author_name": "Eugen C", "committer_id": "MDQ6VXNlcjE5ODY0NDQ3", "committer_name": "GitHub", "committer_email": "noreply@github.com", "message": "Fixes #49: Switch to MongoDB 3.2 packages (#51)\n\nSwitch to MongoDB 3.2 packages", "sha": "653985572c29134e32a2107aacf76d49f360e8cc", "url": "https://api.github.com/repos/StackStorm/ansible-st2/commits/653985572c29134e32a2107aacf76d49f360e8cc", "parents": ["3b115b4dc2162b35c18ab751c8343a95c31caec5", "3f468b193396b59d81164aea903bdcc51fd46000"], "files": [{"sha": "af9fa111d4db53fae325b9c604bb68b5f2234bab", "filename": "roles/mongodb/tasks/main.yml", "previous_filename": null, "additions": 20, "deletions": 5, "changes": 25, "blob_url": "https://github.com/StackStorm/ansible-st2/blob/653985572c29134e32a2107aacf76d49f360e8cc/roles/mongodb/tasks/main.yml", "raw_url": "https://github.com/StackStorm/ansible-st2/raw/653985572c29134e32a2107aacf76d49f360e8cc/roles/mongodb/tasks/main.yml", "status": "modified", "patch": "@@ -1,8 +1,23 @@\n-- name: Install dependencies\n-  sudo: true\n+---\n+- name: Add mongodb key\n+  sudo: yes\n+  apt_key:\n+    url: https://www.mongodb.org/static/pgp/server-3.2.asc\n+    id: 42F3E95A2C4F08279C4960ADD68FA50FEA312927\n+    state: present\n+  tags: [databases, mongodb]\n+\n+- name: Add mongodb repository\n+  sudo: yes\n+  apt_repository:\n+    repo: 'deb http://repo.mongodb.org/apt/{{ ansible_distribution|lower }} {{ ansible_distribution_release|lower }}/mongodb-org/3.2 multiverse'\n+    state: present\n+  tags: [databases, mongodb]\n+\n+- name: Install mongodb\n+  sudo: yes\n   apt:\n-    name: \"{{ item }}\"\n+    name: mongodb-org\n     update_cache: yes\n     state: present\n-  with_items:\n-    - mongodb-server\n+  tags: [databases, mongodb]", "release_starts_at": null, "release_ends_at": "c9fae17a7c09d2ca31d2d2605ed6da4ac8d37d67"}], "release_starts_at": "653985572c29134e32a2107aacf76d49f360e8cc"}, {"repo": "Capgemini/Apollo", "_Commit__release_start_at": "308889b1c7c114ab9079c9050ee083fffe5508be", "author_id": "MDQ6VXNlcjE2ODE4OTY=", "author_name": "Graham Taylor", "committer_id": "MDQ6VXNlcjE2ODE4OTY=", "committer_name": "Graham Taylor", "committer_email": "gtayzlor@gmail.com", "message": "Fix #662 - error on reload systemd", "sha": "308889b1c7c114ab9079c9050ee083fffe5508be", "url": "https://api.github.com/repos/Capgemini/Apollo/commits/308889b1c7c114ab9079c9050ee083fffe5508be", "parents": ["23dde94de0a1355bc5a9d83fb2d424f136f05fa2"], "files": [{"sha": "0ce1d5b79cc8a7ee8b6cb1b101e9f3995bb31136", "filename": "roles/weave/tasks/main.yml", "previous_filename": null, "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Capgemini/Apollo/blob/308889b1c7c114ab9079c9050ee083fffe5508be/roles/weave/tasks/main.yml", "raw_url": "https://github.com/Capgemini/Apollo/raw/308889b1c7c114ab9079c9050ee083fffe5508be/roles/weave/tasks/main.yml", "status": "modified", "patch": "@@ -24,7 +24,7 @@\n     - src: weaveproxy.service.j2\n       dest: /etc/systemd/system/weaveproxy.service\n   notify:\n-    - systemd reload\n+    - reload systemd\n     - restart weave\n     - restart weaveproxy\n   tags:", "release": "308889b1c7c114ab9079c9050ee083fffe5508be"}]}, {"repo": "nusenu/ansible-relayor", "_Commit__release_start_at": "1224adf2811c827a09ff0bf133fbb476901a547d", "author_id": null, "author_name": "nusenu", "committer_id": null, "committer_name": "nusenu", "committer_email": "nusenu@openmailbox.org", "message": "Fedora: make use of systemd hardening features (also fixes #53 with RestartSec=1, thanks to Jamie Nguyen)", "sha": "2149edf99fe1c251d0eaad5c78536c9b1d54dde3", "url": "https://api.github.com/repos/nusenu/ansible-relayor/commits/2149edf99fe1c251d0eaad5c78536c9b1d54dde3", "parents": ["df06f3c3304c3f73f740d444222642fbad41bebb"], "files": [{"sha": "52ea222a49ca8c3a688c20c74e90922416a662a1", "filename": "tasks/dnf_install.yml", "previous_filename": null, "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/nusenu/ansible-relayor/blob/2149edf99fe1c251d0eaad5c78536c9b1d54dde3/tasks/dnf_install.yml", "raw_url": "https://github.com/nusenu/ansible-relayor/raw/2149edf99fe1c251d0eaad5c78536c9b1d54dde3/tasks/dnf_install.yml", "status": "modified", "patch": "@@ -30,7 +30,7 @@\n \n - name: Ensure the presence of the multi-instance systemd unit file (Fedora)\n   become: yes\n-  copy: src=centos_tor@.service dest=/lib/systemd/system/tor@.service owner=root mode=0644 backup=yes setype=tor_unit_file_t\n+  copy: src=fedora_tor@.service dest=/lib/systemd/system/tor@.service owner=root mode=0644 backup=yes setype=tor_unit_file_t\n   notify: systemctl daemon-reload\n \n - name: Ensure SELinux boolean (tor_can_network_relay) is set appropriately (Fedora)", "release": "1224adf2811c827a09ff0bf133fbb476901a547d"}]}, {"repo": "ansiblebit/oracle-java", "_Commit__release_starts_at": null, "_Commit__release_ends_at": "7e4facb9477ad92d61bc998d4118eba4283b0a3d", "author_id": "MDQ6VXNlcjE2NDM5NjI=", "author_name": "Roman Belyakovsky", "committer_id": "MDQ6VXNlcjE2NDM5NjI=", "committer_name": "Roman Belyakovsky", "committer_email": "ihryamzik@gmail.com", "message": "Implemented rpm search on oracle site, fixes #34", "sha": "617c8f2de47d53b11ebed60c6cdfe7d020a120a7", "url": "https://api.github.com/repos/ansiblebit/oracle-java/commits/617c8f2de47d53b11ebed60c6cdfe7d020a120a7", "parents": ["15d2da095f9bd54a50954dee18597710e1951943"], "files": [{"sha": "a5b12183139d611caa6869538a88433d5a3f7658", "filename": "tasks/redhat/main.yml", "previous_filename": null, "additions": 43, "deletions": 0, "changes": 43, "blob_url": "https://github.com/ansiblebit/oracle-java/blob/617c8f2de47d53b11ebed60c6cdfe7d020a120a7/tasks/redhat/main.yml", "raw_url": "https://github.com/ansiblebit/oracle-java/raw/617c8f2de47d53b11ebed60c6cdfe7d020a120a7/tasks/redhat/main.yml", "status": "modified", "patch": "@@ -4,6 +4,49 @@\n # Task file to install Oracle Java Development Kit in a system with a Redhat based Linux distribution.\n #\n \n+- name: get latest JDK download page\n+  uri:\n+    url: http://www.oracle.com/technetwork/java/javase/downloads/index.html\n+    return_content: yes\n+  register: result\n+\n+- name: determine latest java download page and version\n+  set_fact: latest_java_page_and_version=\"{{ (result.content.replace('\\n','')|regex_replace('.*(/technetwork/java/javase/downloads/jdk(\\d+)-downloads.*?.html).*', 'http://www.oracle.com/\\1\\n\\2')).split('\\n') }}\"\n+\n+- name: define download page URL based on latest version\n+  set_fact: download_page_url=\"{{ latest_java_page_and_version[0] }}\"\n+  when: \"{{ latest_java_page_and_version[1]|version_compare(oracle_java_version,'=') }}\"\n+  \n+- block:\n+  \n+  - name: get lastest JDK rpm url\n+    uri: url=\"{{ result.content.replace('\\n','')|regex_replace('.*(/technetwork/java/javase/archive-.*?.html).*','http://www.oracle.com/\\1') }}\"\n+         return_content=yes\n+    register: result\n+    \n+  - name: define download page URL for \"{{ oracle_java_version }}\"\n+    set_fact: download_page_url=\"{{ result.content|regex_search('href=\\\"[^\\\"]+\\\">Java SE\\s+' + (oracle_java_version|string) + '\\s?<')|regex_replace('.*href=\\\"([^\\\"]+)\\\".*','http://www.oracle.com/\\1') }}\"\n+  \n+  when: \"{{ latest_java_page_and_version[1]|version_compare(oracle_java_version,'!=') and oracle_java_version }}\"\n+\n+- name: show download page URL\n+  debug: msg=\"{{ download_page_url }}\"\n+\n+- name: get lastest JDK rpm url\n+  uri: url=\"{{ download_page_url }}\"\n+       return_content=yes\n+  register: result\n+\n+- name: set oracle_java_rpm_url\n+  set_fact: oracle_java_rpm_url=\"{{ result.content|regex_search('https?://download.oracle.com/.*?/jdk-\\w+-linux-' + oracle_java_ansible_arch_mappings[ansible_architecture] + '.rpm') }}\"\n+\n+- name: set some variables\n+  set_fact: oracle_java_rpm_filename=\"{{ oracle_java_rpm_url | basename }}\"\n+            oracle_java_version=\"{{ oracle_java_rpm_url | basename|regex_replace('jdk-(\\d+)u(\\d+)-linux.*','\\1') }}\"\n+            oracle_java_version_update=\"{{ oracle_java_rpm_url | basename|regex_replace('jdk-(\\d+)u(\\d+)-linux.*','\\2') }}\"\n+\n+- debug: msg=\"Downloading java {{ oracle_java_version }}u{{ oracle_java_version_update }} to {{ oracle_java_rpm_filename }} from {{ oracle_java_rpm_url }}\"\n+\n - name: download Java RPM\n   get_url:\n     headers='Cookie:gpw_e24=http%3A%2F%2Fwww.oracle.com%2F; oraclelicense=accept-securebackup-cookie'    dest=\"{{ oracle_java_dir_source }}/{{ oracle_java_rpm_filename }}\"", "release_starts_at": null, "release_ends_at": "7e4facb9477ad92d61bc998d4118eba4283b0a3d"}], "release_starts_at": "617c8f2de47d53b11ebed60c6cdfe7d020a120a7"}, {"repo": "awailly/cis-ubuntu-ansible", "_Commit__release_start_at": "2cfa28fd756194b32e320ab9c0df1e455f27dc38", "author_id": "MDQ6VXNlcjk3MTc1NQ==", "author_name": "Aur\u00e9lien Wailly", "committer_id": "MDQ6VXNlcjk3MTc1NQ==", "committer_name": "Aur\u00e9lien Wailly", "committer_email": "aurelien.wailly@gmail.com", "message": "Fix #66\n\nCopy-paste gone bad. Fixed thanks to @csikman.", "sha": "b20218eaea389bbb1c05a900fdda745ea61d8690", "url": "https://api.github.com/repos/awailly/cis-ubuntu-ansible/commits/b20218eaea389bbb1c05a900fdda745ea61d8690", "parents": ["1818facd0a58a2b42203a403130b71825b960653"], "files": [{"sha": "5db3ab6d07aef9878d52305772f2dcf9af678795", "filename": "tasks/section_12_level1.yml", "previous_filename": null, "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/awailly/cis-ubuntu-ansible/blob/b20218eaea389bbb1c05a900fdda745ea61d8690/tasks/section_12_level1.yml", "raw_url": "https://github.com/awailly/cis-ubuntu-ansible/raw/b20218eaea389bbb1c05a900fdda745ea61d8690/tasks/section_12_level1.yml", "status": "modified", "patch": "@@ -54,7 +54,7 @@\n       - section12.7\n \n   - name: 12.8 Find Un-owned Files and Directories (check) (Scored)\n-    shell: df --local -P | awk {'if (NR!=1) print $6'} | xargs -I '{}' find '{}' -xdev -nogroup -ls\n+    shell: df --local -P | awk {'if (NR!=1) print $6'} | xargs -I '{}' find '{}' -xdev -nouser -ls\n     changed_when: False\n     failed_when: False\n     register: unowned_files", "release": "2cfa28fd756194b32e320ab9c0df1e455f27dc38"}]}, {"repo": "brianshumate/ansible-consul", "_Commit__release_starts_at": null, "_Commit__release_ends_at": "6f2fdbaf6a98476a156102c6215391a09c3e6a42", "author_id": "MDQ6VXNlcjEwNjcxNTU5", "author_name": "Bas Meijer", "committer_id": "MDQ6VXNlcjEwNjcxNTU5", "committer_name": "Bas Meijer", "committer_email": "bas.meijer@me.com", "message": "Fix for #256 Consul not reloaded when TLS files change.", "sha": "2d322855b30a749b9a180331af2500e834e7155d", "url": "https://api.github.com/repos/brianshumate/ansible-consul/commits/2d322855b30a749b9a180331af2500e834e7155d", "parents": ["53f9bc7e6a098557bf13ade27a1ec9206a39708c"], "files": [{"sha": "1deacc3ec3bdd440336d9d7676f550069d0493aa", "filename": "tasks/tls.yml", "previous_filename": null, "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/brianshumate/ansible-consul/blob/2d322855b30a749b9a180331af2500e834e7155d/tasks/tls.yml", "raw_url": "https://github.com/brianshumate/ansible-consul/raw/2d322855b30a749b9a180331af2500e834e7155d/tasks/tls.yml", "status": "modified", "patch": "@@ -18,6 +18,7 @@\n         owner: \"{{ consul_user }}\"\n         group: \"{{ consul_group }}\"\n         mode: 0644\n+      notify: restart consul\n \n     - name: Copy server certificate\n       copy:\n@@ -27,6 +28,7 @@\n         owner: \"{{ consul_user }}\"\n         group: \"{{ consul_group }}\"\n         mode: 0644\n+      notify: restart consul\n \n     - name: Copy server key\n       copy:\n@@ -36,5 +38,6 @@\n         owner: \"{{ consul_user }}\"\n         group: \"{{ consul_group }}\"\n         mode: 0600\n+      notify: restart consul\n \n   when: consul_tls_copy_keys | bool", "release_starts_at": null, "release_ends_at": "6f2fdbaf6a98476a156102c6215391a09c3e6a42"}], "release_starts_at": "47eb83c431cc68262d286df231c98c0a927b1e8a"}, {"repo": "awailly/cis-ubuntu-ansible", "_Commit__release_start_at": "2cfa28fd756194b32e320ab9c0df1e455f27dc38", "author_id": "MDQ6VXNlcjk3MTc1NQ==", "author_name": "Aur\u00e9lien Wailly", "committer_id": "MDQ6VXNlcjk3MTc1NQ==", "committer_name": "Aur\u00e9lien Wailly", "committer_email": "aurelien.wailly@gmail.com", "message": "Fix #13 with double quoting\n\nThe {{ item }} variable is double quoted escaped, thus we need to escape them with double quotes for proper display.", "sha": "0489c6a0c69bbe0a361aa753bc22972f6cea6441", "url": "https://api.github.com/repos/awailly/cis-ubuntu-ansible/commits/0489c6a0c69bbe0a361aa753bc22972f6cea6441", "parents": ["e90eac100980db35187b1c8829e3284cc5db3e30"], "files": [{"sha": "9fcc07fae0acf7b39eef728b3f9208f6f113e5d2", "filename": "tasks/section_12_level1.yml", "previous_filename": null, "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/awailly/cis-ubuntu-ansible/blob/0489c6a0c69bbe0a361aa753bc22972f6cea6441/tasks/section_12_level1.yml", "raw_url": "https://github.com/awailly/cis-ubuntu-ansible/raw/0489c6a0c69bbe0a361aa753bc22972f6cea6441/tasks/section_12_level1.yml", "status": "modified", "patch": "@@ -46,7 +46,7 @@\n       - section12.7\n \n   - name: 12.7 Find World Writable Files (Not Scored)\n-    debug: msg='{{ item }}'\n+    debug: msg=\"{{ item }}\"\n     with_items:\n         world_files.stdout_lines\n     tags:\n@@ -98,7 +98,7 @@\n       - section12.10\n \n   - name: 12.10 Find SUID System Executables (Not Scored)\n-    debug: msg='{{ item }}'\n+    debug: msg=\"{{ item }}\"\n     with_items:\n         suid_files.stdout_lines\n     tags:\n@@ -115,7 +115,7 @@\n       - section12.11\n \n   - name: 12.11 Find SGID System Executables (Not Scored)\n-    debug: msg='{{ item }}'\n+    debug: msg=\"{{ item }}\"\n     with_items:\n         gsuid_files.stdout_lines\n     tags:", "release": "2cfa28fd756194b32e320ab9c0df1e455f27dc38"}]}, {"repo": "Capgemini/Apollo", "_Commit__release_start_at": "308889b1c7c114ab9079c9050ee083fffe5508be", "author_id": "MDQ6VXNlcjE2ODE4OTY=", "author_name": "Graham Taylor", "committer_id": "MDQ6VXNlcjE2ODE4OTY=", "committer_name": "Graham Taylor", "committer_email": "gtayzlor@gmail.com", "message": "Fix #101 - Add serverspec test harness that can be run in the vagrant\nbox", "sha": "7984d52dda17244484d7205285403e94e38c0a73", "url": "https://api.github.com/repos/Capgemini/Apollo/commits/7984d52dda17244484d7205285403e94e38c0a73", "parents": ["069c7c7848545c132aff3c88fe170cbe30c8abb9"], "files": [{"sha": "ca18a240a92dff966b9605d5c6edefc85a7f5a49", "filename": "roles/zookeeper/tasks/main.yml", "previous_filename": null, "additions": 6, "deletions": 1, "changes": 7, "blob_url": "https://github.com/Capgemini/Apollo/blob/7984d52dda17244484d7205285403e94e38c0a73/roles/zookeeper/tasks/main.yml", "raw_url": "https://github.com/Capgemini/Apollo/raw/7984d52dda17244484d7205285403e94e38c0a73/roles/zookeeper/tasks/main.yml", "status": "modified", "patch": "@@ -1,6 +1,11 @@\n+- name: ensure zookeeper is running (and enable it at boot)\n+  service: name=zookeeper state=started enabled=yes\n+\n - name: Create zookeeper config file\n   template: src=zoo.cfg.j2 dest=/etc/zookeeper/conf/zoo.cfg\n   sudo: yes\n+  notify:\n+    - Restart zookeeper\n \n - name: Create zookeeper myid file\n   copy:\n@@ -9,7 +14,7 @@\n     mode: 0644\n   sudo: yes\n   notify:\n-    - Start zookeeper\n+    - Restart zookeeper\n \n - name: Set Zookeeper consul service definition\n   sudo: yes", "release": "308889b1c7c114ab9079c9050ee083fffe5508be"}, {"sha": "156b39c473edadf172419d6da18876a89382d770", "filename": "roles/mesos/tasks/main.yml", "previous_filename": null, "additions": 34, "deletions": 11, "changes": 45, "blob_url": "https://github.com/Capgemini/Apollo/blob/7984d52dda17244484d7205285403e94e38c0a73/roles/mesos/tasks/main.yml", "raw_url": "https://github.com/Capgemini/Apollo/raw/7984d52dda17244484d7205285403e94e38c0a73/roles/mesos/tasks/main.yml", "status": "modified", "patch": "@@ -4,12 +4,22 @@\n   sudo: yes\n \n # Tasks for Master nodes\n+- name: remove mesos-master override\n+  file: path=/etc/init/mesos-master.override state=absent\n+  when: mesos_install_mode == \"master\"\n+\n+- name: start mesos-master (and enable it at boot)\n+  service: name=mesos-master state=started enabled=yes\n+  when: mesos_install_mode == \"master\"\n+\n - name: Set Mesos Master ip\n   copy:\n     content: \"{{mesos_local_address}}\"\n     dest: /etc/mesos-master/ip\n     mode: 0644\n   sudo: yes\n+  notify:\n+    - Restart mesos master\n   when: mesos_install_mode == \"master\"\n \n - name: Set Mesos Master hostname\n@@ -18,6 +28,8 @@\n     dest: /etc/mesos-master/hostname\n     mode: 0644\n   sudo: yes\n+  notify:\n+    - Restart mesos master\n   when: mesos_install_mode == \"master\"\n \n   # The Mesos quorum value is based on the number of Mesos Masters. Take the\n@@ -27,10 +39,8 @@\n - name: Set Mesos Master quorum count\n   template: src=quorum.j2 dest=/etc/mesos-master/quorum mode=0644\n   sudo: yes\n-  when: mesos_install_mode == \"master\"\n-\n-- name: remove mesos-master override\n-  file: path=/etc/init/mesos-master.override state=absent\n+  notify:\n+    - Restart mesos master\n   when: mesos_install_mode == \"master\"\n \n - name: Set Mesos Master Cluster name\n@@ -40,7 +50,7 @@\n     mode: 0644\n   sudo: yes\n   notify:\n-    - Start mesos master\n+    - Restart mesos master\n   when: mesos_install_mode == \"master\"\n \n - name: Set Mesos Master consul service definition\n@@ -53,37 +63,45 @@\n   when: mesos_install_mode == \"master\"\n \n # Tasks for Slave nodes\n+- name: remove mesos-slave override\n+  file: path=/etc/init/mesos-slave.override state=absent\n+  when: mesos_install_mode == \"slave\"\n+\n - name: Set Mesos Slave hostname\n   copy:\n     content: \"{{mesos_local_address}}\"\n     dest: /etc/mesos-slave/hostname\n     mode: 0644\n   sudo: yes\n-  when: mesos_install_mode == \"slave\"\n-\n-- name: remove mesos-slave override\n-  file: path=/etc/init/mesos-slave.override state=absent\n+  notify:\n+    - Restart mesos slave\n   when: mesos_install_mode == \"slave\"\n \n - name: set executor registration timeout\n   sudo: yes\n   copy:\n     dest: /etc/mesos-slave/executor_registration_timeout\n     content: \"{{ mesos_executor_registration_timeout }}\"\n+  notify:\n+    - Restart mesos slave\n   when: mesos_install_mode == \"slave\"\n \n - name: set containerizers\n   sudo: yes\n   copy:\n     dest: /etc/mesos-slave/containerizers\n     content: \"{{ mesos_containerizers }}\"\n+  notify:\n+    - Restart mesos slave\n   when: mesos_install_mode == \"slave\"\n \n - name: set slave resources\n   sudo: yes\n   copy:\n     dest: /etc/mesos-slave/resources\n     content: \"{{ mesos_resources }}\"\n+  notify:\n+    - Restart mesos slave\n   when: mesos_install_mode == \"slave\"\n \n - name: Set Mesos Slave ip\n@@ -93,7 +111,7 @@\n     mode: 0644\n   sudo: yes\n   notify:\n-    - Start mesos slave\n+    - Restart mesos slave\n   when: mesos_install_mode == \"slave\"\n \n - name: Create Mesos Slave work area\n@@ -102,6 +120,8 @@\n     mode: 0755\n     state: directory\n   sudo: yes\n+  notify:\n+    - Restart mesos slave\n   when: mesos_install_mode == \"slave\"\n \n - name: Set Mesos Slave work area\n@@ -111,5 +131,8 @@\n     mode: 0644\n   sudo: yes\n   notify:\n-    - Start mesos slave\n+    - Restart mesos slave\n   when: mesos_install_mode == \"slave\"\n+\n+- name: start mesos-slave (and enable it at boot)\n+  service: name=mesos-slave state=started enabled=yes", "release": "308889b1c7c114ab9079c9050ee083fffe5508be"}, {"sha": "6728c21020d35ab3b34e9bbcb0feb554083f72ff", "filename": "roles/mesos/handlers/main.yml", "previous_filename": null, "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Capgemini/Apollo/blob/7984d52dda17244484d7205285403e94e38c0a73/roles/mesos/handlers/main.yml", "raw_url": "https://github.com/Capgemini/Apollo/raw/7984d52dda17244484d7205285403e94e38c0a73/roles/mesos/handlers/main.yml", "status": "modified", "patch": "@@ -7,3 +7,11 @@\n - name: Start mesos slave\n   shell: start mesos-slave\n   sudo: yes\n+\n+- name: Restart mesos master\n+  shell: restart mesos-master\n+  sudo: yes\n+\n+- name: Restart mesos slave\n+  shell: restart mesos-slave\n+  sudo: yes", "release": "308889b1c7c114ab9079c9050ee083fffe5508be"}]}]