<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../../img/favicon.ico">
        <title>Mine - RadonMiner</title>
        <link href="../../css/bootstrap.min.css" rel="stylesheet">
        <link href="../../css/font-awesome.min.css" rel="stylesheet">
        <link href="../../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">

        <script src="../../js/jquery-1.10.2.min.js" defer></script>
        <script src="../../js/bootstrap.min.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="../..">RadonMiner</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbar-collapse">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Getting Started <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../.." class="dropdown-item">Quick Start</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown active">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">CLI <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../getting_started/" class="dropdown-item">Getting Started</a>
</li>
                                    
<li>
    <a href="./" class="dropdown-item active">Mine</a>
</li>
                                    
<li>
    <a href="../metrics/" class="dropdown-item">Extract metrics</a>
</li>
                                </ul>
                            </li>
                            <li class="navitem">
                                <a href="../../apis/" class="nav-link">APIs</a>
                            </li>
                            <li class="navitem">
                                <a href="../../about/" class="nav-link">About</a>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ml-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-toggle="modal" data-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                            <li class="nav-item">
                                <a rel="prev" href="../getting_started/" class="nav-link">
                                    <i class="fa fa-arrow-left"></i> Previous
                                </a>
                            </li>
                            <li class="nav-item">
                                <a rel="next" href="../metrics/" class="nav-link">
                                    Next <i class="fa fa-arrow-right"></i>
                                </a>
                            </li>
                            <li class="nav-item">
                                <a href="https://github.com/radon-h2020/radon-repository-miner/edit/master/docs/cli/mine.md" class="nav-link"><i class="fa fa-github"></i> Edit on GitHub</a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-light navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-toggle="collapse" data-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-secondary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-level="1"><a href="#mine" class="nav-link">Mine</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-level="1"><a href="#example" class="nav-link">Example</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="2"><a href="#using-docker" class="nav-link">Using Docker</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#using-the-cli-on-local-machine" class="nav-link">Using the CLI on local machine</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<h1 id="mine">Mine</h1>
<pre><code class="language-text">usage: repo-miner mine [-h] [--branch BRANCH] [--exclude-commits EXCLUDE_COMMITS] [--exclude-files EXCLUDE_FILES] [--verbose] {fixing-commits,fixed-files,failure-prone-files} {github,gitlab} {ansible,tosca} repository dest

positional arguments:
  {fixing-commits,fixed-files,failure-prone-files}
                        the information to mine
  {github,gitlab}       the source code versioning host
  {ansible,tosca}       mine only commits modifying files of this language
  repository            the repository full name: &lt;onwer/name&gt; (e.g., radon-h2020/radon-repository-miner)
  dest                  destination folder for the reports

optional arguments:
  -h, --help            show this help message and exit
  -b, --branch BRANCH   the repository branch to mine (default: master)
  --exclude-commits EXCLUDE_COMMITS
                        the path to a JSON file containing the list of commit hashes to exclude
  --include-commits INCLUDE_COMMITS
                        the path to a JSON file containing the list of commit hashes to include
  --exclude-files EXCLUDE_FILES
                        the path to a JSON file containing the list of FixedFiles to exclude
  --verbose             show log
</code></pre>
<div class="admonition note">
<p class="admonition-title">Output</p>
<p>Running this command will generate the following report files:</p>
<ul>
<li><code>dest/fixing-commits.json</code> containing the list of fixing-commit hashes;</li>
<li><code>dest/fixed-files.json</code> containing the list of FixedFile objects (if mined <code>fixed-files</code> or <code>failure-prone-files</code>);</li>
<li><code>dest/failure-prone-files.json</code> containing the list of FailureProne objects (if mined <code>failure-prone-files</code>);</li>
</ul>
</div>
<div class="admonition warning">
<p class="admonition-title">Requirements</p>
<p>To properly use this command you <strong>MUST</strong> add the following to your environment variables: </p>
<ul>
<li>
<p><code>GITHUB_ACCESS_TOKEN=&lt;paste your token here&gt;</code> if you are using the <code>github</code> argument. See how to create a personal 
access token <a href="https://docs.github.com/en/free-pro-team@latest/github/authenticating-to-github/creating-a-personal-access-token">here</a>.</p>
</li>
<li>
<p><code>GITLAB_ACCESS_TOKEN=&lt;paste your token here&gt;</code> if you are using the <code>gitlab</code> argument. See how to create a personal 
access token <a href="https://docs.gitlab.com/ee/user/profile/personal_access_tokens.html">here</a>.</p>
</li>
<li>
<p><code>TMP_REPOSITORIES_DIR=&lt;path/to/tmp/repositories/&gt;</code> to temporary clone the remote repository for analysis. 
Please, note that the repository will be cloned in this folder but not deleted. The latter step is left to the user,
when and if needed. <strong>Note:</strong> this variable is not needed if using the Docker image.</p>
</li>
</ul>
</div>
<h1 id="example">Example</h1>
<h2 id="using-docker">Using Docker</h2>
<ol>
<li>
<p><strong>Setup environment variables</strong></p>
<p><code>export GITHUB_ACCESS_TOKEN=***************</code> </p>
<p><code>export GITLAB_ACCESS_TOKEN=***************</code> </p>
</li>
<li>
<p><strong>Pull the Docker image</strong></p>
<p><code>docker pull radonconsortium/repo-miner:latest</code></p>
</li>
<li>
<p><strong>Create a folder to share results</strong></p>
<p><code>mkdir /tmp/repo-miner</code></p>
</li>
<li>
<p><strong>Mine</strong></p>
<p><em>(using github)</em> <code>docker run -v /tmp/repo-miner:/app  -e GITHUB_ACCESS_TOKEN=$GITHUB_ACCESS_TOKEN repo-miner:latest repo-miner mine failure-prone-files github ansible adriagalin/ansible.motd . --verbose</code></p>
<p><em>(using gitlab)</em> <code>docker run -v /tmp/repo-miner:/app  -e GITLAB_ACCESS_TOKEN=$GITHUB_ACCESS_TOKEN repo-miner:latest repo-miner mine failure-prone-files github ansible adriagalin/ansible.motd . --verbose</code></p>
</li>
<li>
<p><strong>Access reports</strong></p>
<p><code>ls /tmp/repo-miner</code></p>
</li>
</ol>
<h2 id="using-the-cli-on-local-machine">Using the CLI on local machine</h2>
<ol>
<li>
<p><strong>Setup environment variables</strong></p>
<p><code>export GITHUB_ACCESS_TOKEN=***************</code> </p>
<p><code>export GITLAB_ACCESS_TOKEN=***************</code> </p>
<p><code>export TMP_REPOSITORIES_DIR=/tmp/</code> </p>
</li>
<li>
<p><strong>Create a working directory and move there</strong></p>
<p><code>mkdir radon-example &amp;&amp; cd radon-example</code></p>
</li>
<li>
<p><strong>(Optional) Create a virtualenv to avoid affecting the original environment</strong></p>
<p><code>sudo apt install python3-venv</code><br>
<code>python3 -m venv repo-miner-env</code><br>
<code>source repo-miner-env/bin/activate</code></p>
</li>
<li>
<p><strong>Install the package</strong></p>
<p><code>pip install repository-miner</code></p>
</li>
<li>
<p><strong>Mine</strong></p>
<p><code>repo-miner mine failure-prone-files github ansible adriagalin/ansible.motd . --verbose</code></p>
</li>
<li>
<p><strong>Access reports</strong></p>
<p><code>ls .</code> (Recall the working directory is <code>radon-example</code>)</p>
</li>
</ol>
<hr />
<p>In both cases you should get a similar output:</p>
<pre><code class="language-text">Mining adriagalin/ansible.motd [started at: 15:29]
Identifying fixing-commits from closed issues related to bugs
Identifying fixing-commits from commit messages
Saving fixing-commits
JSON created at ./fixing-commits.json
Identifying ansible files modified in fixing-commits
Saving fixed-files
JSON created at ./fixed-files.json
Identifying and labeling failure-prone files
Saving failure-prone files
JSON created at ./failure-prone-files.json
</code></pre></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>
            var base_url = "../..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../../js/base.js" defer></script>
        <script src="../../search/main.js" defer></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
                <p>
                    From here you can search these documents. Enter
                    your search terms below.
                </p>
                <form>
                    <div class="form-group">
                        <input type="search" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
